<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>易班网上预报到常见问题汇总</title>
    <url>/posts/6e5b7441/</url>
    <content><![CDATA[<p>由于学校服务器网络问题，临时将答疑帖置于本服务器</p>
<span id="more"></span>


<ul>
<li><a href="#%E6%96%87%E6%A1%A3%E7%AE%80%E4%BB%8B">文档简介</a></li>
<li><a href="#%E9%A2%84%E6%8A%A5%E9%81%93%E6%B5%81%E7%A8%8B">预报道流程</a><ul>
<li><a href="#%E6%97%B6%E9%97%B4">时间</a></li>
<li><a href="#%E6%B5%81%E7%A8%8B">流程</a></li>
</ul>
</li>
<li><a href="#%E9%A2%84%E6%8A%A5%E9%81%93%E5%B7%A5%E5%85%B7%E5%BB%BA%E8%AE%AE">预报道工具建议</a></li>
<li><a href="#%E6%98%93%E7%8F%ADapp%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98">易班APP相关问题</a><ul>
<li><a href="#%E6%98%93%E7%8F%AD%E6%B3%A8%E5%86%8C%E5%8F%8A%E8%AE%A4%E8%AF%81">易班注册及认证</a></li>
<li><a href="#%E6%A0%A1%E6%96%B9%E8%AE%A4%E8%AF%81%E4%B8%8D%E6%88%90%E5%8A%9F">校方认证不成功</a></li>
<li><a href="#%E8%AE%A4%E8%AF%81%E6%97%B6%E6%89%BE%E4%B8%8D%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E7%8F%AD%E7%BA%A7%E4%BF%A1%E6%81%AF">认证时找不到自己的班级信息</a></li>
<li><a href="#%E6%9B%B4%E6%8D%A2%E6%89%8B%E6%9C%BA%E5%8F%B7">更换手机号</a></li>
<li><a href="#%E4%BB%A5%E5%89%8D%E8%AE%A4%E8%AF%81%E8%BF%87%E6%98%93%E7%8F%AD">以前认证过易班</a></li>
<li><a href="#%E5%8C%BB%E5%AD%A6%E9%83%A8%E5%AD%A6%E7%94%9F%E8%AE%A4%E8%AF%81">医学部学生认证</a></li>
</ul>
</li>
<li><a href="#%E9%A2%84%E6%8A%A5%E5%88%B0%E5%B9%B3%E5%8F%B0%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98">预报到平台相关问题</a><ul>
<li><a href="#%E7%BD%91%E9%A1%B5%E4%B9%B1%E7%A0%81%E6%88%96%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80">网页乱码或无法打开</a></li>
<li><a href="#%E6%8F%90%E7%A4%BA%E6%98%93%E7%8F%AD%E6%8E%88%E6%9D%83%E4%B8%8D%E9%80%9A%E8%BF%87">提示易班授权不通过</a></li>
<li><a href="#%E5%A1%AB%E5%86%99%E7%9A%84%E4%BF%A1%E6%81%AF%E4%BF%9D%E5%AD%98%E4%B8%8D%E6%88%90%E5%8A%9F">填写的信息保存不成功</a></li>
<li><a href="#%E4%BD%93%E9%87%8D%E5%92%8C%E8%BA%AB%E9%AB%98%E7%9A%84%E5%8D%95%E4%BD%8D">体重和身高的单位</a></li>
<li><a href="#%E5%86%9B%E8%AE%AD%E6%9C%8D%E5%B0%BA%E5%AF%B8%E9%97%AE%E9%A2%98">军训服尺寸问题</a></li>
<li><a href="#%E5%AE%B6%E5%BA%AD%E6%88%90%E5%91%98%E6%80%8E%E4%B9%88%E5%A1%AB%E5%86%99">家庭成员怎么填写</a></li>
<li><a href="#%E6%95%99%E8%82%B2%E7%BB%8F%E5%8E%86%E6%80%8E%E4%B9%88%E5%A1%AB%E5%86%99">教育经历怎么填写</a></li>
<li><a href="#%E6%95%99%E8%82%B2%E7%BB%8F%E5%8E%86%E6%97%A5%E6%9C%9F">教育经历日期</a></li>
<li><a href="#%E5%85%A5%E5%AD%A6%E5%89%8D%E6%89%80%E5%9C%A8%E5%8D%95%E4%BD%8D%E6%80%8E%E4%B9%88%E5%A1%AB">入学前所在单位怎么填</a></li>
<li><a href="#%E5%AE%B6%E5%BA%AD%E6%88%90%E5%91%98%E4%BF%A1%E6%81%AF%E6%88%96%E6%95%99%E8%82%B2%E7%BB%8F%E5%8E%86%E5%A1%AB%E5%A4%9A%E5%8F%8A%E9%87%8D%E5%A4%8D%E5%A1%AB%E5%86%99">家庭成员信息或教育经历填多及重复填写</a></li>
<li><a href="#%E9%80%9A%E8%AE%AF%E5%9C%B0%E5%9D%80%E6%98%AF%E6%8C%87">通讯地址是指</a></li>
<li><a href="#%E5%85%9A%E5%9B%A2%E8%81%8C%E5%8A%A1">党团职务</a></li>
<li><a href="#%E5%B9%B4%E9%BE%84%E6%98%AF%E8%99%9A%E5%B2%81%E8%BF%98%E6%98%AF%E5%91%A8%E5%B2%81">年龄是虚岁还是周岁？</a></li>
<li><a href="#%E9%82%AE%E6%94%BF%E7%BC%96%E7%A0%81">邮政编码</a></li>
<li><a href="#%E7%85%A7%E7%89%87%E8%A6%81%E6%B1%82">照片要求</a></li>
<li><a href="#%E7%85%A7%E7%89%87%E5%A4%A7%E5%B0%8F%E8%B6%85%E5%87%BA%E9%99%90%E5%88%B6">照片大小超出限制</a></li>
<li><a href="#%E8%AF%81%E4%BB%B6%E7%85%A7%E7%85%A7%E7%89%87%E4%B8%80%E7%9B%B4%E6%98%AF%E6%A0%B7%E4%BE%8B%E5%9B%BE%E7%89%87%E4%BC%A0%E4%B8%8A%E5%90%8E%E4%B8%8D%E6%98%BE%E7%A4%BA">证件照照片一直是样例图片&#x2F;传上后不显示</a></li>
<li><a href="#%E4%BF%A1%E6%81%AF%E5%A1%AB%E5%86%99%E9%94%99%E8%AF%AF">信息填写错误</a></li>
<li><a href="#%E6%98%AF%E5%90%A6%E6%9D%A5%E6%A0%A1%E6%8A%A5%E9%81%93">是否来校报道</a></li>
</ul>
</li>
<li><a href="#%E5%85%B6%E4%BB%96%E9%97%AE%E9%A2%98">其他问题</a><ul>
<li><a href="#%E5%9B%A2%E5%85%B3%E7%B3%BB">团关系</a></li>
<li><a href="#%E5%AE%BF%E8%88%8D%E4%BF%A1%E6%81%AF%E6%80%8E%E4%B9%88%E6%9F%A5">宿舍信息怎么查</a></li>
<li><a href="#%E5%AE%BF%E8%88%8D%E5%BA%8A%E5%B0%BA%E5%AF%B8">宿舍床尺寸</a></li>
</ul>
</li>
</ul>
<h2 id="文档简介"><a href="#文档简介" class="headerlink" title="文档简介"></a>文档简介</h2><blockquote>
<p>此博客总结了新生网上预报道常见问题，<strong>如遇到问题，希望大家先根据此文档自行解决</strong></p>
<p>如无法解决可咨询群内学长学姐（学长学姐们近期考试压力较大，希望大家体谅）</p>
</blockquote>
<h2 id="预报道流程"><a href="#预报道流程" class="headerlink" title="预报道流程"></a>预报道流程</h2><p>注意：易班注册不等于网上预报到，先注册易班并进行校方认证后登录迎新系统进行预报到。</p>
<h3 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h3><blockquote>
<p>预报到时间为：8月14日-23日</p>
</blockquote>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>烦请点击移步河大易班微信公众号文章(可以顺便关注一波哈O(∩_∩)O): <a href="https://mp.weixin.qq.com/s/7x-NrlKD_wz3Zmu5LeIJpw">校方认证和网上预报到流程</a></p>
<h2 id="预报道工具建议"><a href="#预报道工具建议" class="headerlink" title="预报道工具建议"></a>预报道工具建议</h2><p><span id="jump"></span></p>
<p><strong>这一点很重要，很多问题是由于浏览器不兼容引起的</strong></p>
<blockquote>
<p>非常建议使用电脑端的Chrome(谷歌)、Firefox(火狐)、Edge浏览器</p>
<p>如条件不允许可尝试手机浏览器、调整为兼容模式或PC模式, 不同浏览器操作方法不一样大家自行百度</p>
</blockquote>
<h2 id="易班APP相关问题"><a href="#易班APP相关问题" class="headerlink" title="易班APP相关问题"></a>易班APP相关问题</h2><p><strong>注意：遇到问题一定不要随意注销账号！</strong></p>
<h3 id="易班注册及认证"><a href="#易班注册及认证" class="headerlink" title="易班注册及认证"></a>易班注册及认证</h3><blockquote>
<p>易班注册使用手机号，一卡通登录新生暂不能使用。学校一律选择“河北大学”，用 <strong>学号（非身份证号）</strong> 认证</p>
</blockquote>
<h3 id="校方认证不成功"><a href="#校方认证不成功" class="headerlink" title="校方认证不成功"></a>校方认证不成功</h3><p><img src="https://img.qylh.xyz/blog/1660573069852.png" loading="lazy"></p>
<p>可能由两点原因导致：</p>
<ol>
<li>认证的时候输学号，不是身份证号。 </li>
<li>以前注册过，用以前的帐号才能登录认证。 </li>
<li>用户为非本科生，研究生和博士生暂时不需要进行网上预报到，后期学校会统一组织相关工作</li>
</ol>
<h3 id="认证时找不到自己的班级信息"><a href="#认证时找不到自己的班级信息" class="headerlink" title="认证时找不到自己的班级信息"></a>认证时找不到自己的班级信息</h3><blockquote>
<p>由于部分学院没有录入班级数据，此时仅需保证选择的学院正确即可，不会对未来使用产生影响</p>
</blockquote>
<h3 id="更换手机号"><a href="#更换手机号" class="headerlink" title="更换手机号"></a>更换手机号</h3><blockquote>
<p>需要登录原手机号后，申请更换手机号</p>
</blockquote>
<h3 id="以前认证过易班"><a href="#以前认证过易班" class="headerlink" title="以前认证过易班"></a>以前认证过易班</h3><blockquote>
<p>可以在APP校方认证模块重新更新认证信息</p>
</blockquote>
<h3 id="医学部学生认证"><a href="#医学部学生认证" class="headerlink" title="医学部学生认证"></a>医学部学生认证</h3><blockquote>
<p>河北大学医学部学生认证时仍需选择河北大学</p>
</blockquote>
<h2 id="预报到平台相关问题"><a href="#预报到平台相关问题" class="headerlink" title="预报到平台相关问题"></a>预报到平台相关问题</h2><h3 id="网页乱码或无法打开"><a href="#网页乱码或无法打开" class="headerlink" title="网页乱码或无法打开"></a>网页乱码或无法打开</h3><blockquote>
<p>学校网络可能存在波动，学校技术人员正在维护，请过一段时间后尝试</p>
</blockquote>
<h3 id="提示易班授权不通过"><a href="#提示易班授权不通过" class="headerlink" title="提示易班授权不通过"></a>提示易班授权不通过</h3><blockquote>
<p>此问题为未完成校方认证导致，请严格按照 <a href="https://mp.weixin.qq.com/s/7x-NrlKD_wz3Zmu5LeIJpw">校方认证和网上预报到流程</a> 完成</p>
</blockquote>
<h3 id="填写的信息保存不成功"><a href="#填写的信息保存不成功" class="headerlink" title="填写的信息保存不成功"></a>填写的信息保存不成功</h3><blockquote>
<p>请更换推荐的浏览器 <a href="#jump">预报到工具推荐</a></p>
</blockquote>
<h3 id="体重和身高的单位"><a href="#体重和身高的单位" class="headerlink" title="体重和身高的单位"></a>体重和身高的单位</h3><blockquote>
<p>体重：KG  身高：CM</p>
</blockquote>
<h3 id="军训服尺寸问题"><a href="#军训服尺寸问题" class="headerlink" title="军训服尺寸问题"></a>军训服尺寸问题</h3><blockquote>
<p>按照尺寸表正常填写即可，尺寸不合适的话现场可调换，无需担心。</p>
</blockquote>
<h3 id="家庭成员怎么填写"><a href="#家庭成员怎么填写" class="headerlink" title="家庭成员怎么填写"></a>家庭成员怎么填写</h3><blockquote>
<p>只需按照户口本填写即可，无需填写本人</p>
</blockquote>
<h3 id="教育经历怎么填写"><a href="#教育经历怎么填写" class="headerlink" title="教育经历怎么填写"></a>教育经历怎么填写</h3><blockquote>
<p>正常填写三项：小学、初中、高中；如有转学、复读等情况按照实际填写。</p>
</blockquote>
<h3 id="教育经历日期"><a href="#教育经历日期" class="headerlink" title="教育经历日期"></a>教育经历日期</h3><blockquote>
<p>按照毕业证时间填写，一般是9月开学、6月毕业。如无法确定，填写大致日期即可</p>
</blockquote>
<h3 id="入学前所在单位怎么填"><a href="#入学前所在单位怎么填" class="headerlink" title="入学前所在单位怎么填"></a>入学前所在单位怎么填</h3><blockquote>
<p>填毕业的高中。</p>
</blockquote>
<h3 id="家庭成员信息或教育经历填多及重复填写"><a href="#家庭成员信息或教育经历填多及重复填写" class="headerlink" title="家庭成员信息或教育经历填多及重复填写"></a>家庭成员信息或教育经历填多及重复填写</h3><blockquote>
<p>忽略多填项即可，不会影响</p>
</blockquote>
<h3 id="通讯地址是指"><a href="#通讯地址是指" class="headerlink" title="通讯地址是指"></a>通讯地址是指</h3><blockquote>
<p>能够联系上你的地址</p>
</blockquote>
<h3 id="党团职务"><a href="#党团职务" class="headerlink" title="党团职务"></a>党团职务</h3><blockquote>
<p>此项只包括团支书、组织委员、宣传委员三项。其他情况均填写<strong>无</strong>即可</p>
</blockquote>
<h3 id="年龄是虚岁还是周岁？"><a href="#年龄是虚岁还是周岁？" class="headerlink" title="年龄是虚岁还是周岁？"></a>年龄是虚岁还是周岁？</h3><blockquote>
<p>周岁</p>
</blockquote>
<h3 id="邮政编码"><a href="#邮政编码" class="headerlink" title="邮政编码"></a>邮政编码</h3><blockquote>
<p>自行百度所在地区的邮政编码，如果显示不正确换一个附近区域</p>
</blockquote>
<h3 id="照片要求"><a href="#照片要求" class="headerlink" title="照片要求"></a>照片要求</h3><ol>
<li>底色无要求，清晰即可</li>
<li>尽量是证件照，也可以用正式的自拍照</li>
<li>格式为jpg、jpeg、gif、png</li>
<li>大小：不超过300KB</li>
</ol>
<h3 id="照片大小超出限制"><a href="#照片大小超出限制" class="headerlink" title="照片大小超出限制"></a>照片大小超出限制</h3><p>可以用以下方法解决:</p>
<ol>
<li>使用微信、QQ等工具互传以压缩图片</li>
<li>百度搜索图片压缩工具，推荐工具 <code>https://www.bejson.com/ui/compress_img/</code> 请复制链接后到浏览器打开，直接在QQ打开可能无法上传图片</li>
</ol>
<h3 id="证件照照片一直是样例图片-x2F-传上后不显示"><a href="#证件照照片一直是样例图片-x2F-传上后不显示" class="headerlink" title="证件照照片一直是样例图片&#x2F;传上后不显示"></a>证件照照片一直是样例图片&#x2F;传上后不显示</h3><blockquote>
<p>系统问题,已联系技术人员解决,可以过几天再试试。</p>
</blockquote>
<h3 id="信息填写错误"><a href="#信息填写错误" class="headerlink" title="信息填写错误"></a>信息填写错误</h3><blockquote>
<p>信息可重复修改，以最后一次为准</p>
</blockquote>
<h3 id="是否来校报道"><a href="#是否来校报道" class="headerlink" title="是否来校报道"></a>是否来校报道</h3><blockquote>
<p>是</p>
</blockquote>
<h2 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h2><h3 id="团关系"><a href="#团关系" class="headerlink" title="团关系"></a>团关系</h3><blockquote>
<p>团关系转接为各学院负责，请在学院群内咨询学院团委负责人</p>
</blockquote>
<h3 id="宿舍信息怎么查"><a href="#宿舍信息怎么查" class="headerlink" title="宿舍信息怎么查"></a>宿舍信息怎么查</h3><blockquote>
<p>缴费平台→交易记录→其他缴费→点击校区查看.</p>
</blockquote>
<h3 id="宿舍床尺寸"><a href="#宿舍床尺寸" class="headerlink" title="宿舍床尺寸"></a>宿舍床尺寸</h3><blockquote>
<p>1.9m*0.9m</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Docker学习Day2——镜像命令</title>
    <url>/posts/51f03386/</url>
    <content><![CDATA[<h2 id="Docker工作原理"><a href="#Docker工作原理" class="headerlink" title="Docker工作原理"></a>Docker工作原理</h2><p>Docker是一个C&#x2F;S结构的系统，Docker的守护进程运行在主机上，通过Socket从客户端访问。</p>
<p>DockerServer接收到DockerClient的命令就会执行。</p>
<p><img src="https://img.qylh.xyz/blog/1651146686322.png" alt="工作原理" loading="lazy"></p>
<h3 id="Docker为什么比虚拟机快？"><a href="#Docker为什么比虚拟机快？" class="headerlink" title="Docker为什么比虚拟机快？"></a>Docker为什么比虚拟机快？</h3><ol>
<li>Docker具有比虚拟机更少的抽象层</li>
<li>Docker利用的是宿主机的内核，vm需要虚拟化一个单独的内核（创建容器时，不需要重新加载一个操作系统内核，不需要进行引导）</li>
</ol>
<h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> version <span class="token comment">#版本信息</span>
<span class="token function">docker</span> info <span class="token comment">#详细信息</span>
<span class="token function">docker</span> 命令 --help <span class="token comment"># 帮助</span></code></pre>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><h4 id="docker-images-查看本地所有镜像"><a href="#docker-images-查看本地所有镜像" class="headerlink" title="docker images 查看本地所有镜像"></a><code>docker images</code> 查看本地所有镜像</h4><pre class="language-bash" data-language="bash"><code class="language-bash">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   <span class="token number">7</span> months ago   <span class="token number">13</span>.3kB</code></pre>
<ul>
<li>REPOSITORY 仓库原</li>
<li>TAG 仓库标签</li>
<li>IMAGE ID 镜像id</li>
<li>CREATED 镜像的创建时间</li>
<li>SIZE 大小</li>
</ul>
<p>可选项</p>
<ul>
<li>-a 显示全部</li>
<li>-f 过滤</li>
<li>-q 仅显示id</li>
</ul>
<h4 id="docker-search-搜索命令"><a href="#docker-search-搜索命令" class="headerlink" title="docker search 搜索命令"></a><code>docker search</code> 搜索命令</h4> <pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker search mysql</span>
NAME                             DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                            MySQL is a widely used, open-source relation…   <span class="token number">12483</span>     <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>       
mariadb                          MariaDB Server is a high performing <span class="token function">open</span> sou…   <span class="token number">4806</span>      <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>       
mysql/mysql-server               Optimized MySQL Server Docker images. Create…   <span class="token number">924</span>                  <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>
percona                          Percona Server is a fork of the MySQL relati…   <span class="token number">575</span>       <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>       
phpmyadmin                       phpMyAdmin - A web interface <span class="token keyword">for</span> MySQL and M…   <span class="token number">516</span>       <span class="token punctuation">[</span>OK<span class="token punctuation">]</span>       
<span class="token comment"># ......</span></code></pre>
<p>可选项</p>
<ul>
<li>filter  <code>--filter =stars=3000</code>(收藏数大于3000的镜像)</li>
</ul>
<h4 id="docker-pull-下载命令"><a href="#docker-pull-下载命令" class="headerlink" title="docker pull 下载命令"></a><code>docker pull</code> 下载命令</h4><p>默认使用最新版，等价于docker pull xx:latest</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql</span>
Using default tag: latest <span class="token comment"># 默认最新版本</span>
latest: Pulling from library/mysql
<span class="token comment"># 分层下载，docker image的核心 联合文件系统</span>
72a69066d2fe: Pull complete 
93619dbc5b36: Pull complete 
99da31dd6142: Pull complete 
626033c43d70: Pull complete 
37d5d7efb64e: Pull complete 
ac563158d721: Pull complete 
d2ba16033dad: Pull complete 
688ba7d5c01a: Pull complete 
00e060b6d11d: Pull complete 
1c04857f594f: Pull complete 
4d7cfa90e6ea: Pull complete 
e0431212d27d: Pull complete 
Digest: sha256:e9027fe4d91c0153429607251656806cc784e914937271037f7738bd5b8e7709 <span class="token comment"># 前面</span>
Status: Downloaded newer image <span class="token keyword">for</span> mysql:latest
docker.io/library/mysql:latest  <span class="token comment"># 真实地址</span></code></pre>
<p>固定版本</p>
<p>docker pull mysql:5.7</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:5.7</span>
<span class="token number">5.7</span>: Pulling from library/mysql
<span class="token comment"># 会发现前面已经存在了这就是分层下载的好处！，重复的部分不需要重新下载了</span>
72a69066d2fe: Already exists 
93619dbc5b36: Already exists 
99da31dd6142: Already exists 
626033c43d70: Already exists 
37d5d7efb64e: Already exists 
ac563158d721: Already exists 
d2ba16033dad: Already exists 
0ceb82207cd7: Pull complete 
37f2405cae96: Pull complete 
e2482e017e53: Pull complete 
70deed891d42: Pull complete 
Digest: sha256:f2ad209efe9c67104167fc609cca6973c8422939491c9345270175a300419f94
Status: Downloaded newer image <span class="token keyword">for</span> mysql:5.7
docker.io/library/mysql:5.7</code></pre>

<h4 id="docker-rmi-f-id"><a href="#docker-rmi-f-id" class="headerlink" title="docker rmi -f + id"></a><code>docker rmi -f + id</code></h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>

REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
mysql         <span class="token number">5.7</span>       c20987f18b13   <span class="token number">4</span> months ago   448MB
mysql         latest    3218b38490ce   <span class="token number">4</span> months ago   516MB
hello-world   latest    feb5d9fea6a5   <span class="token number">7</span> months ago   <span class="token number">13</span>.3kB
<span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker rmi -f c20987f18b13</span>
Untagged: mysql:5.7
Untagged: mysql@sha256:f2ad209efe9c67104167fc609cca6973c8422939491c9345270175a300419f94
Deleted: sha256:c20987f18b130f9d144c9828df630417e2a9523148930dc3963e9d0dab302a76
Deleted: sha256:6567396b065ee734fb2dbb80c8923324a778426dfd01969f091f1ab2d52c7989
Deleted: sha256:0910f12649d514b471f1583a16f672ab67e3d29d9833a15dc2df50dd5536e40f
Deleted: sha256:6682af2fb40555c448b84711c7302d0f86fc716bbe9c7dc7dbd739ef9d757150
Deleted: sha256:5c062c3ac20f576d24454e74781511a5f96739f289edaadf2de934d06e910b92
<span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
mysql         latest    3218b38490ce   <span class="token number">4</span> months ago   516MB
hello-world   latest    feb5d9fea6a5   <span class="token number">7</span> months ago   <span class="token number">13</span>.3kB</code></pre>
<p><code>docker rmi -f $(docker images -aq) </code> 删除全部容器</p>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker学习Day3--容器命令</title>
    <url>/posts/b66167be/</url>
    <content><![CDATA[<h2 id="安装一个centos镜像学习"><a href="#安装一个centos镜像学习" class="headerlink" title="安装一个centos镜像学习"></a>安装一个centos镜像学习</h2><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull centos
Using default tag: latest
latest: Pulling from library/centos
a1d0c7532777: Pull complete 
Digest: sha256:a27fd8080b517143cbbbab9dfb7c8571c40d67d534bbdee55bd6c473f432b177
Status: Downloaded newer image <span class="token keyword">for</span> centos:latest
docker.io/library/centos:latest</code></pre>

<h3 id="docker-run-可选参数-image"><a href="#docker-run-可选参数-image" class="headerlink" title="docker run [可选参数] image"></a><code>docker run [可选参数] image</code></h3><blockquote>
<p>参数说明</p>
</blockquote>
<ul>
<li>–name&#x3D;”name” 给容器起名字</li>
<li>-d 后台方式运行</li>
<li>-it 使用交互方式运行，进入容器查看内容</li>
<li>-P  指定容器的端口（大写）<ul>
<li>-p 主机端口：容器端口 映射</li>
<li>-p 容器端口</li>
</ul>
</li>
<li>-p 随机端口（小写）</li>
</ul>
<p><code>docker run -it centos /bin/bash</code> 启动容器并用bash交互,可见内部也还是一个独立的centos系统</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZ8vbioqlrpr01woefafo2Z ~<span class="token punctuation">]</span><span class="token comment"># docker run -it centos /bin/bash</span>
<span class="token punctuation">[</span>root@4a4d1f89c446 /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var
dev  home  lib64  media       opt  root  sbin  sys  usr
<span class="token punctuation">[</span>root@4a4d1f89c446 /<span class="token punctuation">]</span><span class="token comment"># </span></code></pre>

<h3 id="exit-退出主机"><a href="#exit-退出主机" class="headerlink" title="exit 退出主机"></a><code>exit</code> 退出主机</h3><h3 id="ctrl-p-q-容器不停止退出"><a href="#ctrl-p-q-容器不停止退出" class="headerlink" title="ctrl+p+q 容器不停止退出"></a><code>ctrl+p+q</code> 容器不停止退出</h3><h3 id="docker-ps-查看在运行的所有容器"><a href="#docker-ps-查看在运行的所有容器" class="headerlink" title="docker ps  查看在运行的所有容器"></a><code>docker ps </code> 查看在运行的所有容器</h3><ul>
<li>-a 也会列出历史运行的容器</li>
<li>-n&#x3D;? 显示最近创建的n个容器</li>
<li>-q 只显示id</li>
</ul>
<h3 id="docker-rm-容器id-删除容器"><a href="#docker-rm-容器id-删除容器" class="headerlink" title="docker rm 容器id 删除容器"></a><code>docker rm 容器id</code> 删除容器</h3><p>不能删除正在运行的容器，如需要强制删除可以加-f<br>rmi是删除镜像 没有i是容器</p>
<p>docker rm -f $(docker ps -aq) 删除所有容器</p>
<h3 id="docker-start-id-开启容器"><a href="#docker-start-id-开启容器" class="headerlink" title="docker start id 开启容器"></a><code>docker start id</code> 开启容器</h3><h3 id="docker-restart-id-重启容器"><a href="#docker-restart-id-重启容器" class="headerlink" title="docker restart id 重启容器"></a><code>docker restart id</code> 重启容器</h3><h3 id="docker-stop-id-停止容器"><a href="#docker-stop-id-停止容器" class="headerlink" title="docker stop id 停止容器"></a><code>docker stop id</code> 停止容器</h3>]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker学习Day1</title>
    <url>/posts/ef34f621/</url>
    <content><![CDATA[<p>参考B站狂神说Docker教程<br>弱小和无知不是生存的障碍，傲慢才是 ——三体</p>
<p>由于学校给的服务器（windows server 2008 emm）不支持Docker，所以一直没有接触这东西，现在才觉得应该好好学习一下。</p>
<span id="more"></span>


<h2 id="Docker-概述"><a href="#Docker-概述" class="headerlink" title="Docker 概述"></a>Docker 概述</h2><p><img src="https://img.qylh.xyz/blog/1651051541515.png" alt="Docker" loading="lazy"></p>
<p>一种小巧的虚拟化技术（虚拟机也是虚拟化技术，但比较笨重），基于GoLang开发</p>
<h3 id="Docker出现原因"><a href="#Docker出现原因" class="headerlink" title="Docker出现原因"></a>Docker出现原因</h3><p>一款产品有两套环境</p>
<ul>
<li>线上环境</li>
<li>开发环境</li>
</ul>
<p>开发和部署环境就会比较麻烦，每一个机器都要部署环境，浪费时间。 那么我们项目文件能不能和环境一起打包发布呢？</p>
<p>传统方式：开发人员开发jar包，运维来上线</p>
<p>现在的方案：开发打包部署上线，一套流程完成</p>
<p>在这种需求下Docker应运而生！</p>
<h3 id="Docker的核心思想"><a href="#Docker的核心思想" class="headerlink" title="Docker的核心思想"></a>Docker的核心思想</h3><blockquote>
<p>打包装箱，相互隔离<br>互不影响</p>
</blockquote>
<h3 id="Docker与虚拟机的差别"><a href="#Docker与虚拟机的差别" class="headerlink" title="Docker与虚拟机的差别"></a>Docker与虚拟机的差别</h3><ul>
<li>传统虚拟机，虚拟出一条硬件，运行一个完整的操作系统，在此基础上安装和运行软件</li>
<li>容器内的应用直接运行在宿主机的内容，容器没有自己的内核，也没有虚拟硬件，更加轻便</li>
<li>每个容器间石象湖隔离的，每个容器有自己的文件系统，互不影响</li>
</ul>
<p><img src="https://img.qylh.xyz/blog/1651052446028.png" alt="虚拟机" loading="lazy"><br><img src="https://img.qylh.xyz/blog/1651052204289.png" alt="Docker" loading="lazy"></p>
<h3 id="对DevOps（开发、运维）的意义"><a href="#对DevOps（开发、运维）的意义" class="headerlink" title="对DevOps（开发、运维）的意义"></a>对DevOps（开发、运维）的意义</h3><ol>
<li>应用更快速的交付和部署</li>
<li>更便捷的升级和扩缩容</li>
<li>更简单的系统运维（开发测试环境高度一致）</li>
<li>更搞笑的计算资源利用</li>
</ol>
<h3 id="Docker构成"><a href="#Docker构成" class="headerlink" title="Docker构成"></a>Docker构成</h3><h4 id="镜像（Image）"><a href="#镜像（Image）" class="headerlink" title="镜像（Image）"></a>镜像（Image）</h4><blockquote>
<p>docker镜像累死一个模板可以用这个模板来创建容器服务，通过这个镜像可以创建多个容器</p>
</blockquote>
<h4 id="容器（Container）"><a href="#容器（Container）" class="headerlink" title="容器（Container）"></a>容器（Container）</h4><blockquote>
<p>容器技术独立运行一个或者一组应用，通过镜像来创建。<br>可以简单理解成一个简单的Linux系统</p>
</blockquote>
<h4 id="仓库（Repository）"><a href="#仓库（Repository）" class="headerlink" title="仓库（Repository）"></a>仓库（Repository）</h4><blockquote>
<p>仓库是存放镜像的地方</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1651053127230.png" loading="lazy"></p>
<h3 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h3><p><a href="https://docs.docker.com/engine/install/centos/">官方文档</a></p>
<p>启动服务</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">systemctl start <span class="token function">docker</span></code></pre>
<p>hello-world 测试</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> run hello-world</code></pre>
<p>如果正常的话会出现如下输出</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">Unable to <span class="token function">find</span> image <span class="token string">'hello-world:latest'</span> locally <span class="token punctuation">(</span>无法在本地找到该镜像<span class="token punctuation">)</span>
latest: Pulling from library/hello-world <span class="token punctuation">(</span>从远程仓库拉取<span class="token punctuation">)</span>
2db29710123e: Pull complete  <span class="token punctuation">(</span>拉取成功<span class="token punctuation">)</span>
Digest: sha256:10d7d58d5ebd2a652f4d93fdd86da8f265f5318c6a73cc5b6a9798ff6d2b2e67
Status: Downloaded newer image <span class="token keyword">for</span> hello-world:latest

Hello from Docker<span class="token operator">!</span> <span class="token punctuation">(</span>运行成功<span class="token punctuation">)</span>
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 <span class="token number">1</span>. The Docker client contacted the Docker daemon.
 <span class="token number">2</span>. The Docker daemon pulled the <span class="token string">"hello-world"</span> image from the Docker Hub.
    <span class="token punctuation">(</span>amd64<span class="token punctuation">)</span>
 <span class="token number">3</span>. The Docker daemon created a new container from that image <span class="token function">which</span> runs the
    executable that produces the output you are currently reading.
 <span class="token number">4</span>. The Docker daemon streamed that output to the Docker client, <span class="token function">which</span> sent it
    to your terminal.

To try something <span class="token function">more</span> ambitious, you can run an Ubuntu container with:
 $ <span class="token function">docker</span> run -it ubuntu <span class="token function">bash</span>

Share images, automate workflows, and <span class="token function">more</span> with a <span class="token function">free</span> Docker ID:
 https://hub.docker.com/

For <span class="token function">more</span> examples and ideas, visit:
 https://docs.docker.com/get-started/</code></pre>


<p>通过 <code>docker images </code>查看本地所有镜像</p>
<pre class="language-bash" data-language="bash"><code class="language-bash">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   <span class="token number">7</span> months ago   <span class="token number">13</span>.3kB</code></pre>
<p>可见hello-world已经在本地存在</p>
<h3 id="开启阿里云容器镜像加速服务"><a href="#开启阿里云容器镜像加速服务" class="headerlink" title="开启阿里云容器镜像加速服务"></a>开启阿里云容器镜像加速服务</h3><p><a href="https://cr.console.aliyun.com/cn-zhangjiakou/instances/mirrors">阿里云配置地址</a></p>
<p>选择相应操作系统，运行命令即可<br>例如</p>
<pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
&#123;
  "registry-mirrors": ["https://xxxxxx.mirror.aliyuncs.com"]
&#125;
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span></code></pre>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>机器学习数据集划分方法</title>
    <url>/posts/80712f8b/</url>
    <content><![CDATA[<blockquote>
<p>在机器学习模型建立过程中，需要用部分数据去训练，然后为了检验模型效果需要测试数据进行测试，那么改如何划分数据集呢</p>
</blockquote>
<h2 id="留出法"><a href="#留出法" class="headerlink" title="留出法"></a>留出法</h2><blockquote>
<p>留出法思想很简单直接，就是按比例进行分配，一般训练数据:测试数据在 2：1–4：:之间。</p>
</blockquote>
<p>特点：简单，快速，但不适合较小的数据集</p>
<h2 id="交叉验证法"><a href="#交叉验证法" class="headerlink" title="交叉验证法"></a>交叉验证法</h2><blockquote>
<p>将数据集分成K等份，用其中的K-1份进行训练，1份进行测试，并进行轮换（共K次），最后返回K次误差的平均值和方差。</p>
</blockquote>
<blockquote>
<p>假设数据集共M个数据，若M&#x3D;&#x3D;K 则称为<code>留一法</code></p>
</blockquote>
<blockquote>
<p>适合数据量较小时使用，但运算量巨大。</p>
</blockquote>
<h2 id="自助法"><a href="#自助法" class="headerlink" title="自助法"></a>自助法</h2><blockquote>
<p>其实就是放回抽样，每次从数据集中抽出一份加入到训练集，然后将其放回去（可以被抽到多次），抽N次之后，得到N个数据，剩下没被抽到的作为测试集。（数学证明，会有约1&#x2F;3的数据未被抽到）。</p>
</blockquote>
<p>适合小数据量，保证了足够的训练数据，同时也留出了足够的测试数据。</p>
]]></content>
      <categories>
        <category>机器学习</category>
      </categories>
      <tags>
        <tag>机器学习</tag>
      </tags>
  </entry>
  <entry>
    <title>js函数中的this指代问题.md</title>
    <url>/posts/24e34a90/</url>
    <content><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>在尝试写微信小程序时发现调用接口后的回调中访问不到全局的this，查了一下资料发现需要用箭头函数，因为普通的回调函数自己有局部的this，而ES6中新增加的箭头函数没有自己的this，所以会访问上一级的this。</p>
<pre class="language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">&#x2F;&#x2F;普通函数
success: function (res) &#123;
        console.log(this);
      &#125;
&#x2F;&#x2F;箭头函数
success: (res)&#x3D;&gt;&#123;
    console.log(this);&#x2F;&#x2F;上一级的this
&#125;</code></pre>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>ES6新特性</title>
    <url>/posts/de81bfb9/</url>
    <content><![CDATA[<h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2><blockquote>
<p>ECMAScript 6.0（简称 ES6）是 JavaScript 语言的下一代标准，于 2015 年 6 月正式发布。</p>
</blockquote>
<p>与JavaScript的关系？:</p>
<ol>
<li>ES6是js的一种标准</li>
<li>js是ES6的一种实现</li>
</ol>
<h2 id="常用特性"><a href="#常用特性" class="headerlink" title="常用特性"></a>常用特性</h2><h3 id="变量声明关键字"><a href="#变量声明关键字" class="headerlink" title="变量声明关键字"></a>变量声明关键字</h3><p>新增<code>let</code> 和<code>const</code>用于块级作用域上的变量声明，其中const代表声明后不可改变。</p>
<h3 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h3><blockquote>
<p>相见恨晚啊，以前拼接字符串一堆引号头疼死….</p>
</blockquote>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">ES5</span><span class="token operator">:</span> <span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'My name is &lt;b>'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'&lt;/b> and my age is &lt;font color="green">'</span> <span class="token operator">+</span> age <span class="token operator">+</span> <span class="token string">'&lt;/font>'</span><span class="token punctuation">;</span>

<span class="token constant">ES6</span><span class="token operator">:</span> innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">My name is &lt;b></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/b> and my age is &lt;font color="green"></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>age<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/font></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code></pre>
<h3 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h3><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 20</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rest<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [30, 40, 50]</span></code></pre>

<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><ul>
<li>简写</li>
<li>无this</li>
</ul>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><pre class="language-javaScript" data-language="javaScript"><code class="language-javaScript">class Rectangle &#123;
  constructor(height, width) &#123;
    this.height &#x3D; height;
    this.width &#x3D; width;
  &#125;
&#125;</code></pre>

<h3 id="默认参数"><a href="#默认参数" class="headerlink" title="默认参数"></a>默认参数</h3><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
     <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span></code></pre>
]]></content>
      <categories>
        <category>前端</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title>QQ机器人编写经验分享</title>
    <url>/posts/a30716d2/</url>
    <content><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>由于组织迎新群需求，往年使用的MyQQ机器人灵活性稍差，且频繁更新，感觉不是很稳定。因此今年尝试基于go-cqhttp框架和AliceBot框架实现一款高自由度的QQ机器人。并配套后台管理系统，可编辑回复语，编辑敏感词汇表，更改插件开关状态等。</p>
<p>预计实现主要功能：</p>
<ol>
<li>入群欢迎</li>
<li>入群自动审批</li>
<li>智能聊天</li>
<li>自动回答问题</li>
<li>垃圾广告信息识别、记录、禁言</li>
</ol>
<p>垃圾广告信息识别本准备使用NLP技术实现，但是缺暂时很难拿到足够的训练数据，所以先使用人工标记方案进行标注，待数据充足后再训练模型。</p>
<p>下面简单分享一下此次开发经验</p>
<h2 id="两个框架"><a href="#两个框架" class="headerlink" title="两个框架"></a>两个框架</h2><h3 id="go-cqhttp"><a href="#go-cqhttp" class="headerlink" title="go-cqhttp"></a>go-cqhttp</h3><p><a href="https://docs.go-cqhttp.org/">go-cqhttp文档链接</a></p>
<blockquote>
<p>官方介绍：使用 mirai 以及 MiraiGo 开发的 cqhttp golang 原生实现, 并在 cqhttp 原版 的基础上做了部分修改和拓展。 文档目前还在撰写中。</p>
</blockquote>
<p>支持协议类型：</p>
<ol>
<li>HTTP API</li>
<li>反向HTTP POST</li>
<li>正向WebSocket</li>
<li>反向WebSocket</li>
</ol>
<p>我的理解是这个工具用来<code>登录QQ</code>,并将QQ收到的事件通过协议反馈给我们要写的项目，并且我们写的代码也可以通过接口借助这个工具实现对QQ的一些操作。</p>
<p>首先我们要按照文档要求进行安装，这里比较简单不再多说。</p>
<p>值得注意的是config.yml的修改，可以参照官方文档的注释来修改，注意此处写的端口和协议需要与我们之后定义的保持一致。</p>
<p>修改完成配置后，启动运行脚本（这里如果需要在服务器上运行，可以开启进程守护），第一次登录需要扫码，之后登录信息会存储在<code>device.json</code>中，就不需要扫码咯</p>
<h3 id="AliceBot"><a href="#AliceBot" class="headerlink" title="AliceBot"></a>AliceBot</h3><p>(AliceBot文档)[<a href="https://docs.alicebot.dev/guide/]">https://docs.alicebot.dev/guide/]</a></p>
<blockquote>
<p>官方介绍 AliceBot 是一个简单的 Python 异步多后端机器人框架，支持多种协议适配，可以轻松地编写易用学习和使用的插件来拓展其功能。</p>
</blockquote>
<p>！注意：AliceBot 仅支持 Python <code>3.8+</code> 版本。</p>
<p>还是按照官方文档进行配置初始项目，也是注意config文件的编写，尤其是端口需要与上面的对应。</p>
<p>我的理解这个主要是我们机器人逻辑实现的一个框架，借助cqhttp（其实也支持其他框架的）与qq的交互。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>借助AliceBot文档的图来解释：</p>
<p><img src="https://img.qylh.xyz/blog/1657805067518.png" loading="lazy"></p>
<blockquote>
<p>AliceBot 在使用时，首先需要你实例化一个 Bot 对象，Bot 对象负责加载配置文件，维护一个插件列表和一个适配器列表并提供了一个供适配器使用的通用的事件分发方法。协议适配器（Adapter）负责和协议后端进行通讯，当协议后端发送一个新的事件（Event）给适配器后，适配器会按插件优先级分发事件给各个插件进行处理。<br>插件（Plugin）是由你编写的用于处理事件的类，它必须具有两个方法，rule() 和 handle() ，rule() 方法要求返回一个 bool 值，表示当前事件是否要交由此插件处理，当 rule() 方法返回 True 时，handle() 方法会被调用以进行事件处理。</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1657805281264.png" loading="lazy"></p>
<h2 id="插件类的编写"><a href="#插件类的编写" class="headerlink" title="插件类的编写"></a>插件类的编写</h2><p>简单来说就是需要接收事件，根据API作出响应。每一个功能是一个插件也就是一个类，这个类需要继承<code>alicebot.plugin.Plugin</code>，插件由三部分组成：</p>
<p>事件的信息和API参考go-cqhttp(或其他框架的文档)</p>
<p>API不一定要手写请求，AliceBot已经封装好了，参考<a href="https://docs.alicebot.dev/guide/cqhttp-adapter.html">CQHTTP 协议适配器</a></p>
<h3 id="优先级配置"><a href="#优先级配置" class="headerlink" title="优先级配置"></a>优先级配置</h3><pre class="language-none"><code class="language-none">priority: int &#x3D; 5  # 数字越高优先级越低
block: bool &#x3D; False # 若为True当前插件执行完毕后会停止当前事件传播，更低优先级的插件将不会被执行</code></pre>

<h3 id="执行条件"><a href="#执行条件" class="headerlink" title="执行条件"></a>执行条件</h3><pre class="language-Python" data-language="Python"><code class="language-Python">async def rule(self) -&gt; bool:
    if self.event.type &#x3D;&#x3D; &#39;message&#39;:
        msg &#x3D; str(self.event.message).lower()
        keyWords &#x3D; [&#39;hello&#39;, &#39;hi&#39;, &#39;大家好&#39;, &#39;你好&#39;]
        for key in keyWords:
            if msg.endswith(key) or msg.startswith(key):
                return True</code></pre>

<p>该某个插件执行时，需要先检查rule，若返回了True才会执行具体内容</p>
<h3 id="执行内容"><a href="#执行内容" class="headerlink" title="执行内容"></a>执行内容</h3><p>满足rule后会执行handle代码</p>
<pre class="language-Python" data-language="Python"><code class="language-Python">async def handle(self) -&gt; None:

    replay &#x3D; [
        &#123;
            &quot;type&quot;: &quot;at&quot;,
            &quot;data&quot;: &#123;
                &quot;qq&quot;: str(self.event.user_id)
            &#125;
        &#125;,
        &#123;
            &quot;type&quot;: &quot;text&quot;,
            &quot;data&quot;: &#123;
                &quot;text&quot;: self.getHelloWord()
            &#125;
        &#125;
    ]
    await self.event.reply(replay)</code></pre>

<h2 id="一些踩过的坑"><a href="#一些踩过的坑" class="headerlink" title="一些踩过的坑"></a>一些踩过的坑</h2><ol>
<li>QQ机器人通过API发出的操作，也会再次被接收到，如果执行条件写的不好，可能会被误处理，导致错误。</li>
<li>事件的有些字段可能有些类型不具备，所以为了防止报错，最好先判断一下key值存不存在。</li>
</ol>
<h2 id="后台管理编写思路"><a href="#后台管理编写思路" class="headerlink" title="后台管理编写思路"></a>后台管理编写思路</h2><p>主要是把一下配置信息，写到文件里或者存放到Mysql or Redis 等数据库中。</p>
]]></content>
      <categories>
        <category>开发经验</category>
      </categories>
      <tags>
        <tag>QQ机器人</tag>
        <tag>Python</tag>
        <tag>go-cqhttp</tag>
        <tag>AliceBot</tag>
      </tags>
  </entry>
  <entry>
    <title>ip查询工具</title>
    <url>/posts/eb46ecd9/</url>
    <content><![CDATA[<p>实现两个功能：</p>
<ol>
<li>从服务器日志等文本中提取出IP</li>
<li>调用接口获取IP位置<br>可根据实际需求自由选择<span id="more"></span></li>
</ol>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul>
<li>python<ul>
<li>re</li>
<li>requests</li>
<li>json</li>
</ul>
</li>
<li>百度ip查询API</li>
</ul>
<h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><p><img src="https://img.qylh.xyz/blog/%E6%9C%AA%E5%91%BD%E5%90%8D%E6%96%87%E4%BB%B6%20(20).png" alt="程序流程图" loading="lazy"></p>
<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p><code>\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b</code></p>
<h2 id="百度查询API"><a href="#百度查询API" class="headerlink" title="百度查询API"></a>百度查询API</h2><p><code>&quot;http://opendata.baidu.com/api.php?query=[ip]&amp;co=&amp;resource_id=6006&amp;oe=utf8&quot;</code></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>git地址：<a href="http://hdyb.hbu.cn/git/Mahaotian/IpSearch">http://hdyb.hbu.cn/git/Mahaotian/IpSearch</a></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> re
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> json

<span class="token comment"># 读取日志文件</span>


<span class="token keyword">def</span> <span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
    text <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> text

<span class="token comment"># 提取IP</span>


<span class="token keyword">def</span> <span class="token function">extractIP</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    l <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>
        <span class="token string">r"\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>
    <span class="token comment"># 去重</span>
    <span class="token keyword">return</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 获取定位</span>


<span class="token keyword">def</span> <span class="token function">getPosition</span><span class="token punctuation">(</span>ipList<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> ipList<span class="token punctuation">:</span>
        url <span class="token operator">=</span> <span class="token string">"http://opendata.baidu.com/api.php?query="</span> <span class="token operator">+</span> \
            item<span class="token operator">+</span><span class="token string">"&amp;co=&amp;resource_id=6006&amp;oe=utf8"</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token string">": "</span><span class="token punctuation">,</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'location'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment"># 加个延时</span>
        sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> readFile<span class="token punctuation">(</span><span class="token string">"./file.txt"</span><span class="token punctuation">)</span>
    ipList <span class="token operator">=</span> extractIP<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    getPosition<span class="token punctuation">(</span>ipList<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>


]]></content>
      <categories>
        <category>开发经验</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>工具</tag>
      </tags>
  </entry>
  <entry>
    <title>查课表功能的实现</title>
    <url>/posts/4dddbf41/</url>
    <content><![CDATA[<p>需要为新生设计一个查课表的应用（入学一段时间内无法登陆教务系统，所以课表获取难），基本思路用自己的账号模拟登陆学校的教务系统，爬取课表，根据输入的班级查询，并存储数据库。</p>
<p>难点：<br>    - 数据的获取<br>    - 课表界面的设计</p>
<p>技术：<code>php</code> <code>html&amp;js&amp;css</code> <code>curl</code></p>
<span id="more"></span>


<h2 id="模拟登陆教务系统并存储cookie"><a href="#模拟登陆教务系统并存储cookie" class="headerlink" title="模拟登陆教务系统并存储cookie"></a>模拟登陆教务系统并存储cookie</h2><p>本项目的爬虫使用php curl实现，这部分没啥好记录的</p>
<h2 id="获取班级列表"><a href="#获取班级列表" class="headerlink" title="获取班级列表"></a>获取班级列表</h2><blockquote>
<p>由于班级列表时分页的，懒得爬了，而且里面也有好多无用信息，所以直接手动导出了一份班级信息的js文件。由于我校专业太多，按照学院进行一个划分，（数据中每一条包括班级名和所属学院名），利用了js的set提取出了不重复的学院数组。<br>前端用了两个select下拉列表（使用的<a href="https://developer.snapappointments.com/bootstrap-select/">bootstrap-select</a>框架，这个功能比较多，主要是可以指定下拉列表每一页显示几条数据，来防止下拉菜单过长）<br>首先将学院数组逐条加入到select中作为option，然后添加监听器，当select改变时，动态更改该学院下的班级列表，<br>至此可以获取到前台用户想要查询的班级号（我校课表接口需要班级号），用Ajax与后台进行交互</p>
</blockquote>
<h2 id="后台爬虫"><a href="#后台爬虫" class="headerlink" title="后台爬虫"></a>后台爬虫</h2><blockquote>
<p>利用前台传过来的班级号，带着前面存储下来的cookie（不带的话会被踢出去<del>.</del>）进行请求，<br>由于每一次请求需要较长时间，所以使用了MySQL存下来每个班的课表信息，以后如果要查的信息数据库中有就不用了爬了！！</p>
</blockquote>
<h3 id="此部分遇到的问题"><a href="#此部分遇到的问题" class="headerlink" title="此部分遇到的问题"></a>此部分遇到的问题</h3><ul>
<li><p>爬取的数据怎么处理emm？</p>
<ul>
<li>只能说好乱又是数组又是对象的，只能静下心来一层一层分析，将无用数据剔除</li>
</ul>
</li>
<li><p>存数据库(此问题纯粹是因为数据库没学好)</p>
<ul>
<li>最开始用的<code>varchar</code>然后发现只存了一部分，才发现存不下！！我以为这个就是无限制的，但是都想改用文件存了~，然后发现字段改成<code>txt</code>就好了</li>
</ul>
</li>
<li><p>有的时候由于网络问题爬取失败</p>
<ul>
<li>用了一个try catch</li>
</ul>
</li>
</ul>
<h2 id="课表界面的编写"><a href="#课表界面的编写" class="headerlink" title="课表界面的编写"></a>课表界面的编写</h2><blockquote>
<p>先简单说一下传回来的数据主要字段内容：课程名，课程地点，上课时间（周几），开始节数，持续节数<br>界面设计，用了table 给格子设置了固定的宽高（宽是百分比平分的）<br>遍历数据，根据持续时间将开始节数与下面的单元格合并，并写上课程信息。<br>设计样式：主要是一个多颜色背景，使用了颜色数组，每一个课程的背景从数组中选一个(用的取余方式，没用随机)，添加一个<code>border-radius</code><br>添加点击事件点击后使用bootstrap的弹窗进行一个详细信息的展示</p>
</blockquote>
<h3 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h3><blockquote>
<p>表格边框设定<br>字体太大了（因为手机端为主，浏览器有默认最小字体12px）采用了12px 再利用css进行缩小</p>
</blockquote>
<pre class="language-css" data-language="css"><code class="language-css"> <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
 <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>0.83<span class="token punctuation">,</span> 0.83<span class="token punctuation">)</span><span class="token punctuation">;</span>
*<span class="token property">font-size</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span></code></pre>

<blockquote>
<p>由于课程块的展示会改变原有样式，下次查询的时候如果不清除就会错乱，方便起见，将初始内容用字符串保存，每次查询将固定的内容插入，之后就可以自由修改了，也不会影响下一次内容</p>
</blockquote>
<h3 id="待解决问题"><a href="#待解决问题" class="headerlink" title="待解决问题"></a>待解决问题</h3><blockquote>
<p>明知有bug却解决不了哎，就是课程冲突问题，如果同一时间段课表上有两个课程，就会错乱，暂未解决，目前大概思路有两条<br>一是提前处理数据，将同一时间的数据合并；二是再对单元格进行切分，并排显示<br>由于最近要准备国电赛，不想写了，而且看了看新生课表绝大部分不会出现这个bug，之后有时间再改吧（啊不就是懒）<br>默默的加上了一句，请以开学后的实际课表为主，防止到时候按这个上课导致上错课或不知道上课，罪过罪过</p>
</blockquote>
]]></content>
      <categories>
        <category>开发经验</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>后端</tag>
        <tag>PHP</tag>
        <tag>JS</tag>
        <tag>HTML</tag>
        <tag>CSS</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title>图片点击预览</title>
    <url>/posts/aef883e4/</url>
    <content><![CDATA[<blockquote>
<p>通过lightbox库实现点击图片后放大预览效果</p>
</blockquote>
<span id="more"></span>

<h2 id="下载库支持"><a href="#下载库支持" class="headerlink" title="下载库支持"></a>下载库支持</h2><p><a href="https://github.com/lokesh/lightbox2/tree/dev/src">lightbox github地址</a></p>
<p>只需要<code>lightbox.js</code>和<code>light.css</code>两个文件</p>
<p>也可直接复制以下代码并分别命名为<code>lightbox.js</code>,<code>light.css</code></p>
<details>
  <summary>lightbox.js</summary>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript">
<span class="token comment">/*!
 * Lightbox v2.11.2
 * by Lokesh Dhakar
 *
 * More info:
 * http://lokeshdhakar.com/projects/lightbox2/
 *
 * Copyright Lokesh Dhakar
 * Released under the MIT license
 * https://github.com/lokesh/lightbox2/blob/master/LICENSE
 *
 * @preserve
 */</span>

<span class="token comment">// Uses Node, AMD or browser globals to create a module.</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// AMD. Register as an anonymous module.</span>
        <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Node. Does not work with strict CommonJS, but</span>
        <span class="token comment">// only CommonJS-like environments that support module.exports,</span>
        <span class="token comment">// like Node.</span>
        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Browser globals (root is window)</span>
        root<span class="token punctuation">.</span>lightbox <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>jQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">function</span> <span class="token function">Lightbox</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>album <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">=</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// options</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>defaults<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">// Descriptions of all options available on the demo site:</span>
    <span class="token comment">// http://lokeshdhakar.com/projects/lightbox2/index.html#options</span>
    Lightbox<span class="token punctuation">.</span>defaults <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">albumLabel</span><span class="token operator">:</span> <span class="token string">'Image %1 of %2'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">alwaysShowNavOnTouchDevices</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fadeDuration</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fitImagesInViewport</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">imageFadeDuration</span><span class="token operator">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
        <span class="token comment">// maxWidth: 800,</span>
        <span class="token comment">// maxHeight: 600,</span>
        <span class="token literal-property property">positionFromTop</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token literal-property property">resizeDuration</span><span class="token operator">:</span> <span class="token number">700</span><span class="token punctuation">,</span>
        <span class="token literal-property property">showImageNumberLabel</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">wrapAround</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">disableScrolling</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token comment">/*
        Sanitize Title
        If the caption data is trusted, for example you are hardcoding it in, then leave this to false.
        This will free you to add html tags, such as links, in the caption.
    
        If the caption data is user submitted or from some other untrusted source, then set this to true
        to prevent xss and other injection attacks.
         */</span>
        <span class="token literal-property property">sanitizeTitle</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">option</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        $<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">imageCountLabel</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">currentImageNum<span class="token punctuation">,</span> totalImages</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>albumLabel<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">%1</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> currentImageNum<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">%2</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> totalImages<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token comment">// Both enable and build methods require the body tag to be in the DOM.</span>
        <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            self<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Loop through anchors and areamaps looking for either data-lightbox attributes or rel attributes</span>
    <span class="token comment">// that contain 'lightbox'. When these are clicked, start lightbox.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">enable</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token string">'a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Build html for the lightbox and the overlay.</span>
    <span class="token comment">// Attach event handlers to the new DOM elements. click click click</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">build</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#lightbox'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

        <span class="token comment">// The two root notes generated, #lightboxOverlay and #lightbox are given</span>
        <span class="token comment">// tabindex attrs so they are focusable. We attach our keyboard event</span>
        <span class="token comment">// listeners to these two elements, and not the document. Clicking anywhere</span>
        <span class="token comment">// while Lightbox is opened will keep the focus on or inside one of these</span>
        <span class="token comment">// two elements.</span>
        <span class="token comment">//</span>
        <span class="token comment">// We do this so we can prevent propogation of the Esc keypress when</span>
        <span class="token comment">// Lightbox is open. This prevents it from intefering with other components</span>
        <span class="token comment">// on the page below.</span>
        <span class="token comment">//</span>
        <span class="token comment">// Github issue: https://github.com/lokesh/lightbox2/issues/663</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;div id="lightboxOverlay" tabindex="-1" class="lightboxOverlay">&lt;/div>&lt;div id="lightbox" tabindex="-1" class="lightbox">&lt;div class="lb-outerContainer">&lt;div class="lb-container">&lt;img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" alt=""/>&lt;div class="lb-nav">&lt;a class="lb-prev" aria-label="Previous image" href="" >&lt;/a>&lt;a class="lb-next" aria-label="Next image" href="" >&lt;/a>&lt;/div>&lt;div class="lb-loader">&lt;a class="lb-cancel">&lt;/a>&lt;/div>&lt;/div>&lt;/div>&lt;div class="lb-dataContainer">&lt;div class="lb-data">&lt;div class="lb-details">&lt;span class="lb-caption">&lt;/span>&lt;span class="lb-number">&lt;/span>&lt;/div>&lt;div class="lb-closeContainer">&lt;a class="lb-close">&lt;/a>&lt;/div>&lt;/div>&lt;/div>&lt;/div>'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Cache jQuery objects</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#lightbox'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#lightboxOverlay'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-outerContainer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-container'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$image <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-image'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$nav <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-nav'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Store css values for future lookup</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>containerPadding <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$container<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'padding-top'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$container<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'padding-right'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$container<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'padding-bottom'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$container<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'padding-left'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>imageBorderWidth <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$image<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'border-top-width'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$image<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'border-right-width'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$image<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'border-bottom-width'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$image<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'border-left-width'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

        <span class="token comment">// Attach event handlers to the newly minted DOM elements</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'lightbox'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'lightbox'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prev'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>currentImageIndex <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>currentImageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>currentImageIndex <span class="token operator">===</span> self<span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>currentImageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">/*
          Show context menu for image on right-click
    
          There is a div containing the navigation that spans the entire image and lives above of it. If
          you right-click, you are right clicking this div and not the image. This prevents users from
          saving the image or using other context menu actions with the image.
    
          To fix this, when we detect the right mouse button is pressed down, but not yet clicked, we
          set pointer-events to none on the nav div. This is so that the upcoming right-click event on
          the next mouseup will bubble down to the image. Once the right-click/contextmenu event occurs
          we set the pointer events back to auto for the nav div so it can capture hover and left-click
          events as usual.
         */</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$nav<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>which <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                self<span class="token punctuation">.</span>$nav<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'pointer-events'</span><span class="token punctuation">,</span> <span class="token string">'none'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                self<span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span><span class="token string">'contextmenu'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$nav<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'pointer-events'</span><span class="token punctuation">,</span> <span class="token string">'auto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-loader, .lb-close'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Show overlay and lightbox. If the image is part of a set, add siblings to album array.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$link</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> $window <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>

        $window<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> $<span class="token punctuation">.</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sizeOverlay<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">sizeOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>album <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> imageNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">addToAlbum</span><span class="token punctuation">(</span><span class="token parameter">$link</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span>album<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">alt</span><span class="token operator">:</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-alt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token literal-property property">link</span><span class="token operator">:</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token literal-property property">title</span><span class="token operator">:</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-title'</span><span class="token punctuation">)</span> <span class="token operator">||</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// Support both data-lightbox attribute and rel attribute implementations</span>
        <span class="token keyword">var</span> dataLightboxValue <span class="token operator">=</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'data-lightbox'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> $links<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataLightboxValue<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            $links <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>$link<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'tagName'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'[data-lightbox="'</span> <span class="token operator">+</span> dataLightboxValue <span class="token operator">+</span> <span class="token string">'"]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> $links<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">=</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">addToAlbum</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>$links<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>$links<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> $link<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    imageNumber <span class="token operator">=</span> i<span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>$link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'rel'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'lightbox'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// If image is not part of a set</span>
                <span class="token function">addToAlbum</span><span class="token punctuation">(</span>$link<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// If image is part of a set</span>
                $links <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>$link<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">'tagName'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'[rel="'</span> <span class="token operator">+</span> $link<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'rel'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'"]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> $links<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j <span class="token operator">=</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token function">addToAlbum</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>$links<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>$links<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">===</span> $link<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        imageNumber <span class="token operator">=</span> j<span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// Position Lightbox</span>
        <span class="token keyword">var</span> top <span class="token operator">=</span> $window<span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>positionFromTop<span class="token punctuation">;</span>
        <span class="token keyword">var</span> left <span class="token operator">=</span> $window<span class="token punctuation">.</span><span class="token function">scrollLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token literal-property property">top</span><span class="token operator">:</span> top <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">left</span><span class="token operator">:</span> left <span class="token operator">+</span> <span class="token string">'px'</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>fadeDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Disable scrolling of the page while open</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>disableScrolling<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'lb-disable-scrolling'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span>imageNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Hide most UI elements in preparation for the animated resizing of the lightbox.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">changeImage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">imageNumber</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> filename <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span>imageNumber<span class="token punctuation">]</span><span class="token punctuation">.</span>link<span class="token punctuation">;</span>
        <span class="token keyword">var</span> filetype <span class="token operator">=</span> filename<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> $image <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-image'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Disable keyboard nav during transitions</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">disableKeyboardNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Show loading state</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>fadeDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'.lb-loader'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token string">'slow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">'animating'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// When image to show is preloaded, we send the width and height to sizeContainer()</span>
        <span class="token keyword">var</span> preloader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        preloader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> $preloader<span class="token punctuation">;</span>
            <span class="token keyword">var</span> imageHeight<span class="token punctuation">;</span>
            <span class="token keyword">var</span> imageWidth<span class="token punctuation">;</span>
            <span class="token keyword">var</span> maxImageHeight<span class="token punctuation">;</span>
            <span class="token keyword">var</span> maxImageWidth<span class="token punctuation">;</span>
            <span class="token keyword">var</span> windowHeight<span class="token punctuation">;</span>
            <span class="token keyword">var</span> windowWidth<span class="token punctuation">;</span>

            $image<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token string-property property">'alt'</span><span class="token operator">:</span> self<span class="token punctuation">.</span>album<span class="token punctuation">[</span>imageNumber<span class="token punctuation">]</span><span class="token punctuation">.</span>alt<span class="token punctuation">,</span>
                <span class="token string-property property">'src'</span><span class="token operator">:</span> filename
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            $preloader <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>preloader<span class="token punctuation">)</span><span class="token punctuation">;</span>

            $image<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
            $image<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
            windowWidth <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            windowHeight <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Calculate the max image dimensions for the current viewport.</span>
            <span class="token comment">// Take into account the border around the image and an additional 10px gutter on each side.</span>
            maxImageWidth <span class="token operator">=</span> windowWidth <span class="token operator">-</span> self<span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>left <span class="token operator">-</span> self<span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>right <span class="token operator">-</span> self<span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>left <span class="token operator">-</span> self<span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>right <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">;</span>
            maxImageHeight <span class="token operator">=</span> windowHeight <span class="token operator">-</span> self<span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>top <span class="token operator">-</span> self<span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>bottom <span class="token operator">-</span> self<span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>top <span class="token operator">-</span> self<span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>bottom <span class="token operator">-</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>positionFromTop <span class="token operator">-</span> <span class="token number">70</span><span class="token punctuation">;</span>

            <span class="token comment">/*
            Since many SVGs have small intrinsic dimensions, but they support scaling
            up without quality loss because of their vector format, max out their
            size.
            */</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>filetype <span class="token operator">===</span> <span class="token string">'svg'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                $image<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>maxImageWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
                $image<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>maxImageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token comment">// Fit image inside the viewport.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>fitImagesInViewport<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

                <span class="token comment">// Check if image size is larger then maxWidth|maxHeight in settings</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxWidth <span class="token operator">&amp;&amp;</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxWidth <span class="token operator">&lt;</span> maxImageWidth<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    maxImageWidth <span class="token operator">=</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxWidth<span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxHeight <span class="token operator">&amp;&amp;</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxHeight <span class="token operator">&lt;</span> maxImageHeight<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    maxImageHeight <span class="token operator">=</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxHeight<span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>

            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                maxImageWidth <span class="token operator">=</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxWidth <span class="token operator">||</span> preloader<span class="token punctuation">.</span>width <span class="token operator">||</span> maxImageWidth<span class="token punctuation">;</span>
                maxImageHeight <span class="token operator">=</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>maxHeight <span class="token operator">||</span> preloader<span class="token punctuation">.</span>height <span class="token operator">||</span> maxImageHeight<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token comment">// Is the current image's width or height is greater than the maxImageWidth or maxImageHeight</span>
            <span class="token comment">// option than we need to size down while maintaining the aspect ratio.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>width <span class="token operator">></span> maxImageWidth<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>height <span class="token operator">></span> maxImageHeight<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>width <span class="token operator">/</span> maxImageWidth<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>height <span class="token operator">/</span> maxImageHeight<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    imageWidth <span class="token operator">=</span> maxImageWidth<span class="token punctuation">;</span>
                    imageHeight <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>width <span class="token operator">/</span> imageWidth<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    $image<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>imageWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    $image<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>imageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                    imageHeight <span class="token operator">=</span> maxImageHeight<span class="token punctuation">;</span>
                    imageWidth <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token punctuation">(</span>preloader<span class="token punctuation">.</span>height <span class="token operator">/</span> imageHeight<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    $image<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>imageWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    $image<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>imageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            self<span class="token punctuation">.</span><span class="token function">sizeContainer</span><span class="token punctuation">(</span>$image<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> $image<span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

        <span class="token comment">// Preload image before showing</span>
        preloader<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span>imageNumber<span class="token punctuation">]</span><span class="token punctuation">.</span>link<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">=</span> imageNumber<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Stretch overlay to fit the viewport</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sizeOverlay</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token comment">/*
        We use a setTimeout 0 to pause JS execution and let the rendering catch-up.
        Why do this? If the `disableScrolling` option is set to true, a class is added to the body
        tag that disables scrolling and hides the scrollbar. We want to make sure the scrollbar is
        hidden before we measure the document width, as the presence of the scrollbar will affect the
        number.
        */</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span>$overlay
                <span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Animate the size of the lightbox to fit the image we are showing</span>
    <span class="token comment">// This method also shows the the image.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sizeContainer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">imageWidth<span class="token punctuation">,</span> imageHeight</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> oldWidth <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">outerWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> oldHeight <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">outerHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> newWidth <span class="token operator">=</span> imageWidth <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>right <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>left <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
        <span class="token keyword">var</span> newHeight <span class="token operator">=</span> imageHeight <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>top <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerPadding<span class="token punctuation">.</span>bottom <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>top <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>imageBorderWidth<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">postResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            self<span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-dataContainer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span>newWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            self<span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prevLink'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>newHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
            self<span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-nextLink'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span>newHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Set focus on one of the two root nodes so keyboard events are captured.</span>
            self<span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            self<span class="token punctuation">.</span><span class="token function">showImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldWidth <span class="token operator">!==</span> newWidth <span class="token operator">||</span> oldHeight <span class="token operator">!==</span> newHeight<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token literal-property property">width</span><span class="token operator">:</span> newWidth<span class="token punctuation">,</span>
                <span class="token literal-property property">height</span><span class="token operator">:</span> newHeight
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>resizeDuration<span class="token punctuation">,</span> <span class="token string">'swing'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">postResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token function">postResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Display the image and its details and begin preload neighboring images.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">showImage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-loader'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-image'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>imageFadeDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">preloadNeighboringImages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">enableKeyboardNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Display previous and next navigation if appropriate.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">updateNav</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// Check to see if the browser supports touch events. If so, we take the conservative approach</span>
        <span class="token comment">// and assume that mouse hover events are not supported and always show prev/next navigation</span>
        <span class="token comment">// arrows in image sets.</span>
        <span class="token keyword">var</span> alwaysShowNav <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">'TouchEvent'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            alwaysShowNav <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>alwaysShowNavOnTouchDevices<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-nav'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>wrapAround<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>alwaysShowNav<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prev, .lb-next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prev, .lb-next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prev'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>alwaysShowNav<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-prev'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>alwaysShowNav<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'opacity'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Display caption, image number, and closing button.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">updateDetails</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

        <span class="token comment">// Enable anchor clicks in the injected caption html.</span>
        <span class="token comment">// Thanks Nate Wright for the fix. @https://github.com/NateWr</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> $caption <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-caption'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>sanitizeTitle<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                $caption<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                $caption<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            $caption<span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token string">'fast'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>showImageNumberLabel<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> labelText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">imageCountLabel</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-number'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>labelText<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token string">'fast'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-number'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$outerContainer<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'animating'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'.lb-dataContainer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fadeIn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>resizeDuration<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token function">sizeOverlay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Preload previous and next images in set.</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">preloadNeighboringImages</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> preloadNext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            preloadNext<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>link<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> preloadPrev <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            preloadPrev<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>link<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">enableKeyboardNav</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'keyup.keyboard'</span><span class="token punctuation">,</span> $<span class="token punctuation">.</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardAction<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'keyup.keyboard'</span><span class="token punctuation">,</span> $<span class="token punctuation">.</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>keyboardAction<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">disableKeyboardNav</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'.keyboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'.keyboard'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">keyboardAction</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> <span class="token constant">KEYCODE_ESC</span> <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">KEYCODE_LEFTARROW</span> <span class="token operator">=</span> <span class="token number">37</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token constant">KEYCODE_RIGHTARROW</span> <span class="token operator">=</span> <span class="token number">39</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> keycode <span class="token operator">=</span> event<span class="token punctuation">.</span>keyCode<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keycode <span class="token operator">===</span> <span class="token constant">KEYCODE_ESC</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token comment">// Prevent bubbling so as to not affect other components on the page.</span>
            event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keycode <span class="token operator">===</span> <span class="token constant">KEYCODE_LEFTARROW</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>wrapAround <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>keycode <span class="token operator">===</span> <span class="token constant">KEYCODE_RIGHTARROW</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentImageIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>wrapAround <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>album<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeImage</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// Closing time. :-(</span>
    <span class="token class-name">Lightbox</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">end</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">disableKeyboardNav</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sizeOverlay<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$lightbox<span class="token punctuation">.</span><span class="token function">fadeOut</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>fadeDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$overlay<span class="token punctuation">.</span><span class="token function">fadeOut</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>fadeDuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>disableScrolling<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">'lb-disable-scrolling'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Lightbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

</details>

<hr>
<details>
  <summary>lightbox.css</summary>

<pre><code><pre class="language-css" data-language="css"><code class="language-css"><span class="token selector">body.lb-disable-scrolling</span> <span class="token punctuation">&#123;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lightboxOverlay</span> <span class="token punctuation">&#123;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 9999<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=80<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0.8<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lightbox</span> <span class="token punctuation">&#123;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 10000<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lightbox .lb-image</span> <span class="token punctuation">&#123;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token property">max-width</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
    <span class="token property">max-height</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>

    <span class="token comment">/* Image border */</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 4px solid white<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lightbox a img</span> <span class="token punctuation">&#123;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-outerContainer</span> <span class="token punctuation">&#123;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    *<span class="token property">zoom</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 250px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 250px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>

    <span class="token comment">/* Background color behind image.
    This is visible during transitions. */</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-outerContainer:after</span> <span class="token punctuation">&#123;</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>
    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-loader</span> <span class="token punctuation">&#123;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 43%<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 25%<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-cancel</span> <span class="token punctuation">&#123;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 32px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 32px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../images/loading.gif<span class="token punctuation">)</span></span> no-repeat<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav</span> <span class="token punctuation">&#123;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-container>.nav</span> <span class="token punctuation">&#123;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav a</span> <span class="token punctuation">&#123;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">'data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-prev,
.lb-next</span> <span class="token punctuation">&#123;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav a.lb-prev</span> <span class="token punctuation">&#123;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 34%<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../images/prev.png<span class="token punctuation">)</span></span> left 48% no-repeat<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">-webkit-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">-moz-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">-o-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav a.lb-prev:hover</span> <span class="token punctuation">&#123;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=100<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav a.lb-next</span> <span class="token punctuation">&#123;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 64%<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../images/next.png<span class="token punctuation">)</span></span> right 48% no-repeat<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=0<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">-webkit-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">-moz-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">-o-transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
    <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.6s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-nav a.lb-next:hover</span> <span class="token punctuation">&#123;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=100<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-dataContainer</span> <span class="token punctuation">&#123;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token property">padding-top</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    *<span class="token property">zoom</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">border-bottom-left-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token property">border-bottom-right-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-dataContainer:after</span> <span class="token punctuation">&#123;</span>
    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>
    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data</span> <span class="token punctuation">&#123;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 4px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #ccc<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-details</span> <span class="token punctuation">&#123;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 85%<span class="token punctuation">;</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 1.1em<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-caption</span> <span class="token punctuation">&#123;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-caption a</span> <span class="token punctuation">&#123;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #4ae<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-number</span> <span class="token punctuation">&#123;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">clear</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #999999<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-close</span> <span class="token punctuation">&#123;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../images/close.png<span class="token punctuation">)</span></span> top right no-repeat<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=70<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0.7<span class="token punctuation">;</span>
    <span class="token property">-webkit-transition</span><span class="token punctuation">:</span> opacity 0.2s<span class="token punctuation">;</span>
    <span class="token property">-moz-transition</span><span class="token punctuation">:</span> opacity 0.2s<span class="token punctuation">;</span>
    <span class="token property">-o-transition</span><span class="token punctuation">:</span> opacity 0.2s<span class="token punctuation">;</span>
    <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.2s<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">.lb-data .lb-close:hover</span> <span class="token punctuation">&#123;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
    <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token property">progid</span><span class="token punctuation">:</span>DXImageTransform.Microsoft.<span class="token function">Alpha</span><span class="token punctuation">(</span>Opacity=100<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
</code></pre>
</details>

<h2 id="引入资源文件"><a href="#引入资源文件" class="headerlink" title="引入资源文件"></a>引入资源文件</h2><div class="warning">

<blockquote>
<p>注意还需要jquery.js的支持</p>
</blockquote>
</div>

<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">data-lightbox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>image-1<span class="token punctuation">"</span></span> <span class="token attr-name">data-title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>图片title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre>

<blockquote>
<p>href和src都填图片地址</p>
</blockquote>
]]></content>
      <categories>
        <category>开发经验</category>
      </categories>
      <tags>
        <tag>前端</tag>
        <tag>JS</tag>
        <tag>HTML</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title>区块链1_BTC密码学原理及数据结构</title>
    <url>/posts/f1dde85a/</url>
    <content><![CDATA[<h1 id="密码学原理"><a href="#密码学原理" class="headerlink" title="密码学原理"></a>密码学原理</h1><blockquote>
<p>比特币是加密货币，但是其实是公开的？</p>
</blockquote>
<p>比特币用到的两个加密技术：</p>
<ul>
<li>哈希</li>
<li>签名</li>
</ul>
<p>比特币的hash function：<code>SHA-256</code></p>
<ul>
<li>s: secure</li>
<li>h: Hash</li>
<li>a: algorithm</li>
</ul>
<h2 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h2><p>哈希方法的两个特性：</p>
<ul>
<li>Collision resistance(哈希碰撞)</li>
<li>hiding</li>
</ul>
<p>除此之外比特币还用到了个独有的特性</p>
<ul>
<li>puzzle friendly</li>
</ul>
<h3 id="Collision-resistance"><a href="#Collision-resistance" class="headerlink" title="Collision resistance"></a>Collision resistance</h3><p>其实就是哈希值的冲突</p>
<p>Hash(x)&#x3D;Hash(y)</p>
<blockquote>
<p>collision free: 没有高效的方法，人为制造碰撞，也意味着很难篡改内容而不被发现</p>
</blockquote>
<p>符合这个性质的哈希函数为collision free function，但是无法证明是collision free的，可以证明不是collision free的,比如MD5已被证明为可构造的</p>
<h3 id="hiding"><a href="#hiding" class="headerlink" title="hiding"></a>hiding</h3><blockquote>
<p>无法通过输出反推输入，已知H(x)值和哈希函数，很难得到x，除非依靠大量的算力去穷举</p>
</blockquote>
<p>但是有两个前提：</p>
<ul>
<li>输入空间足够大</li>
<li>输入分布均匀</li>
</ul>
<blockquote>
<p>这里举一个例子：某个人证明自己预测股票的能力，他可以提前一天告知电视台自己对明天的预测结果，电视台公布给大众，等到明天去验证正误。但是带来了一个问题，他的预测被公众得知后，已经影响了明天的股票价格。这里就可以用这种hiding的原理，它将自己的预测构造成hash，把hash公布出去，但谁也没办法反推出他的预测内容，只要到明天结果公布后去比对他的预测hash与该hash即可。</p>
</blockquote>
<h3 id="puzzle-friendly"><a href="#puzzle-friendly" class="headerlink" title="puzzle friendly"></a>puzzle friendly</h3><blockquote>
<p>没有捷径获得指定结果范围的输入</p>
</blockquote>
<p>先简单介绍一下挖矿：</p>
<blockquote>
<p>挖矿就是去找一个nonce(一个随机数值,是block header的一部分) 使得H(block header)&lt;&#x3D;target,这就是一个工作量证明</p>
</blockquote>
<p>之所以是工作量证明就是因瓦诶这条性质使得获得nonce只能依靠穷举，无捷径可走</p>
<p>difficult to solve, but easy to verify</p>
<p>挖矿很难，但是很容易验证挖矿的结果</p>
<h2 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h2><p>签名由两部分组成：</p>
<ul>
<li>public key</li>
<li>private key</li>
</ul>
<p>是一种非对称的加密体系，两种应用方法：</p>
<ol>
<li>用接收方的公钥加密，发送给接收方，接收方用自己的私钥解密（保证消息不泄露）</li>
<li>用发送方的私钥加密，发送被接收方，接收方用发送方的公钥解密（保证消息不被篡改，也保证是发送发出的）</li>
</ol>
<p>密钥的构造使用了hash方法，保证了几乎不可能存在两个相同的公私钥</p>
<h2 id="比特币的加密方式"><a href="#比特币的加密方式" class="headerlink" title="比特币的加密方式"></a>比特币的加密方式</h2><p><img src="https://img.qylh.xyz/blog/bitcoincode.png" loading="lazy"></p>
<h1 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h1><p>比特币主要是用到两种数据结构：</p>
<ul>
<li>hash pointers</li>
<li>merkle tree</li>
</ul>
<h2 id="hash-pointers"><a href="#hash-pointers" class="headerlink" title="hash pointers"></a>hash pointers</h2><p>哈希指针，哈希指针除了包括block的地址外，还包括block的hash值</p>
<blockquote>
<p>block chain is a linked list using hash pointers</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/blockchain.png" loading="lazy"></p>
<p>一个哈希指针内的哈希值由前一整个块的内容生成，要想改块内容，后面的hash都得改</p>
<p>比特币中有些节点并不保存整个链，仅保存最近的一部分，需要之前的内容时会想其他节点询问，通过哈希值的验证就可以判断拿到的是不是正确的（因为有恶意节点的存在）</p>
<h2 id="merkle-tree"><a href="#merkle-tree" class="headerlink" title="merkle tree"></a>merkle tree</h2><blockquote>
<p>类似二叉树，只是指针变成了hash pointers</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1656067997831.png" loading="lazy"></p>
<h3 id="全节点与轻节点"><a href="#全节点与轻节点" class="headerlink" title="全节点与轻节点"></a>全节点与轻节点</h3><ul>
<li>全节点保存block header+blocke body</li>
<li>轻节点仅保存block header</li>
</ul>
<h4 id="轻节点如何验证对方已经给自己转账了呢？"><a href="#轻节点如何验证对方已经给自己转账了呢？" class="headerlink" title="轻节点如何验证对方已经给自己转账了呢？"></a>轻节点如何验证对方已经给自己转账了呢？</h4><p>首先会要求转账方发送给自己一个<code>merkle proof</code>，是提条从交易节点一直到根节点的路径（下图绿色所示）<br><img src="https://img.qylh.xyz/blog/1656068141044.png" loading="lazy"></p>
<p>然后自己去向全节点请求一些节点的哈希指针（下图红色所示）</p>
<p><img src="https://img.qylh.xyz/blog/1656068227137.png" loading="lazy"></p>
<p>然后根据tx交易块获得hash指针，再加上请求的hash指针值，可以求得上一个的hash值，一直推到根节点，再与header中记录的根节点的hash值比较，一致则交易信息正确</p>
<p>时间复杂度log2n</p>
<h4 id="如何判断交易不存在呢？"><a href="#如何判断交易不存在呢？" class="headerlink" title="如何判断交易不存在呢？"></a>如何判断交易不存在呢？</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>拿到整棵树，遍历叶节点，判断每个叶节点的正确性并查看有没有某个交易存在</p>
<p>时间复杂度为n</p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>需要时<code>sorted merkle tree</code> 即树是根据hash值排序的（比特币没有证明不存在的需求，所以未排序）</p>
<p>可以根据待验证交易的hash 算得其处于哪两个交易节点之间，然后证明这两个交易节点是正确的，name该交易自然就是不存在的。</p>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>区块链2-BTC协议</title>
    <url>/posts/ddda8a7c/</url>
    <content><![CDATA[<h2 id="非对称加密体系方案"><a href="#非对称加密体系方案" class="headerlink" title="非对称加密体系方案"></a>非对称加密体系方案</h2><blockquote>
<p>使用非对称加密体系，央行发行货币，使用私钥加密，每个人可以用公钥验证真伪。</p>
</blockquote>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>双重支付问题（double spending attack）</li>
</ul>
<h2 id="中心化方案"><a href="#中心化方案" class="headerlink" title="中心化方案"></a>中心化方案</h2><blockquote>
<p>央行发行货币，每个货币有唯一ID，维护一个数据库，每次交易都要记录交易过程，以验证所花的货币在支付人手中。</p>
</blockquote>
<h3 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>中心化方案，维护成本高</li>
</ul>
<h2 id="去中心化方案"><a href="#去中心化方案" class="headerlink" title="去中心化方案"></a>去中心化方案</h2><h2 id="待解决问题"><a href="#待解决问题" class="headerlink" title="待解决问题"></a>待解决问题</h2><ol>
<li>谁来发放货币？</li>
<li>怎么防范双重支付问题</li>
</ol>
<h3 id="发放货币"><a href="#发放货币" class="headerlink" title="发放货币"></a>发放货币</h3><p>通过“挖矿（mining）”实现，具体之后再细说</p>
<h3 id="双重支付问题"><a href="#双重支付问题" class="headerlink" title="双重支付问题"></a>双重支付问题</h3><p>通过区块链这一数据结构解决</p>
<p><img src="https://img.qylh.xyz/blog/blockchain6_29.png" loading="lazy"></p>
<h3 id="交易过程"><a href="#交易过程" class="headerlink" title="交易过程"></a>交易过程</h3><p>A向B转账</p>
<ol>
<li>A需要知道B的地址（由平台提供，比特币本身并不提供）</li>
<li>B（或者其他所有节点）需要知道A的公钥（用于验证）</li>
</ol>
<p>转账方的公钥应该与其资产来源的公钥相一致</p>
<p>比特币中的交易是输入和输出两个脚本，验证合法性时是将货币来源的输入脚本和输出脚本合并在一起来，通过是否能顺利执行来判断是否合法</p>
<h2 id="比特币区块构成"><a href="#比特币区块构成" class="headerlink" title="比特币区块构成"></a>比特币区块构成</h2><h3 id="Block-header"><a href="#Block-header" class="headerlink" title="Block header"></a>Block header</h3><ul>
<li>version</li>
<li>hash of previous <code>block header</code></li>
<li>Merkle root hash</li>
<li>target(挖矿的目标地址)<code>Hash(blocker header)&lt;=target</code></li>
<li>nonce</li>
</ul>
<p>仅取header的hash，因为Merkle root hash 已经能够保证body的正确性</p>
<h3 id="Block-body"><a href="#Block-body" class="headerlink" title="Block body"></a>Block body</h3><ul>
<li>transaction list 交易列表</li>
</ul>
<h2 id="比特币中的共识协议-Consensus-in-BintCoin"><a href="#比特币中的共识协议-Consensus-in-BintCoin" class="headerlink" title="比特币中的共识协议 Consensus in BintCoin"></a>比特币中的共识协议 Consensus in BintCoin</h2><blockquote>
<p>每个账本的内容要取得分布式共识 distributed consensus</p>
</blockquote>
<h3 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h3><h4 id="full-node"><a href="#full-node" class="headerlink" title="full node"></a>full node</h4><blockquote>
<p>保存所有信息，需要验证每一个节点</p>
</blockquote>
<h4 id="light-node"><a href="#light-node" class="headerlink" title="light node"></a>light node</h4><blockquote>
<p>只保存block header，轻节点没办法独立验证交易的合法性</p>
</blockquote>
<h3 id="假设"><a href="#假设" class="headerlink" title="假设"></a>假设</h3><p>系统中大多数节点是正常的，仅部分为恶意节点</p>
<h3 id="投票可以吗"><a href="#投票可以吗" class="headerlink" title="投票可以吗?"></a>投票可以吗?</h3><p>谁可以投票呢？（membership问题）</p>
<p>比特币可不经过系统同意产生账户，那可以通过产生大量的新账号来进行投票以压倒正确方</p>
<h3 id="比特币的投票"><a href="#比特币的投票" class="headerlink" title="比特币的投票"></a>比特币的投票</h3><blockquote>
<p>使用运算能力来投票</p>
</blockquote>
<p>只有找到nonce的节点（由其他节点去判断难度和正确性以及其他的header内容）才有权利去发布下一个节点</p>
<p>仅插在区块链后面的区块才是合法的</p>
<p><img src="https://img.qylh.xyz/blog/1656490208739.png" loading="lazy"></p>
<p>若两个节点同时获得记账权，则可能会产生分叉，比特币中其他节点仅接收最先接收到的那一个。</p>
<p>比特币中怎么算是认可？</p>
<blockquote>
<p>若节点在新节点之后继续延伸，则认为其是合法的</p>
</blockquote>
<p>分叉会在系统中存在一段时间，过一段时间后有了一个新块，连接到了A块后面，则B块就被淘汰了，A块成为了最长合法链。</p>
<h4 id="争夺记账权的动力"><a href="#争夺记账权的动力" class="headerlink" title="争夺记账权的动力"></a>争夺记账权的动力</h4><p>block reward</p>
<p>争夺到记账权的节点可以发行一定量的货币，这也是比特币唯一产生途径。</p>
<p>能造多少呢？</p>
<blockquote>
<p>最开始是50个比特币，21万个区块之后，数量减半</p>
</blockquote>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>区块链3-BTC实现</title>
    <url>/posts/16476e6e/</url>
    <content><![CDATA[<h2 id="transaction-based-ledger"><a href="#transaction-based-ledger" class="headerlink" title="transaction-based ledger"></a>transaction-based ledger</h2><blockquote>
<p>比特币采用基于交易的账本模式，并不直接记录账户余额，每次交易都要说明币的来源 </p>
</blockquote>
<h3 id="UTXO"><a href="#UTXO" class="headerlink" title="UTXO"></a>UTXO</h3><p>全节点维护的数据结构（Unspent Transaction Output）</p>
<p>所有没有被花出去的交易输出集合。</p>
<p><img src="https://img.qylh.xyz/blog/utxo.png" loading="lazy"></p>
<p>可以用于检测交易是否合法，即待交易的货币是否存在于该集合中。</p>
<h3 id="transaction-fee"><a href="#transaction-fee" class="headerlink" title="transaction fee"></a>transaction fee</h3><blockquote>
<p>为了提高全节点记账的积极性，每笔交易都要给予其一定的交易费</p>
</blockquote>
<p>当矿被挖完了之后，这仍然是一种激励机制</p>
<h3 id="挖矿问题"><a href="#挖矿问题" class="headerlink" title="挖矿问题"></a>挖矿问题</h3><blockquote>
<p>Bitcoin is secured by mining</p>
</blockquote>
<p>由于挖矿难度增加，很可能nonce（4字节，32位）找不到一个满足条件的，这时可以调整merkle tree的根哈希值？</p>
<blockquote>
<p>merkle tree中的铸币交易有一个被称为coinbase的区域可以写入任意内容，以影响根哈希值。也就是将coinbase的一部分作为extra nonce。</p>
</blockquote>
<h4 id="Bernoulli-trial"><a href="#Bernoulli-trial" class="headerlink" title="Bernoulli trial"></a>Bernoulli trial</h4><blockquote>
<p>a random experiment with binary outcome</p>
</blockquote>
<p>无记忆性：memoryless</p>
<h4 id="Bernoulli-process"><a href="#Bernoulli-process" class="headerlink" title="Bernoulli process"></a>Bernoulli process</h4><blockquote>
<p>a sequence of independent bernoulli trials</p>
</blockquote>
<p>挖矿尝试次数很多，但每次概率很小可以用（Poison process）泊松过程来近似。</p>
<p>可推导出出块时间服从指数分布。</p>
<p>（progress free）将来还要挖多长时间与已经挖了多长时间是没有关系的。假如已经挖了10分钟了，没有挖出，那么平均还需要再挖10分钟才能挖出。这保证了不同算力挖矿机器的公平性，否则会导致高算力机器不成比例的挖矿成功概率上升。</p>
<p>系统会一直调整让出块时间维持在十分钟左右，而对于每个矿工来说出块时间是根据其算力占该系统的比例来决定的。</p>
<h3 id="比特币数量"><a href="#比特币数量" class="headerlink" title="比特币数量"></a>比特币数量</h3><p>出块奖励每隔四年（21万个区块）会减半</p>
<p>比特币总量多少？</p>
<p>21万*(50+25+12.5+6.25+….)&#x3D;2100万个比特币</p>
<h3 id="安全性问题"><a href="#安全性问题" class="headerlink" title="安全性问题"></a>安全性问题</h3><blockquote>
<p>假设大多数算力都是合法的</p>
</blockquote>
<p>恶意节点从概率上有可能获得记账权</p>
<h4 id="伪造转账？"><a href="#伪造转账？" class="headerlink" title="伪造转账？"></a>伪造转账？</h4><p>不可行，因为其没有转账方的私钥。如果非要写的话，其他节点也不会接受，善意节点会沿着合法的区块继续延伸。非法区块被作废。</p>
<h4 id="双重支付问题？"><a href="#双重支付问题？" class="headerlink" title="双重支付问题？"></a>双重支付问题？</h4><p>两种方式</p>
<h5 id="将区块插在最后面？"><a href="#将区块插在最后面？" class="headerlink" title="将区块插在最后面？"></a>将区块插在最后面？</h5><p>其他节点不会承认</p>
<h5 id="插在与第一次支付平行的位置"><a href="#插在与第一次支付平行的位置" class="headerlink" title="插在与第一次支付平行的位置"></a>插在与第一次支付平行的位置</h5><p><img src="https://img.qylh.xyz/blog/1656750639439.png" loading="lazy"></p>
<p>若正常区块发生某种问题，造成回滚，则非法区块可能会取代正常区块。</p>
<p>如何防范？</p>
<p>多等几个确认（比特币默认需要等6个）才能认为其实正确且不可篡改的。也就是要等一个小时。这样非法节点取代正常区块的难度大大降低。</p>
<h4 id="故意不写某些节点？"><a href="#故意不写某些节点？" class="headerlink" title="故意不写某些节点？"></a>故意不写某些节点？</h4><p>总有其他节点会把交易写到其他节点中去（其实比特币系统中每个区块大小是有限制的，实际上也有可能会写入之后的区块）</p>
<h5 id="藏着发？"><a href="#藏着发？" class="headerlink" title="藏着发？"></a>藏着发？</h5><p>selfish mining</p>
<p>挖到之后不发布，积攒一定长度之后再发布，使其长度长于现有链，以覆盖正常区块。</p>
<p>但前提是有足够大的算力。</p>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>matlab图像处理基础</title>
    <url>/posts/616f055e/</url>
    <content><![CDATA[<p>主要为matlab图像处理工具箱的基本使用</p>
<span id="more"></span>

<h2 id="图像读入"><a href="#图像读入" class="headerlink" title="图像读入"></a>图像读入</h2><p><code>imread(路径)</code></p>
<p>使用时可赋值给一个变量，实际就是一个二维数组</p>
<h2 id="图像的基本信息"><a href="#图像的基本信息" class="headerlink" title="图像的基本信息"></a>图像的基本信息</h2><p><code>imfinfo(&#39;demo.png&#39;)</code></p>
<blockquote>
<p>会返回一个struct 包含文件名，文件大小，文件格式，宽高等等信息。但是要注意这个参数要填<code>文件名</code><br>最开始尝试的是读入的图片对象，报错了，才知道要写文件名，考虑了一下发现应该是imread只返回一个二维数组，而不是一个图像对象，所以没有这些内容。</p>
</blockquote>
<h2 id="图像的二维相关系数"><a href="#图像的二维相关系数" class="headerlink" title="图像的二维相关系数"></a>图像的二维相关系数</h2><p><code>corr2()</code></p>
<blockquote>
<p>此函数本质就是去计算两个矩阵的相关系数</p>
</blockquote>
<pre class="language-matlab" data-language="matlab"><code class="language-matlab">I <span class="token operator">=</span> <span class="token function">imread</span><span class="token punctuation">(</span><span class="token string">'pout.tif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
J <span class="token operator">=</span> <span class="token function">medfilt2</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">;</span>
R <span class="token operator">=</span> <span class="token function">corr2</span><span class="token punctuation">(</span>I<span class="token punctuation">,</span>J<span class="token punctuation">)</span></code></pre>

<h2 id="像素值的获取"><a href="#像素值的获取" class="headerlink" title="像素值的获取"></a>像素值的获取</h2><p><code>impixel()</code></p>
<blockquote>
<p>impixel只传入图像变量，则会进入交互界面左键可选中多个像素点，右键选中最后一个像素点并结束交互，显示出RGB颜色<br> <code>impixel(I,[100,20],[40,80])</code> 传入图像和两个长为n的向量，可以获得n个像素值</p>
</blockquote>
<h2 id="图像均值与标准差"><a href="#图像均值与标准差" class="headerlink" title="图像均值与标准差"></a>图像均值与标准差</h2><p><code>mean2(I)</code><br><code>std2(I)</code></p>
<blockquote>
<p>实质也就是获取的二维矩阵元素的平均值和标准差</p>
</blockquote>
<h2 id="图片展示窗口上显示图片信息"><a href="#图片展示窗口上显示图片信息" class="headerlink" title="图片展示窗口上显示图片信息"></a>图片展示窗口上显示图片信息</h2><pre class="language-matlab" data-language="matlab"><code class="language-matlab"><span class="token function">imshow</span><span class="token punctuation">(</span>I<span class="token punctuation">)</span><span class="token punctuation">;</span>
impixelinfo<span class="token punctuation">;</span></code></pre>

<h2 id="图片的缩放，裁剪和旋转"><a href="#图片的缩放，裁剪和旋转" class="headerlink" title="图片的缩放，裁剪和旋转"></a>图片的缩放，裁剪和旋转</h2><p><code>imresize(I,倍数)</code></p>
<p><code>imcrop(I,rec)</code>  rec为一个向量[左上角x 左上角y 右下角x 右下角y]</p>
<p><code>imrotate(I,deg)</code> 图像旋转 deg 为角度 注意正值为逆时针 负值为顺时针</p>
<p>以上操作都返回处理后的图像！</p>
]]></content>
      <categories>
        <category>数字图像处理</category>
      </categories>
      <tags>
        <tag>数字图像处理</tag>
      </tags>
  </entry>
  <entry>
    <title>区块链4-BTC网络</title>
    <url>/posts/9d7e89b7/</url>
    <content><![CDATA[<p>The BitCoin Network</p>
<span id="more"></span>

<h2 id="BTC-网络"><a href="#BTC-网络" class="headerlink" title="BTC 网络"></a>BTC 网络</h2><p><img src="https://img.qylh.xyz/blog/netword.png" loading="lazy"></p>
<p>网络层为简单的P2P结构（每个节点对等，不存在Super node），节点间通过TCP通信。</p>
<p>设计原则：</p>
<ul>
<li>简单</li>
<li>鲁棒性强</li>
</ul>
<p>simple，robust but not efficient.</p>
<p>每个节点都要维护一个待上链集合，第一次收到交易时转发给其他节点。</p>
]]></content>
      <categories>
        <category>区块链</category>
      </categories>
      <tags>
        <tag>区块链</tag>
      </tags>
  </entry>
  <entry>
    <title>图像的数字化处理</title>
    <url>/posts/d895399a/</url>
    <content><![CDATA[<h2 id="采样"><a href="#采样" class="headerlink" title="采样"></a>采样</h2><blockquote>
<p>方法很简单就是对图像（数组）进行间隔取样，随着取样间隔的增大，图像越来越模糊</p>
</blockquote>
<pre class="language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span>  <span class="token function">fun</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
    <span class="token comment">%获得图片大小</span>
    <span class="token punctuation">[</span>w<span class="token punctuation">,</span>h<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">size</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%画出原图像</span>
    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">imshow</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%命名</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token function">compose</span><span class="token punctuation">(</span>"<span class="token comment">%d*%d",w,h));</span>
    <span class="token comment">%每次图片取样间隔为2，逐渐缩小图像</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span>
        p2<span class="token operator">=</span><span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">imshow</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">title</span><span class="token punctuation">(</span><span class="token function">compose</span><span class="token punctuation">(</span>"<span class="token comment">%d*%d",w/power(2,i),h/power(2,i)));</span>
        p1<span class="token operator">=</span>p2<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>
<p>效果<br><img src="/images/dp1.png" loading="lazy"></p>
<h2 id="量化"><a href="#量化" class="headerlink" title="量化"></a>量化</h2><blockquote>
<p>灰度图像灰度值一般为0-255，可以缩减范围来压缩图片<br>matlab函数为<code>histeq(图片,量化等级)</code></p>
</blockquote>
<pre class="language-matlab" data-language="matlab"><code class="language-matlab">    <span class="token keyword">function</span> <span class="token function">fun2</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
    <span class="token comment">%画出原图像</span>
    <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">imshow</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%命名</span>
    <span class="token function">title</span><span class="token punctuation">(</span><span class="token function">compose</span><span class="token punctuation">(</span>"灰度级<span class="token comment">%d",256));</span>
    <span class="token comment">%每次图片灰度值范围缩减一半</span>
    <span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">7</span>
        p2<span class="token operator">=</span><span class="token function">histeq</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span><span class="token number">256</span><span class="token operator">/</span><span class="token function">power</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">imshow</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">title</span><span class="token punctuation">(</span><span class="token function">compose</span><span class="token punctuation">(</span>"灰度级<span class="token comment">%d",256/power(2,i)));</span>
    <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre>
<p>效果<br><img src="/images/dp2.png" loading="lazy"></p>
]]></content>
      <categories>
        <category>数字图像处理</category>
      </categories>
      <tags>
        <tag>数字图像处理</tag>
      </tags>
  </entry>
  <entry>
    <title>各类数据可视化图应用场景</title>
    <url>/posts/c90bae2/</url>
    <content><![CDATA[<ol>
<li><p>桑基图 用户路径</p>
</li>
<li><p>日历图 某段时间内每天的数据</p>
</li>
<li><p>层次型占比  嵌套饼图</p>
</li>
<li><p>面积图 所需数据涉及累计面积</p>
</li>
<li><p>箱型图 够通过5个数字来描述数据的分布的标准方式，这5个数字包括：最小值，第一分位，中位数，第三分位数，最大值，箱线图能够明确的展示离群点的信息，同时能够让我们了解数据是否对称，数据如何分组、数据的峰度；</p>
</li>
<li><p>热力图 可以理解为三维柱状图的俯视图</p>
</li>
<li><p>漏斗图  直接上图理解截图<br><img src="https://img.qylh.xyz/blog/bb679efd5640b354db792422352df23c.png" loading="lazy"></p>
</li>
<li><p>雷达图 多维度数据比较</p>
</li>
<li><p>象型柱状图 用logo取代传统的长条</p>
</li>
<li><p>旭日图不仅有饼图的优点，而且还能展示数据层级之间的关系，它通过矩形的面积、颜色和排列来显示数据关系，它超越了传统的饼图和环图，能在饼图上表示占比关系的基础上，增加表达了数据的层级和归属关系，能清晰的表达具有父子层次结构类型的数据。旭日图适合用于展示不同层级的数据。</p>
</li>
<li><p>词云图 用于分词统计等</p>
</li>
</ol>
]]></content>
      <categories>
        <category>数学建模</category>
      </categories>
      <tags>
        <tag>数据可视化</tag>
      </tags>
  </entry>
  <entry>
    <title>插值拟合算法</title>
    <url>/posts/c16430da/</url>
    <content><![CDATA[<p>用于处理数据缺失，基本思想是根据周围点建立联系，以补充缺失数据，或者预测未来的数据。</p>
<span id="more"></span>

<h2 id="插值与拟合的应用方向区别"><a href="#插值与拟合的应用方向区别" class="headerlink" title="插值与拟合的应用方向区别"></a>插值与拟合的应用方向区别</h2><blockquote>
<p>每隔一个小时测一次温度，测12小时</p>
<ul>
<li>如果第6个小时忘记测了，根据规律补上一个—–&gt; 插值</li>
<li>如果想要得知12小时以后的 ——&gt; 拟合</li>
</ul>
</blockquote>
<h2 id="插值问题"><a href="#插值问题" class="headerlink" title="插值问题"></a>插值问题</h2><blockquote>
<p>归结为已知函数在某区间内若干点处的值，求函数在该区间内其他点处的值。<br>已知函数$x_0,x_1,x_2\cdots x_n$处的值为$y_0,y_1,y_2\cdots y_n$求简单函数$p(x)$,使得$p(x_i)&#x3D;y_i$.</p>
</blockquote>
<h3 id="拉格朗日插值法"><a href="#拉格朗日插值法" class="headerlink" title="拉格朗日插值法"></a>拉格朗日插值法</h3><p>具体可参考<a href="https://www.zhihu.com/question/58333118">知乎-如何直观地理解拉格朗日插值法？</a></p>
<h3 id="牛顿插值"><a href="#牛顿插值" class="headerlink" title="牛顿插值"></a>牛顿插值</h3><h3 id="高次插值的Runge现象"><a href="#高次插值的Runge现象" class="headerlink" title="高次插值的Runge现象"></a>高次插值的Runge现象</h3><blockquote>
<p>warning<br>插值多项式并不是次数越高越好</p>
</blockquote>
<p><code>Runge现象</code>：使用高次插值的时候在边缘产生的震荡现象</p>
<p>所以再实际中不应该使用七次以上的插值</p>
<blockquote>
<p>避免Runge现象<br>将插值区间分为若干小区间，在每个小区间呗用地刺插值，分段低次插值。</p>
</blockquote>
<h3 id="Matlab插值"><a href="#Matlab插值" class="headerlink" title="Matlab插值"></a>Matlab插值</h3><h4 id="一维"><a href="#一维" class="headerlink" title="一维"></a>一维</h4><p><a href="https://ww2.mathworks.cn/help/matlab/ref/interp1.html">官方文档</a></p>
<pre class="language-matlab" data-language="matlab"><code class="language-matlab">yi<span class="token operator">=</span><span class="token function">interp1</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>xi<span class="token punctuation">,</span><span class="token string">'method'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<p>x,y为插值点（已知），xi,yi为被插值点和插值结果（可以试单一点，也可以是向量）method为插值方法可以选用：</p>
<ul>
<li>nearest 最邻近插值</li>
<li>linear 线性插值(默认方法)</li>
<li>spline 三次样条插值(效果相对好)</li>
<li>cubic 立方插值</li>
</ul>
</blockquote>
<p>matlab拉格朗日插值需要手写。代码如下</p>
<pre class="language-matlab" data-language="matlab"><code class="language-matlab"><span class="token keyword">function</span> y<span class="token operator">=</span><span class="token function">lagrange</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span>x<span class="token punctuation">)</span>   <span class="token comment">%x0,y0为初始坐标，x为需要插值的点，返回的y为插值结果</span>
n<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>m<span class="token operator">=</span><span class="token function">length</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>m
    z<span class="token operator">=</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token number">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
        p<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span>n
            <span class="token keyword">if</span> k<span class="token operator">~=</span><span class="token number">j</span>
                p<span class="token operator">=</span>p<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z<span class="token operator">-</span><span class="token function">x0</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token function">x0</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">x0</span><span class="token punctuation">(</span><span class="token number">j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        s<span class="token operator">=</span>p<span class="token operator">*</span><span class="token function">y0</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">+</span>s<span class="token punctuation">;</span>
    <span class="token keyword">end</span>
    <span class="token function">y</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">=</span>s<span class="token punctuation">;</span>
<span class="token keyword">end</span></code></pre>

<h4 id="二维"><a href="#二维" class="headerlink" title="二维"></a>二维</h4><p>可以将三维图变得更加平缓圆润</p>
<p><a href="https://ww2.mathworks.cn/help/matlab/ref/interp2.html?searchHighlight=interp2&s_tid=srchtitle">zi&#x3D;interp2(x,y,z,xi,yi,’method’)</a></p>
<p>method: </p>
<ul>
<li>nearest 最邻近插值</li>
<li>linear 双线性插值</li>
<li>spline 双上次样条插值</li>
<li>cubic 双立方插值</li>
</ul>
<h4 id="散乱插值"><a href="#散乱插值" class="headerlink" title="散乱插值"></a>散乱插值</h4><blockquote>
<p>二维插值插值点都在网格点上，但是有时可能需要在格子内部插入散乱点，此时使用 散乱插值</p>
</blockquote>
<p><a href="https://ww2.mathworks.cn/help/matlab/ref/griddata.html?searchHighlight=griddata&s_tid=srchtitle">griddata(x,y,z,xi,yi,’method’)</a></p>
]]></content>
      <categories>
        <category>数学建模</category>
      </categories>
      <tags>
        <tag>数学建模</tag>
        <tag>数据处理</tag>
      </tags>
  </entry>
  <entry>
    <title>数学建模论文写作</title>
    <url>/posts/3bb2c030/</url>
    <content><![CDATA[<span id="more"></span>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><blockquote>
<p>摘要可以等完成作品之后再写<br>内容包括</p>
<ul>
<li>建模思想</li>
<li>数学归类</li>
<li>算法思想</li>
<li>建模特点</li>
<li>主要结果<br>突出方法算法，结论，创新点，特点，不要出现图表和数学公式。<br>尽量不要出现<code>我们</code>这样的词语，可以用本文代替</li>
</ul>
</blockquote>
<h2 id="问题重述"><a href="#问题重述" class="headerlink" title="问题重述"></a>问题重述</h2><ul>
<li>关键信息提取</li>
<li>删除不必要信息</li>
<li>语气转换（如请您……需要更改）</li>
</ul>
<h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><blockquote>
<p>可以合到一起写也可以分开一小问一小问分析</p>
</blockquote>
<ul>
<li>问题类型定位</li>
<li>问题特点</li>
<li>问题难点</li>
<li>无关因素剔除</li>
<li>求解完成之后回来重新改一下问题分析</li>
</ul>
<h2 id="提出假设"><a href="#提出假设" class="headerlink" title="提出假设"></a>提出假设</h2><blockquote>
<p>目的：将问题理想化，简单化</p>
</blockquote>
<ul>
<li>假设需要建立在题目的条件和要求之上</li>
<li>不能缺少关键性假设</li>
<li>用严格确切的数学语言来表达假设</li>
<li>假设需要切合题意</li>
</ul>
]]></content>
      <categories>
        <category>数学建模</category>
      </categories>
      <tags>
        <tag>数学建模</tag>
      </tags>
  </entry>
  <entry>
    <title>灰色理论</title>
    <url>/posts/ab8501c5/</url>
    <content><![CDATA[<p>灰色预测模型是通过少量的、不完全的信息，建立数学模型做出预测的一种预测方法。其基于客观事物的过去和现在的发展规律，借助于科学的方法对未来的发展趋势和状况进行描述和分析，并形成科学的假设和判断。</p>
<p>优势为：</p>
<ul>
<li>所需建模信息少</li>
<li>运算方便</li>
<li>建模精度高</li>
<li>可以客服传统回归分析等方法存在的需求数据量大，计算量大，可能出现反常情况等的弊端。<span id="more"></span></li>
</ul>
<h2 id="常用预测模型"><a href="#常用预测模型" class="headerlink" title="常用预测模型"></a>常用预测模型</h2><ul>
<li>微分方程</li>
<li>差分方程</li>
<li>马尔科夫预测方程</li>
<li>灰色预测法</li>
<li>时间序列</li>
<li>插值拟合</li>
<li>神经元拟合</li>
</ul>
<blockquote>
<p>warning<br>没有万能的方法，需要根据实际场景选用合适的模型！！</p>
</blockquote>
<h2 id="什么是灰色系统"><a href="#什么是灰色系统" class="headerlink" title="什么是灰色系统"></a>什么是灰色系统</h2><p>灰色是指，我们的数据并不是完全确定的，既含有已知信息又含有未知信息的系统称为灰色系统。</p>
<h3 id="白色系统"><a href="#白色系统" class="headerlink" title="白色系统"></a>白色系统</h3><blockquote>
<p>系统内部特征完全已知，即系统的信息是完全充分的</p>
</blockquote>
<h3 id="黑色系统"><a href="#黑色系统" class="headerlink" title="黑色系统"></a>黑色系统</h3><blockquote>
<p>内部特征完全未知，只可以通过与外界的联系来加一观测研究</p>
</blockquote>
<h3 id="灰色系统"><a href="#灰色系统" class="headerlink" title="灰色系统"></a>灰色系统</h3><blockquote>
<p>部分信息已知，对一定范围内变化的与时间有关的灰色过程进行预测</p>
</blockquote>
<h2 id="灰色预测模型适用场景"><a href="#灰色预测模型适用场景" class="headerlink" title="灰色预测模型适用场景"></a>灰色预测模型适用场景</h2><p>比如：根据前几天的降雨量，预测明天的降雨量；根据近几年河水污染程度，预测未来污染走势。</p>
<p>应用范畴：</p>
<ul>
<li>灰色关联分析</li>
<li>灰色预测：人口预测，灾难预测等</li>
<li>灰色决策</li>
<li>灰色预测控制</li>
</ul>
<h2 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h2><p>鉴别系统因素之间发展趋势的相异程度，进行关联分析，找出规律，生成有较强规律性的数据序列，然后建立相应的微分方程模型，从而预测事物未来发展趋势的状况</p>
<p>利用等时距观测到的反应预测对象特征的一系列数量值构造模型</p>
<h2 id="常见类型"><a href="#常见类型" class="headerlink" title="常见类型"></a>常见类型</h2><ul>
<li>灰色时间序列预测</li>
<li>畸变预测（通过已有异常值出现时间预测未来异常值出现的时间）</li>
<li>系统预测</li>
<li>拓扑预测（将原始数据做成曲线，在曲线上按照定值寻找该定值发生的所有时间点，构成点时序列，然后预测未来该定值发生时间）</li>
</ul>
<h2 id="灰色关联度与优势分析"><a href="#灰色关联度与优势分析" class="headerlink" title="灰色关联度与优势分析"></a>灰色关联度与优势分析</h2><blockquote>
<p>需要分析哪些因素是对系统来说是主要的，哪些是次要的，哪些是需要抑制的。<br>关注点应该在于，因素间的关联性，关联程度和如何量化。</p>
</blockquote>
<h2 id="灰色关联度"><a href="#灰色关联度" class="headerlink" title="灰色关联度"></a>灰色关联度</h2><blockquote>
<p>可以选最优有点类似层次分析法</p>
</blockquote>
<ul>
<li>选取参考数列</li>
<li>m个比较数列</li>
<li>算出m个关联度</li>
</ul>
<h2 id="灰色生成数列"><a href="#灰色生成数列" class="headerlink" title="灰色生成数列"></a>灰色生成数列</h2><blockquote>
<p>目的：弱化数据的随机性<br>方法：</p>
<ul>
<li>累加法 -》能使任意非负数列转化为非减递增的。</li>
<li>累减法 -》具有求导性质</li>
<li>加权邻值生成</li>
</ul>
</blockquote>
<h2 id="灰色模型-G-M（1-1）"><a href="#灰色模型-G-M（1-1）" class="headerlink" title="灰色模型 G M（1,1）"></a>灰色模型 G M（1,1）</h2><blockquote>
<p>G表示灰色 M表示模型</p>
</blockquote>
<h3 id="建模步骤"><a href="#建模步骤" class="headerlink" title="建模步骤"></a>建模步骤</h3><ol>
<li>数据检验和处理（<code>级比检验</code>）<blockquote>
<p>目的为保证建模方法的可行性<br>如果所有的前一个数除下一个数都落在一个区间内即可进行灰色预测。<br>如果不可以的话可以尝试对数据进行平移变换（一般为统一加上一个数）再进行检验<br>如果还是不行，马上改用其他方法模型。</p>
</blockquote>
</li>
<li>建立GM模型</li>
<li>利用最小二乘法求解a,b</li>
<li>建立微分方程</li>
<li>累减法获得预测值</li>
<li>检验！！<ol>
<li>残差检验</li>
<li>级比偏差值检验</li>
</ol>
</li>
</ol>
]]></content>
      <categories>
        <category>数学建模</category>
      </categories>
      <tags>
        <tag>数学建模</tag>
      </tags>
  </entry>
  <entry>
    <title>CSP-2020-12</title>
    <url>/posts/487ce6a8/</url>
    <content><![CDATA[<p>CSP 2020年12月试题</p>
<span id="more"></span>

<h2 id="第二题-期末预测之最佳阈值"><a href="#第二题-期末预测之最佳阈值" class="headerlink" title="第二题 期末预测之最佳阈值"></a>第二题 期末预测之最佳阈值</h2><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><blockquote>
<p>这次考试是刚转完专业考的，迷迷糊糊的只准备了前两道。但是好像和以前的题不一样，这一次难度加大了，暴力搞只能过70%测试点，导致当时200分的目标都没实现。。<br>这次再看这道题，有了一些思路，如果按照安全指数进行降序排序的话，某一点的预测精准度等于前面结果为0的个数+该点及之后同数值的点为1的个数+之后为0的个数，为了提高效率可做两步处理</p>
<ol>
<li>输入时统计结果为0的个数</li>
<li>遍历时记录前面为1的个数<br>这样根据前两个数据就可以算出预测正确的个数<br>然后从头到尾扫描寻找预测效果最好的那个（注意同一预测效果不同阈值的处理）</li>
</ol>
</blockquote>
<h3 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> y<span class="token punctuation">;</span>
    <span class="token keyword">int</span> r<span class="token punctuation">;</span>
    <span class="token keyword">int</span> prenum<span class="token punctuation">;</span>
    <span class="token keyword">int</span> p<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> s<span class="token punctuation">[</span><span class="token number">100002</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>node a<span class="token punctuation">,</span> node b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>y <span class="token operator">></span> b<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> sum0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">>></span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            sum0<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s <span class="token operator">+</span> n<span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> pre1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>prenum <span class="token operator">=</span> pre1<span class="token punctuation">;</span>
        <span class="token keyword">int</span> j<span class="token punctuation">,</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p <span class="token operator">=</span> pre1<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">==</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>

            s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p <span class="token operator">+=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//cout &lt;&lt; s[i].y &lt;&lt; ' ' &lt;&lt; s[i].r &lt;&lt; ' ' &lt;&lt; s[i].p &lt;&lt; ' ' &lt;&lt; sum0 - (j - s[i].p) &lt;&lt; endl;</span>
        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p <span class="token operator">+=</span> sum0 <span class="token operator">-</span> <span class="token punctuation">(</span>j <span class="token operator">-</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pre1 <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> result<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//cout &lt;&lt; s[i].y &lt;&lt; ' ' &lt;&lt; s[i].p &lt;&lt; endl;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>max <span class="token operator">&lt;</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            max <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>p<span class="token punctuation">;</span>
            result <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>CSP</tag>
      </tags>
  </entry>
  <entry>
    <title>CSP-2021-4</title>
    <url>/posts/b0120d0b/</url>
    <content><![CDATA[<p>CSP 2021年4月试题</p>
<span id="more"></span>

<h2 id="第一题-灰度直方图"><a href="#第一题-灰度直方图" class="headerlink" title="第一题 灰度直方图"></a>第一题 灰度直方图</h2><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><blockquote>
<p>乍一看是一个二维数组模拟灰度值存储，实际上只需要一个一维数组计数即可，类似桶排序，输入一个对应位置加一</p>
</blockquote>
<h3 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp">
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> l<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> l<span class="token punctuation">;</span>
    <span class="token keyword">int</span> temp<span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">v</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cin <span class="token operator">>></span> temp<span class="token punctuation">;</span>
            v<span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cout <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</code></pre>

<h2 id="第二题-邻域均值"><a href="#第二题-邻域均值" class="headerlink" title="第二题 邻域均值"></a>第二题 邻域均值</h2><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><blockquote>
<p>感觉最近两次的第二题暴力算法基本都会超时，只能拿到70分左右，此题也是如此如果对每一个元素循环相加其邻域内的元素相当于增加了两层循环，总循环为4层，会导致30%数据超时，为了提高效率，需要想办法降维。<br>为了提高运算效率，容易想到，提前计算一些东西，在算邻域平均值时可以直接拿来用。<br>此处使用<code>前缀和</code>(数组第k项之前的和)的方式实现，使用一个二维数组rowSum[i][j]表示第i行中j元素之前的所有元素之和，这样就可以通过相减的方式快速算出某一行中某两个元素之间的数字和。这样就减少了一层循环，只需要三层就可完成。成功通过剩余30%测试点</p>
</blockquote>
<h3 id="程序-1"><a href="#程序-1" class="headerlink" title="程序"></a>程序</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//dark用于记录暗点个数</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> l<span class="token punctuation">,</span> r<span class="token punctuation">,</span> t<span class="token punctuation">,</span> temp<span class="token punctuation">,</span> dark <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> l <span class="token operator">>></span> r <span class="token operator">>></span> t<span class="token punctuation">;</span>
    <span class="token comment">//row[i][j]为第i行从0到j个的总和</span>
    <span class="token keyword">int</span> rowSum<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cin <span class="token operator">>></span> temp<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                rowSum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> temp<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                rowSum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> rowSum<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> temp<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">float</span> tempSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> tempNum<span class="token punctuation">;</span>
            <span class="token comment">//区域的界限</span>
            <span class="token keyword">int</span> li <span class="token operator">=</span> i <span class="token operator">-</span> r <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">?</span> i <span class="token operator">-</span> r <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> ri <span class="token operator">=</span> i <span class="token operator">+</span> r <span class="token operator">&lt;</span> n <span class="token operator">?</span> i <span class="token operator">+</span> r <span class="token operator">:</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> lj <span class="token operator">=</span> j <span class="token operator">-</span> r <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">?</span> j <span class="token operator">-</span> r <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> rj <span class="token operator">=</span> j <span class="token operator">+</span> r <span class="token operator">&lt;</span> n <span class="token operator">?</span> j <span class="token operator">+</span> r <span class="token operator">:</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> m <span class="token operator">=</span> li<span class="token punctuation">;</span> m <span class="token operator">&lt;=</span> ri<span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token comment">//此处注意从a到b的和不是rowSum[m][b]-rowSum[m][a]而是rowSum[m][b]-rowSum[m][a-1]同时要注意a-1可能导致的数组越界问题</span>
                tempSum <span class="token operator">+=</span> rowSum<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>rj<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span>lj <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">?</span> rowSum<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">[</span>lj <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token comment">//元素个数和(行数*列数)；</span>
            tempNum <span class="token operator">=</span> <span class="token punctuation">(</span>ri <span class="token operator">-</span> li <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>rj <span class="token operator">-</span> lj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>tempSum <span class="token operator">/</span> tempNum <span class="token operator">&lt;=</span> t<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                dark<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> dark<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>CSP</tag>
      </tags>
  </entry>
  <entry>
    <title>PAT甲级Counting leaves</title>
    <url>/posts/7b3cc1ed/</url>
    <content><![CDATA[<h2 id="原题"><a href="#原题" class="headerlink" title="原题"></a>原题</h2><blockquote>
<p>A family hierarchy is usually presented by a pedigree tree. Your job is to count those family members who have no child.<br>Each input file contains one test case. Each case starts with a line containing <code>0&lt;N&lt;100</code> the number of nodes in a tree, and $M (&lt;N)$, the number of non-leaf nodes. Then M lines follow, each in the format:<br><code>ID K ID[1] ID[2] ... ID[K]</code><br>where ID is a two-digit number representing a given non-leaf node, K is the number of its children, followed by a sequence of two-digit ID’s of its children. For the sake of simplicity, let us fix the root ID to be 01.The input ends with N being 0. That case must NOT be processed.<br>For each test case, you are supposed to count those family members who have no child for every seniority level starting from the root. The numbers must be printed in a line, separated by a space, and there must be no extra space at the end of each line.</p>
</blockquote>
<details>
  <summary>翻译</summary>
一个家族通常用一棵家族树表示，你的个工作是数出没有孩子的家庭成员.
每一个输入文件包含一个测试点，每个测试点包含一个` N 0< N < 100` 表示树中的节点数，以及M表示飞叶节点的个数，接啥来的M行每行的格式为：`ID K ID[1] ID[2] ... ID[K]` 其中ID是一个两位数表示非叶节点，K是它孩子的个数，然后依次是他的孩子节点的ID，为了简单起见，我们假设根节点为01。
对于每一个测试点，你应该数出每一层叶节点的个数。中间用空格分隔，末尾没有多语空格。
</details>

<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><blockquote>
<p>广度优先搜索,记录每一层叶节点个数</p>
</blockquote>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> child<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m<span class="token punctuation">;</span>
    node f<span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">,</span> num<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> id <span class="token operator">>></span> num<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cin <span class="token operator">>></span> c<span class="token punctuation">;</span>
            f<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">.</span>child<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//队列</span>
    queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> q<span class="token punctuation">;</span>
    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//广度优先</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      <span class="token comment">//计数（此层叶节点）</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">//提前记录当前队列中的元素个数（此层的节点数，防止循环内部push导致无法分层）</span>
        <span class="token keyword">int</span> l <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//遍历此层每个节点</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
          <span class="token comment">//叶节点</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">[</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token comment">//将每个节点的孩子入队</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> f<span class="token punctuation">[</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>child<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token comment">//出队头结点</span>
            q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//输出</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cout <span class="token operator">&lt;&lt;</span> count<span class="token punctuation">;</span>
            flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span> <span class="token operator">&lt;&lt;</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>PAT</tag>
        <tag>树</tag>
        <tag>广度优先搜索</tag>
      </tags>
  </entry>
  <entry>
    <title>pat-Ranking</title>
    <url>/posts/b6d5b63d/</url>
    <content><![CDATA[<p>排名问题（同分数排名处理）</p>
<span id="more"></span>
<h2 id="问题重述"><a href="#问题重述" class="headerlink" title="问题重述"></a>问题重述</h2><details>
  <summary>问题描述</summary>

<p>  Programming Ability Test (PAT) is organized by the College of Computer Science and Technology of Zhejiang University. Each test is supposed to run simultaneously in several places, and the ranklists will be merged immediately after the test. Now it is your job to write a program to correctly merge all the ranklists and generate the final rank.</p>
<p>  <code>Input Specification:</code><br>  Each input file contains one test case. For each case, the first line contains a positive number N (≤100), the number of test locations. Then N ranklists follow, each starts with a line containing a positive integer K (≤300), the number of testees, and then K lines containing the registration number (a 13-digit number) and the total score of each testee. All the numbers in a line are separated by a space.</p>
<p>  <code>Output Specification:</code><br>  For each test case, first print in one line the total number of testees. Then print the final ranklist in the following format:</p>
<p>  <code>registration_number</code> <code>final_rank</code> <code>location_number</code> <code>local_rank</code><br>  The locations are numbered from 1 to N. The output must be sorted in nondecreasing order of the final ranks. The testees with the same score must have the same rank, and the output must be sorted in nondecreasing order of their registration numbers.</p>
<p>  <code>Sample Input:</code><br>  2<br>  5<br>  1234567890001 95<br>  1234567890005 100<br>  1234567890003 95<br>  1234567890002 77<br>  1234567890004 85<br>  4<br>  1234567890013 65<br>  1234567890011 25<br>  1234567890014 100<br>  1234567890012 85</p>
<p>  <code>Sample Output:</code><br>  9<br>  1234567890005 1 1 1<br>  1234567890014 1 2 1<br>  1234567890001 3 1 2<br>  1234567890003 3 1 2<br>  1234567890004 5 1 4<br>  1234567890012 5 2 2<br>  1234567890002 7 1 5<br>  1234567890013 8 2 3<br>  1234567890011 9 2 4</p>
</details>

<h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><p>成绩排名问题，难点有两方面：</p>
<ol>
<li>同分排名问题</li>
<li>地区排名问题</li>
</ol>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>排序之后，设置一个变量用于记录已统计的个数，如果当前人的分数和上一个相同排名就和前一个相同，否则按照排名来。<br>地区排名可以理解为分部分排名，可以用数组记录每个地区已经排了多少人了，进而确定当前的排名，但也要注意同分问题。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">node</span>
<span class="token punctuation">&#123;</span>
    string id<span class="token punctuation">;</span>
    <span class="token keyword">int</span> s<span class="token punctuation">;</span>
    <span class="token keyword">int</span> l<span class="token punctuation">;</span>
    <span class="token keyword">int</span> r1<span class="token punctuation">;</span>
    <span class="token keyword">int</span> r2<span class="token punctuation">;</span>
    <span class="token function">node</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        r1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        r2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>node a<span class="token punctuation">,</span> node b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>s <span class="token operator">!=</span> b<span class="token punctuation">.</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span>s <span class="token operator">></span> b<span class="token punctuation">.</span>s<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span>id <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    vector<span class="token operator">&lt;</span>node<span class="token operator">></span> v<span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span>num<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> m<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> n<span class="token punctuation">;</span>
        num<span class="token operator">+=</span>n<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            node temp<span class="token punctuation">;</span>
            cin <span class="token operator">>></span> temp<span class="token punctuation">.</span>id <span class="token operator">>></span> temp<span class="token punctuation">.</span>s<span class="token punctuation">;</span>
            temp<span class="token punctuation">.</span>l <span class="token operator">=</span> i<span class="token punctuation">;</span>
            v<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rank <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> lr<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> lp<span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        lr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        lp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    cout<span class="token operator">&lt;&lt;</span>num<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> r1<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> np<span class="token punctuation">;</span>
        np <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>s <span class="token operator">==</span> v<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>s<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            r1 <span class="token operator">=</span> v<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>r1<span class="token punctuation">;</span>
            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r1 <span class="token operator">=</span> r1<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r1 <span class="token operator">=</span> rank<span class="token punctuation">;</span>
            r1 <span class="token operator">=</span> rank<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        rank<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lp<span class="token punctuation">[</span>np<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">[</span>lp<span class="token punctuation">[</span>np<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>s <span class="token operator">==</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>s<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            r2 <span class="token operator">=</span> v<span class="token punctuation">[</span>lp<span class="token punctuation">[</span>np<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>r2<span class="token punctuation">;</span>
            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r2 <span class="token operator">=</span> r2<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            r2 <span class="token operator">=</span> lr<span class="token punctuation">[</span>np<span class="token punctuation">]</span><span class="token punctuation">;</span>
            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>r2 <span class="token operator">=</span> r2<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        lr<span class="token punctuation">[</span>np<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        lp<span class="token punctuation">[</span>np<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span> <span class="token operator">&lt;&lt;</span> r1 <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span> <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>l <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span> <span class="token operator">&lt;&lt;</span> r2<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>PAT甲级</tag>
      </tags>
  </entry>
  <entry>
    <title>PAT甲级emergency</title>
    <url>/posts/935e8abe/</url>
    <content><![CDATA[<h2 id="原题及翻译"><a href="#原题及翻译" class="headerlink" title="原题及翻译"></a>原题及翻译</h2><blockquote>
<p>As an emergency rescue team leader of a city, you are given a special map of your country. The map shows several scattered cities connected by some roads. Amount of rescue teams in each city and the length of each road between any pair of cities are marked on the map. When there is an emergency call to you from some other city, your job is to lead your men to the place as quickly as possible, and at the mean time, call up as many hands on the way as possible.</p>
</blockquote>
<details>
  <summary>翻译</summary>
> 作为一个城市中一支紧急救援队的领导者，你拿到了一张城市的特殊地图。 地图中展现了通过一些路被联系起来的分散城市。每个城市的救援队伍数量和每两个城市之间的路径长度都被标注在了地图上。当你收到来自其他城市的救援呼叫时，你的工作室带领你的队员尽可能块的感到目的地，同时尽可能多的寻求帮助。
</details>

<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><blockquote>
<p>这题做过中文版的，太长时间没刷题了迪杰斯特拉算法都有点模糊了，从网上找了个代码顺便复习一下。感觉这个代码写的比我的清晰简洁很多。可以当做模板学习一下<br>基本思路就是迪杰斯特拉算法找出最短路的条数,以及保证路径最短的前提下能召集的最多救援队伍数目。</p>
</blockquote>
<h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> m<span class="token punctuation">,</span> C1<span class="token punctuation">,</span> C2<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n <span class="token operator">>></span> m <span class="token operator">>></span> C1 <span class="token operator">>></span> C2<span class="token punctuation">;</span>
    <span class="token comment">//点权，也就是每个城市救援队的数量</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">weight</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> weight<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//边，无路用无限大表示</span>
    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">edge</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> INT_MAX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//到某个点的最短路径</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">dis</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> INT_MAX<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//到某个点的最小路径条数</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">roads</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//到某个点最多可以召集的救援队数量</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">teams</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//访问标记</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token function">visit</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//初始化边权值表</span>
    <span class="token keyword">int</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> L<span class="token punctuation">;</span>
    <span class="token comment">//输入</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> c1 <span class="token operator">>></span> c2 <span class="token operator">>></span> L<span class="token punctuation">;</span>
        edge<span class="token punctuation">[</span>c1<span class="token punctuation">]</span><span class="token punctuation">[</span>c2<span class="token punctuation">]</span> <span class="token operator">=</span> edge<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token punctuation">[</span>c1<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//出发点长度为0</span>
    dis<span class="token punctuation">[</span>C1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//出发点救援队数</span>
    teams<span class="token punctuation">[</span>C1<span class="token punctuation">]</span> <span class="token operator">=</span> weight<span class="token punctuation">[</span>C1<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">//一条路到出发点</span>
    roads<span class="token punctuation">[</span>C1<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">//迪杰斯特拉</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//在未访问的点钟寻找能到达的最短的那条</span>
        <span class="token keyword">int</span> u <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> minn <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>visit<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> dis<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> minn<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                u <span class="token operator">=</span> j<span class="token punctuation">;</span>
                minn <span class="token operator">=</span> dis<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//找不到就结束</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token comment">//访问这个点</span>
        visit<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token comment">//更新点</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> v <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> v<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">//没有访问并且和u点有路</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>visit<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> edge<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">!=</span> INT_MAX<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token comment">//新路优于旧路</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> edge<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">&lt;</span> dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> edge<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    roads<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> roads<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    teams<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> teams<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> weight<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                <span class="token comment">//新旧路长度相同</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dis<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> edge<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">==</span> dis<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token comment">//路径条数增加</span>
                    roads<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> roads<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">+</span> roads<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token comment">//队伍数量更多</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>teams<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> weight<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">></span> teams<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">&#123;</span>
                        <span class="token comment">//更新队伍数量</span>
                        teams<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> teams<span class="token punctuation">[</span>u<span class="token punctuation">]</span> <span class="token operator">+</span> weight<span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> roads<span class="token punctuation">[</span>C2<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> teams<span class="token punctuation">[</span>C2<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>PAT</tag>
        <tag>图</tag>
        <tag>迪杰斯特拉</tag>
      </tags>
  </entry>
  <entry>
    <title>c++刷算法</title>
    <url>/posts/259746b4/</url>
    <content><![CDATA[<p>c++刷算法时的一些技巧</p>
<span id="more"></span>
<h2 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h2><ol>
<li><code>getline(cin,str,&lt;separator&gt;);</code><ul>
<li>三个参数一次为输入流，存放位置，分割符，其中分隔符默认为\n，即默认读取一行</li>
</ul>
</li>
</ol>
<h2 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h2><ol>
<li>字符串转数字<ul>
<li>stoi(int)</li>
<li>stol(long)</li>
<li>stof(float)</li>
<li>stod(double)</li>
</ul>
</li>
<li>字符串可直接用+连接</li>
<li>数字转字符串to_string()</li>
<li>大小写转换<ul>
<li>transform(s.begin(), s.end(), s.begin(), ::toupper); &#x2F;&#x2F;小写转大写</li>
<li>transform(s.begin(), s.end(), s.begin(), ::tolower); &#x2F;&#x2F;大写转小写</li>
</ul>
</li>
</ol>
<h2 id="vector-操作"><a href="#vector-操作" class="headerlink" title="vector 操作"></a>vector 操作</h2><ol>
<li>max_element(v.begin(),v.end()) 可以返回最大元素的迭代器，用*获得最大值 如 <code>*max_element(p.begin(), p.end())</code>,最小值即min_element();</li>
<li>vector 赋值给另一个vector <ul>
<li><strong>直接用等号赋值</strong></li>
<li>v1.assign(v2.begin(), v2.end()); &#x2F;&#x2F;将v2赋值给v1 会清除掉v1以前的内容</li>
</ul>
</li>
<li>v1.swap(v2); 交换vector</li>
</ol>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>c++</tag>
      </tags>
  </entry>
  <entry>
    <title>PAT甲级REcover the Smallest Number</title>
    <url>/posts/undefined/</url>
    <content><![CDATA[<h2 id="原题"><a href="#原题" class="headerlink" title="原题"></a>原题</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><blockquote>
<p>Given a collection of number segments, you are supposed to recover the smallest number from them. For example, given { 32, 321, 3214, 0229, 87 }, we can recover many numbers such like 32-321-3214-0229-87 or 0229-32-87-321-3214 with respect to different orders of combinations of these segments, and the smallest number is 0229-321-3214-32-87.</p>
</blockquote>
<h3 id="输入要求"><a href="#输入要求" class="headerlink" title="输入要求"></a>输入要求</h3><blockquote>
<p>Each input file contains one test case. Each case gives a positive integer <strong>N</strong> (<strong>≤</strong>1<strong>0</strong>4) followed by <strong>N</strong> number segments. Each segment contains a non-negative integer of no more than 8 digits. All the numbers in a line are separated by a space.</p>
</blockquote>
<h3 id="输出要求"><a href="#输出要求" class="headerlink" title="输出要求"></a>输出要求</h3><blockquote>
<p>each test case, print the smallest number in one line. Notice that the first digit must not be zero.</p>
</blockquote>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><blockquote>
<p>题意很简单，就是给定一个数字段，给他拼成一个最小的数。很容易想到贪心算法，但是贪的是什么？</p>
<p>首先想到按从小到大的顺序输出不就好了嘛，但是仔细想想不是这样的比如321&gt;32但是321放前面才是正确的为什么呢？可以这样想假设我们下一个待选的只有a和b两个，两者是不是你在前我在后就是我在后你在前的关系，那么他们后面的数字位数一定是相同的即总位数-前面的位数-a的位数-b的位数，所以从a开始算两种选择的数字大小如下：</p>
<ol>
<li>a在前  ab*10^n</li>
<li>b在前 ba*10^n</li>
</ol>
<p>这样就很容易看出了，决定a和b谁在前面的方法就是比较ab以及ba的大小。</p>
<p>这里可能产生一个疑问，我在每一个位置的选择可不止两种啊，这么多个该怎么比较呢？</p>
<p>有一个巧妙地方法就是借助sort 自己实现一个cmp规则，这样排出的一定符合规则！可以尝试证明一下：</p>
<p>我们假设排完之后的顺序是 a b c d e f…………</p>
<p>使用反证法：如果该顺序不是最优解，那么一定需要通过置换变成最优解，假设我们换了a和c 那么前面从 abc变成了cba（即cba&lt;abc） 而bc&lt;cb  bca&lt;cba  ab&lt;ba  bca&lt;cba&lt;cab同理 一直推到 bca&lt;cba&lt;cab&lt;acb&lt;abc; 两者相悖，所以我们的贪心策略能够得到最优解！</p>
<p>注意输出没有前导零，还有一个测试点需要注意就是结果为0时还要输出0（也就是说不能单纯的不输出前面的0)</p>
</blockquote>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">cmp</span><span class="token punctuation">(</span>string a<span class="token punctuation">,</span> string b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">&lt;</span> b <span class="token operator">+</span> a<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> n<span class="token punctuation">;</span>
    string s<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>
    string result<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cin <span class="token operator">>></span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">sort</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s <span class="token operator">+</span> n<span class="token punctuation">,</span> cmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        result <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token char">'0'</span> <span class="token operator">||</span> <span class="token operator">!</span>flag<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> result<span class="token punctuation">[</span>result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>PAT</tag>
        <tag>贪心</tag>
      </tags>
  </entry>
  <entry>
    <title>PAT甲级Maximum Subsequence Sum</title>
    <url>/posts/e1589103/</url>
    <content><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><h3 id="原题"><a href="#原题" class="headerlink" title="原题"></a>原题</h3><blockquote>
<p>Given a sequence of K integers  A continuous subsequence is defined to be where 1≤i≤j≤K. The Maximum Subsequence is the continuous subsequence which has the largest sum of its elements. For example, given sequence { -2, 11, -4, 13, -5, -2 }, its maximum subsequence is { 11, -4, 13 } with the largest sum being 20.Now you are supposed to find the largest sum, together with the first and the last numbers of the maximum subsequence.</p>
</blockquote>
<blockquote>
<p>理解：其实就是求累积和最大的子序列。</p>
</blockquote>
<h3 id="输入要求"><a href="#输入要求" class="headerlink" title="输入要求"></a>输入要求</h3><blockquote>
<p>Each input file contains one test case. Each case occupies two lines. The first line contains a positive integer K (≤10000). The second line contains K numbers, separated by a space.</p>
</blockquote>
<blockquote>
<p>翻译：每个输入文件包含一个测试点，每个测试点占两行，第一行包含一个小于等于10000的正整数K，第二行包含K个数字，用空格分隔</p>
</blockquote>
<h3 id="输出要求"><a href="#输出要求" class="headerlink" title="输出要求"></a>输出要求</h3><blockquote>
<p>For each test case, output in one line the largest sum, together with the first and the last numbers of the maximum subsequence. The numbers must be separated by one space, but there must be no extra space at the end of a line. In case that the maximum subsequence is not unique, output the one with the smallest indices i and j (as shown by the sample case). If all the K numbers are negative, then its maximum sum is defined to be 0, and you are supposed to output the first and the last numbers of the whole sequence.</p>
</blockquote>
<blockquote>
<p>翻译：对于每个测试点来说，在一行中输出最大和，以及最大子序列的头尾元素。数据必须用一个空格分隔，但行尾无多语空格。如果最大子序列不唯一，输出i和j小的（正如用例那辆），如果所有的数字都是负数，name最大的和应该是0，并且你应该输出整个数列的首位元素。</p>
</blockquote>
<h2 id="基本思路"><a href="#基本思路" class="headerlink" title="基本思路"></a>基本思路</h2><blockquote>
<p>DP问题，状态转移方程为DP[i]&#x3D;max(DP[i-1],v[i]),从中找最大的DP元素即可，麻烦一些的是首位元素的确定：在找最大元素时顺便记录其对应的i（子串的尾部），然后向前探索，每进过一个元素将最大值减去该元素的值，知道为0代表找到了头部。</p>
</blockquote>
<h2 id="AC代码"><a href="#AC代码" class="headerlink" title="AC代码"></a>AC代码</h2><pre class="language-c++" data-language="c++"><code class="language-c++">#include &lt;bits&#x2F;stdc++.h&gt;
using namespace std;
int main()
&#123;
    int n;
    int m &#x3D; -1;
    int end;
    cin &gt;&gt; n;
    vector&lt;int&gt; v(n + 1);
    vector&lt;int&gt; dp(n + 1, 0);
    for (int i &#x3D; 1; i &lt;&#x3D; n; i++)
    &#123;
        cin &gt;&gt; v[i];
        dp[i] &#x3D; max(dp[i - 1] + v[i], v[i]);
        if (dp[i] &gt; m)
        &#123;
            m &#x3D; dp[i];
            end &#x3D; i;
        &#125;
    &#125;
    if (m &lt; 0)
    &#123;
        cout &lt;&lt; 0 &lt;&lt; &#39; &#39; &lt;&lt; v[1] &lt;&lt; &#39; &#39; &lt;&lt; v[n];
        return 0;
    &#125;
    int begin &#x3D; end;
    int temp &#x3D; m;
    for (begin &#x3D; end; begin &gt; 0; begin--)
    &#123;
        temp -&#x3D; v[begin];
        if (temp &#x3D;&#x3D; 0)
        &#123;
            break;
        &#125;
    &#125;
    cout &lt;&lt; m &lt;&lt; &#39; &#39; &lt;&lt; v[begin] &lt;&lt; &#39; &#39; &lt;&lt; v[end];
    return 0;
&#125;</code></pre>

]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>PAT</tag>
        <tag>动态规划</tag>
      </tags>
  </entry>
  <entry>
    <title>兔子试毒问题</title>
    <url>/posts/4ab1b4a2/</url>
    <content><![CDATA[<p>偶然看到一篇文章讲的是一个兔子试毒问题，问题描述如下：<br>有1000瓶药水，其中一瓶是毒药，喝上一滴一天后死亡，现在有一批兔子用于试毒，怎么花费最少的兔子，用最少的时间找出这批药水呢？</p>
<span id="more"></span>

<h2 id="问题抽象"><a href="#问题抽象" class="headerlink" title="问题抽象"></a>问题抽象</h2><p>可以将问题抽象为时间与空间的决策，目标是在两者之间找出一个相对最优的方法。为此我们先想一下两种极端：</p>
<ul>
<li>追求极致的时间：需要一天和1000只兔子</li>
<li>追求极致的空间：需要1只兔子，最坏需要1000天，最好只要一天（倒霉的兔子喝了第一滴就die了），平均下来就是500天，时间复杂度为O(n)</li>
</ul>
<h2 id="分治策略"><a href="#分治策略" class="headerlink" title="分治策略"></a>分治策略</h2><blockquote>
<p>分治策略中比较容易想到的就是二分查找，从这个算法联想到本问题，二分中的找数–&gt;试毒中找那个毒药水。<br>怎么做呢？<br>我们先用两只兔子，将1000瓶分为两份，兔1灌500瓶（中的一滴），兔2灌另500瓶，一天后发现有只兔子die了，name毒药水肯定出在这500瓶中，然后我们再加一只兔子，再各喝一半，以此类推，直到剩下2瓶，此时一兔一瓶，ok了，谁死谁喝的毒药水。</p>
</blockquote>
<p>然后我们还可以根据需求平衡一下，比如采用三分，四分…….等等，兔子越多，时间越短</p>
<h2 id="更好的方法！"><a href="#更好的方法！" class="headerlink" title="更好的方法！"></a>更好的方法！</h2><blockquote>
<p>我也以为分治就是解决此问题的最优解法了，但是看了文章发现并非如此。有一种方法可以用10只兔子在一天内解决问题<br>作者提供了一个二进制编码的方式。1000瓶药，1000个编码，二进制的话就至少需要10位，然后我们进行编码0000000001为药水1我们给最后一只兔子喝下，0000000010，我们给倒数第二只喝下，0000000011，给后两只喝下……..也就时当前药水编码中为1的喝下，一天后观察去世兔子的编号，由于只有一瓶药水有毒，我们就可以还原出毒药水的编号，直接解决问题。</p>
</blockquote>
]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>二分</tag>
        <tag>进制</tag>
      </tags>
  </entry>
  <entry>
    <title>数字范围按位与</title>
    <url>/posts/fd5a0c3d/</url>
    <content><![CDATA[<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>Given two integers left and right that represent the range [left, right], return the bitwise AND of all numbers in this range, inclusive.</p>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>最容易想到的就是暴力做，但肯定会超时。需要想有没有什么规律算法？</p>
<blockquote>
<p>2进制的数字每一个都是在前一个基础上变动而来的，那么他们应该是从某一位之前是相同的。而这一位的位置应该随着两个数的距离而向前移动，所以我们可以将问题简化求为最左端与最右端的这个数的位置，在这个数之前每个位都是相同的，也就是and之后不影响结果，而之后因为两个数之间多个数and导致为0，所以只需要保留前面相同的位置，后面的取0即可。</p>
</blockquote>
<pre class="language-java" data-language="java"><code class="language-java">
<span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">rangeBitwiseAnd</span><span class="token punctuation">(</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> len<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>left<span class="token operator">&lt;</span>right<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            left<span class="token operator">=</span>left<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
            right<span class="token operator">=</span>right<span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>
            len<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> left<span class="token operator">&lt;&lt;</span>len<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</code></pre>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>ESP32使用VLGL(arduino)</title>
    <url>/posts/4229dde3/</url>
    <content><![CDATA[<p>LVGL 为免费开源的图形库，用于在嵌入式设备的屏幕上创建 GUI，也适用于触摸屏</p>
<span id="more"></span>
<p>元件：</p>
<ul>
<li>ESP32</li>
<li>TFT 屏幕<br>软件：</li>
<li>Arduino<br>准备工作：</li>
<li>库<ul>
<li><a href="https://github.com/Bodmer/TFT_eSPI">TFT_eSPI</a></li>
<li><a href="https://github.com/Bodmer/TFT_Touch">TFT_Touch</a>(如果有触摸需求的话)</li>
<li><a href="https://github.com/lvgl/lv_arduino">lv_arduino</a></li>
</ul>
</li>
<li>将库引入 Arduino 的 Library 文化夹中去<br>更改配置文件：<blockquote>
<p>由于默认使用了 User_setup.h 配置文件所以需要根据自己的硬件环境进行更改方法为：<br>在 User_Setup_select.h 文件中将 User_setup.h 头文件注释掉再根据自己的开发版和屏幕型号选择对应的头文件取消注释，然后道相应的头文件里面配置引脚和屏幕大小即可。<br>可以使用库中的 examples 测试。<br>参考：<a href="https://blog.csdn.net/qq_41868901/article/details/107998469">https://blog.csdn.net/qq_41868901/article/details/107998469</a></p>
</blockquote>
</li>
</ul>
]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>硬件开发</tag>
        <tag>Arduino</tag>
        <tag>ESP32</tag>
        <tag>VLGL图形库</tag>
      </tags>
  </entry>
  <entry>
    <title>最长回文子串问题解法</title>
    <url>/posts/9d10d1d8/</url>
    <content><![CDATA[<h2 id="暴力求解"><a href="#暴力求解" class="headerlink" title="暴力求解"></a>暴力求解</h2><p>找出所有子串，依次判断是不是回文子串即可，时间复杂度n^3，大概率导致一些测试点超时。</p>
<h2 id="中心扩展法"><a href="#中心扩展法" class="headerlink" title="中心扩展法"></a>中心扩展法</h2><p>依次将每一个位置作为中心，向两侧扩展，直到不满足回文条件位置，找出最大的长度。</p>
<p>但是要注意每个位置要考虑两种情况：</p>
<ul>
<li>奇数长度如 aba</li>
<li>偶数长度如 abba</li>
</ul>
<p>所以每个位置需要按照两种方式分别进行扩展</p>
<p>时间复杂度n^2</p>
<h2 id="动态规划算法"><a href="#动态规划算法" class="headerlink" title="动态规划算法"></a>动态规划算法</h2><h3 id="状态转移方程"><a href="#状态转移方程" class="headerlink" title="状态转移方程"></a>状态转移方程</h3><p>dp[i,j]&#x3D;</p>
<ul>
<li>dp[i+1,j-1],str[i]&#x3D;str[j]</li>
<li>0,str[i]!&#x3D;str[j]</li>
</ul>
<p>其中<code>dp[j][j]==1</code>含义为从i到j的子串为回文子串</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/**
 * @brief 动态规划算法求解最长回文子串
 *
 * @param s
 * @return int
 */</span>
<span class="token keyword">int</span> <span class="token function">dp</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> longest <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                           <span class="token comment">//记录最长长度</span>
    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                             <span class="token comment">//开始</span>
    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">dp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// n*n向量</span>
    <span class="token comment">// dp[i][j]=1代表从i到j是回文串</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//对角线为1及一个字符长度的回文子串</span>
        <span class="token comment">// aa bb 这种两个的回文串</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                start <span class="token operator">=</span> i<span class="token punctuation">;</span>
                longest <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//当前长度为2</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//长度为l时的起始点</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> j <span class="token operator">=</span> l <span class="token operator">+</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//长度为l时的终点</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                start <span class="token operator">=</span> i<span class="token punctuation">;</span>
                longest <span class="token operator">=</span> l<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> longest<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="马拉车算法"><a href="#马拉车算法" class="headerlink" title="马拉车算法"></a>马拉车算法</h3><ol>
<li>将字符串扩展为奇数位，每两个字符之间插入一个#，并在首位插入两个不一样的其他字符，来防止越界如<code>abc</code>可变为<code>$#a#b#c#^</code></li>
<li>进行马拉车算法，思路参考了<a href="https://www.zhihu.com/question/37289584/answer/**465656849**">知乎Manacher算法</a></li>
</ol>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/**
 * @brief 马拉车算法求解最长回文子串
 *
 * @param s 字符串
 * @return int 长度
 */</span>
<span class="token keyword">int</span> <span class="token function">Manacher</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    s <span class="token operator">=</span> <span class="token function">preProcess</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// p[i]用于存放以i为中心的回文子串长度</span>
    <span class="token keyword">int</span> center <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//当前对称子串的中心及右边界</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> i_mirror <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> center <span class="token operator">-</span> i<span class="token punctuation">;</span> <span class="token comment">// i的对称位置</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">></span> i<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>right <span class="token operator">-</span> i<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i_mirror<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//防止超出右边界，超出后就不一定是p[i]=p[i_mirror]了</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//如果等于R</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//在上述基础上进行中心扩展</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//需要更新边界和中心基准</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> right<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            center <span class="token operator">=</span> i<span class="token punctuation">;</span>
            right <span class="token operator">=</span> i <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注意返回的是迭代器，所以需要用*取值</span>
<span class="token punctuation">&#125;</span></code></pre>

<h3 id="整体代码"><a href="#整体代码" class="headerlink" title="整体代码"></a>整体代码</h3><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">/**
 * @brief 字符串预处理，插入间隔符号
 *
 * @param s 待处理字符串
 * @return string 处理完成的字符串
 */</span>
string <span class="token function">preProcess</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    string temp <span class="token operator">=</span> <span class="token string">"^"</span><span class="token punctuation">;</span> <span class="token comment">//以^开头</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        temp <span class="token operator">+=</span> <span class="token string">"$"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>

        temp <span class="token operator">+=</span> <span class="token string">"#"</span><span class="token punctuation">;</span> <span class="token comment">//以#分割</span>
        temp <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    temp <span class="token operator">+=</span> <span class="token string">"#$"</span><span class="token punctuation">;</span> <span class="token comment">//以$结尾</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * @brief 马拉车算法求解最长回文子串
 *
 * @param s 字符串
 * @return int 长度
 */</span>
<span class="token keyword">int</span> <span class="token function">Manacher</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    s <span class="token operator">=</span> <span class="token function">preProcess</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">p</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// p[i]用于存放以i为中心的回文子串长度</span>
    <span class="token keyword">int</span> center <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//当前对称子串的中心及右边界</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">int</span> i_mirror <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> center <span class="token operator">-</span> i<span class="token punctuation">;</span> <span class="token comment">// i的对称位置</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">></span> i<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>right <span class="token operator">-</span> i<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i_mirror<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//防止超出右边界，超出后就不一定是p[i]=p[i_mirror]了</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//如果等于R</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//在上述基础上进行中心扩展</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//需要更新边界和中心基准</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> right<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            center <span class="token operator">=</span> i<span class="token punctuation">;</span>
            right <span class="token operator">=</span> i <span class="token operator">+</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注意返回的是迭代器，所以需要用*取值</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * @brief 动态规划算法求解最长回文子串
 *
 * @param s
 * @return int
 */</span>
<span class="token keyword">int</span> <span class="token function">dp</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> longest <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                           <span class="token comment">//记录最长长度</span>
    <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                             <span class="token comment">//开始</span>
    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span> <span class="token function">dp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token generic-function"><span class="token function">vector</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// n*n向量</span>
    <span class="token comment">// dp[i][j]=1代表从i到j是回文串</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//对角线为1及一个字符长度的回文子串</span>
        <span class="token comment">// aa bb 这种两个的回文串</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                start <span class="token operator">=</span> i<span class="token punctuation">;</span>
                longest <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//当前长度为2</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//长度为l时的起始点</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> j <span class="token operator">=</span> l <span class="token operator">+</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//长度为l时的终点</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                start <span class="token operator">=</span> i<span class="token punctuation">;</span>
                longest <span class="token operator">=</span> l<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> longest<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    string a<span class="token punctuation">;</span>
    <span class="token function">getline</span><span class="token punctuation">(</span>cin<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">dp</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
</code></pre>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>字符串</tag>
      </tags>
  </entry>
  <entry>
    <title>数模转换</title>
    <url>/posts/25f411ed/</url>
    <content><![CDATA[<p>学习AD&#x2F;DA转换</p>
<span id="more"></span>

<h2 id="ESP32-Arduino开发环境"><a href="#ESP32-Arduino开发环境" class="headerlink" title="ESP32 Arduino开发环境"></a>ESP32 Arduino开发环境</h2><h3 id="ADC"><a href="#ADC" class="headerlink" title="ADC"></a>ADC</h3><blockquote>
<p>即将模拟信号转化为数字信号，0-3.3V等比例映射为0-4095<br>方法：<code>analogRead(引脚);</code>即可返回数字值</p>
</blockquote>
<h3 id="DAC"><a href="#DAC" class="headerlink" title="DAC"></a>DAC</h3><blockquote>
<p>根据设定的数字输出相应的电压值，范围为0-255对应输出电压为 x&#x2F;255*电源电压<br>函数：<code>dacWrite(25, 100);</code><br>25 26 引脚为DAV</p>
</blockquote>
]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>硬件开发</tag>
        <tag>Arduino</tag>
        <tag>ESP32</tag>
        <tag>AD</tag>
      </tags>
  </entry>
  <entry>
    <title>高精度算法</title>
    <url>/posts/5c43c6e5/</url>
    <content><![CDATA[<p>高精度算法也可以称为大整数算法，用于处理那些长度过大，<code>long long</code> 都无法解决的问题。<br>基本思路，利用数组等数据结构存储大整数，然后模拟大整数的运算，来实现高精度运算。</p>
<span id="more"></span>

<h2 id="大整数加法"><a href="#大整数加法" class="headerlink" title="大整数加法"></a>大整数加法</h2><blockquote>
<p>利用两个string存储整数，然后根据两者的长度关系，将短的前面补上0，以实现长度的等长关系，方便后续运算。<br>定义一个int变量用于记录进位关系<br>从sting的尾部（个位）开始逐位相加对10取余加到结果string的前面<code>string支持直接相加实现相连效果</code> 注意也要把前一位的进位信息加上去。并记录本位的进位信息。<br>注意由于加法可能最高位会进一位，所以要注意最后看看首位是否需要加一个1</p>
</blockquote>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//a+b=c</span>
    string a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
    cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
    <span class="token keyword">int</span> as<span class="token operator">=</span>a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>bs<span class="token operator">=</span>bs<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//短的补0</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> as<span class="token operator">-</span>bs<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            b <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bs<span class="token operator">-</span>as<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            a <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//进位信息变量</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//添加到首位</span>
        c <span class="token operator">=</span> <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token char">'0'</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
        <span class="token comment">//记录进位信息</span>
        flag <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token char">'0'</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//是否需要首位补1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        c <span class="token operator">=</span> <span class="token char">'1'</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//输出</span>
    cout <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="大整数减法"><a href="#大整数减法" class="headerlink" title="大整数减法"></a>大整数减法</h2><blockquote>
<p>利用两个string存储整数，然后根据两者的长度关系，将短的前面补上0，以实现长度的等长关系，方便后续运算。<br>定义一个int变量用于记录借位<br>利用字符串比较来保证a总是大的那个数，否则交换一下，并记录一下以便输出的时候输出负号<br>模拟减法</p>
</blockquote>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    string a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">;</span>
    <span class="token keyword">int</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    cin <span class="token operator">>></span> a <span class="token operator">>></span> b<span class="token punctuation">;</span>
    <span class="token keyword">int</span> as <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> bs <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> as <span class="token operator">-</span> bs<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            b <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bs <span class="token operator">-</span> as<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            a <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> a<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">></span> a<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        f <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        string s<span class="token punctuation">;</span>
        s <span class="token operator">=</span> b<span class="token punctuation">;</span>
        b <span class="token operator">=</span> a<span class="token punctuation">;</span>
        a <span class="token operator">=</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> flag <span class="token operator">&lt;</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            c <span class="token operator">=</span> <span class="token keyword">char</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> flag <span class="token operator">-</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
            flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            c <span class="token operator">=</span> <span class="token keyword">char</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> flag <span class="token operator">-</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token char">'0'</span><span class="token punctuation">)</span> <span class="token operator">+</span> c<span class="token punctuation">;</span>
            flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    cout <span class="token operator">&lt;&lt;</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="大整数乘法"><a href="#大整数乘法" class="headerlink" title="大整数乘法"></a>大整数乘法</h2><h2 id="大整数除法"><a href="#大整数除法" class="headerlink" title="大整数除法"></a>大整数除法</h2>]]></content>
      <categories>
        <category>算法</category>
      </categories>
      <tags>
        <tag>算法</tag>
        <tag>高精度</tag>
      </tags>
  </entry>
  <entry>
    <title>STM32+keil5环境配置踩坑</title>
    <url>/posts/15850ddd/</url>
    <content><![CDATA[<p>环境配置主要参考了<a href="https://blog.csdn.net/daniaoxp/article/details/100101149">海创电子的教程</a>,但应该是keil5新版本问题，配置过程中出现了很多问题，本文将进行一个总结</p>
<span id="more"></span>

<h2 id="C-环境的Define填写"><a href="#C-环境的Define填写" class="headerlink" title="C++环境的Define填写"></a>C++环境的Define填写</h2><p>只需要填写<code>USE_STDPERIPH_DRIVER</code>即可，否则会有大量报错出现，好像是由于新版本默认会给添加这个东西</p>
<h2 id="程序烧录后不自动复位"><a href="#程序烧录后不自动复位" class="headerlink" title="程序烧录后不自动复位"></a>程序烧录后不自动复位</h2><p>需要改两个地方：</p>
<ol>
<li>依次点击options for target -&gt; debug -&gt; setting</li>
<li>在flashdownload中将reset and run 勾选上</li>
<li>在pack中将enable取消勾选</li>
<li>保存即可</li>
</ol>
]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>硬件</tag>
        <tag>STM32</tag>
        <tag>keil5</tag>
      </tags>
  </entry>
  <entry>
    <title>汇编语言寄存器总结</title>
    <url>/posts/5d5e7666/</url>
    <content><![CDATA[<p>汇编语言常用寄存器功能总结(持续更新中)</p>
<span id="more"></span>

<h2 id="数据寄存器"><a href="#数据寄存器" class="headerlink" title="数据寄存器"></a>数据寄存器</h2><blockquote>
<p>主要有AX BX CX DX 四大寄存器<br>每一个又分为高（H）和 低 （L）各16位 两部分</p>
</blockquote>
<h3 id="AX"><a href="#AX" class="headerlink" title="AX"></a>AX</h3><ul>
<li>al用于存储输入的字符</li>
<li>ah用于输入输出标志 ah&#x3D;1时为输入 ah&#x3D;2时为输出  ah&#x3D;0AH 时为输入字符串  ah&#x3D;9为输出字符串</li>
<li>除法时用AX放被除数，除完后ah存放余数，al存放商</li>
<li>乘法时al存放乘数，结果存放到ax中</li>
</ul>
<h3 id="BX"><a href="#BX" class="headerlink" title="BX"></a>BX</h3><h3 id="CX"><a href="#CX" class="headerlink" title="CX"></a>CX</h3><h3 id="DX"><a href="#DX" class="headerlink" title="DX"></a>DX</h3><ul>
<li>输出字符时将字符放到dl中去</li>
<li>输入字符串时需要将存储地址放到DX中去</li>
<li>输出字符串时应将字符串第一个字符的地址放到DX中</li>
</ul>
]]></content>
      <categories>
        <category>汇编语言</category>
      </categories>
      <tags>
        <tag>汇编语言</tag>
      </tags>
  </entry>
  <entry>
    <title>计组实验：乘法器</title>
    <url>/posts/7b6ff82/</url>
    <content><![CDATA[<p>计组第二次实验 乘法器</p>
<span id="more"></span>

<h2 id="乘法器模块设计"><a href="#乘法器模块设计" class="headerlink" title="乘法器模块设计"></a>乘法器模块设计</h2><h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><pre class="language-verilog" data-language="verilog"><code class="language-verilog"><span class="token keyword">input</span>         clk<span class="token punctuation">,</span>        <span class="token comment">// 时钟</span>
<span class="token keyword">input</span>         mult_begin<span class="token punctuation">,</span> <span class="token comment">// 乘法开始信号</span>
<span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> mult_op1<span class="token punctuation">,</span>   <span class="token comment">// 乘法源操作数1</span>
<span class="token keyword">input</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> mult_op2<span class="token punctuation">,</span>   <span class="token comment">// 乘法源操作数2</span></code></pre>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><pre class="language-verilog" data-language="verilog"><code class="language-verilog"><span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> product<span class="token punctuation">,</span>    <span class="token comment">// 乘积</span>
<span class="token keyword">output</span>        mult_end   <span class="token comment">// 乘法结束信号</span></code></pre>

<h3 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h3><blockquote>
<p>输入两个32位数mult_op1作为被乘数，mult_op2作为乘数<br>两个数都认为是有符号数所以需要取出符号进行处理<br>mult_begin作为开始信号，还需设置一个乘法进行中的标志信号，开始信号刚变成1时，对初始数据进行处理将进行信号设为1<br>当进行信号为1时每次上升沿到来就进行一次相加，结束后被乘数左移，乘数右移</p>
</blockquote>
<pre class="language-verilog" data-language="verilog"><code class="language-verilog">

<span class="token comment">//乘法正在运算信号和结束信号</span>
    <span class="token keyword">reg</span> mult_valid<span class="token punctuation">;</span>
    <span class="token keyword">assign</span> mult_end <span class="token operator">=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token operator">|</span>multiplier<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//乘法结束信号：乘数全0</span>
    <span class="token important">always @</span><span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>   <span class="token comment">//①</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mult_begin<span class="token punctuation">)</span>    <span class="token comment">//如果没有开始或者已经结束了</span>
        <span class="token keyword">begin</span>
            mult_valid <span class="token operator">&lt;=</span> <span class="token number">1'b0</span><span class="token punctuation">;</span>     <span class="token comment">//mult_valid 赋值成0，说明现在没有进行有效的乘法运算</span>
        <span class="token keyword">end</span>
        <span class="token keyword">else</span>
        <span class="token keyword">begin</span>
            mult_valid <span class="token operator">&lt;=</span> <span class="token number">1'b1</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

    <span class="token comment">//两个源操作取绝对值，正数的绝对值为其本身，负数的绝对值为取反加1</span>
    <span class="token keyword">wire</span>        op1_sign<span class="token punctuation">;</span>      <span class="token comment">//操作数1的符号位</span>
    <span class="token keyword">wire</span>        op2_sign<span class="token punctuation">;</span>      <span class="token comment">//操作数2的符号位</span>
    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> op1_absolute<span class="token punctuation">;</span>  <span class="token comment">//操作数1的绝对值</span>
    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> op2_absolute<span class="token punctuation">;</span>  <span class="token comment">//操作数2的绝对值</span>
    <span class="token keyword">assign</span> op1_sign <span class="token operator">=</span> mult_op1<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">assign</span> op2_sign <span class="token operator">=</span> mult_op2<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">assign</span> op1_absolute <span class="token operator">=</span> op1_sign <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">~</span>mult_op1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> mult_op1<span class="token punctuation">;</span>
    <span class="token keyword">assign</span> op2_absolute <span class="token operator">=</span> op2_sign <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">~</span>mult_op2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> mult_op2<span class="token punctuation">;</span>
    <span class="token comment">//加载被乘数，运算时每次左移一位</span>
    <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> multiplicand<span class="token punctuation">;</span>
    <span class="token important">always @</span> <span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>  <span class="token comment">//②</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mult_valid<span class="token punctuation">)</span>
        <span class="token keyword">begin</span>    <span class="token comment">// 如果正在进行乘法，则被乘数每时钟左移一位</span>
            multiplicand <span class="token operator">&lt;=</span> <span class="token operator">&#123;</span>multiplicand<span class="token punctuation">[</span><span class="token number">62</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1'b0</span><span class="token operator">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">//被乘数x每次左移一位。</span>
        <span class="token keyword">end</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mult_begin<span class="token punctuation">)</span> 
        <span class="token keyword">begin</span>   <span class="token comment">// 乘法开始，加载被乘数，为乘数1的绝对值</span>
            multiplicand <span class="token operator">&lt;=</span> <span class="token operator">&#123;</span><span class="token number">32'd0</span><span class="token punctuation">,</span>op1_absolute<span class="token operator">&#125;</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>

    <span class="token comment">//加载乘数，运算时每次右移一位，相当于y</span>
    <span class="token keyword">reg</span>  <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> multiplier<span class="token punctuation">;</span>
    
    <span class="token important">always @</span> <span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>  <span class="token comment">//③</span>
    <span class="token keyword">begin</span>
    <span class="token function">if</span><span class="token punctuation">(</span>mult_valid<span class="token punctuation">)</span>
    <span class="token keyword">begin</span>       <span class="token comment">//如果正在进行乘法，则乘数每时钟右移一位</span>
         multiplier <span class="token operator">&lt;=</span> <span class="token operator">&#123;</span><span class="token number">1'b0</span><span class="token punctuation">,</span>multiplier<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//相当于乘数y右移一位</span>
    <span class="token keyword">end</span>
    <span class="token keyword">else</span> <span class="token function">if</span><span class="token punctuation">(</span>mult_begin<span class="token punctuation">)</span>
    <span class="token keyword">begin</span>   <span class="token comment">//乘法开始，加载乘数，为乘数2的绝对值</span>
        multiplier <span class="token operator">&lt;=</span> op2_absolute<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    <span class="token comment">// 部分积：乘数末位为1，由被乘数左移得到；乘数末位为0，部分积为0</span>
    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> partial_product<span class="token punctuation">;</span>
    <span class="token keyword">assign</span> partial_product <span class="token operator">=</span> multiplier<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">?</span> multiplicand<span class="token punctuation">:</span><span class="token number">64'd0</span><span class="token punctuation">;</span>        <span class="token comment">//若此时y的最低位为1，则把x赋值给部分积partial_product，否则把0赋值给partial_product</span>
    
    <span class="token comment">//累加器</span>
    <span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">63</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> product_temp<span class="token punctuation">;</span>		<span class="token comment">//临时结果</span>
    <span class="token important">always @</span> <span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>  <span class="token comment">//④//clk信号从0变为1时，激发此段语句的执行，但语句的执行需要时间</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mult_valid<span class="token punctuation">)</span>
        <span class="token keyword">begin</span>
            product_temp <span class="token operator">&lt;=</span> product_temp <span class="token operator">+</span> partial_product<span class="token punctuation">;</span>
        <span class="token keyword">end</span>      
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mult_begin<span class="token punctuation">)</span>
        <span class="token keyword">begin</span>
        product_temp <span class="token operator">&lt;=</span> <span class="token number">64'd0</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
     <span class="token keyword">end</span>

    <span class="token comment">//乘法结果的符号位和乘法结果</span>
    <span class="token keyword">reg</span> product_sign<span class="token punctuation">;</span>	<span class="token comment">//乘积结果的符号</span>
    <span class="token important">always @</span> <span class="token punctuation">(</span><span class="token keyword">posedge</span> clk<span class="token punctuation">)</span>  <span class="token comment">// 乘积⑤</span>
    <span class="token keyword">begin</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mult_valid<span class="token punctuation">)</span>
        <span class="token keyword">begin</span>
              product_sign <span class="token operator">&lt;=</span> op1_sign <span class="token operator">^</span> op2_sign<span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    <span class="token comment">//若乘法结果为负数，则需要对结果取反+1</span>
    <span class="token keyword">assign</span> product <span class="token operator">=</span> product_sign <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">~</span>product_temp<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> product_temp<span class="token punctuation">;</span></code></pre>]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>计算机组成原理与体系结构</tag>
        <tag>龙芯实验平台</tag>
      </tags>
  </entry>
  <entry>
    <title>计组实验：定点加法</title>
    <url>/posts/e25c577d/</url>
    <content><![CDATA[<p>计组第一次实验 定点加法</p>
<span id="more"></span>

<h2 id="新建工程"><a href="#新建工程" class="headerlink" title="新建工程"></a>新建工程</h2><blockquote>
<p>设备选择中 family选择Artix 7  package选择fbg676 型号为：xc7a200tfbg676-2</p>
</blockquote>
<h2 id="添加加法器程序"><a href="#添加加法器程序" class="headerlink" title="添加加法器程序"></a>添加加法器程序</h2><pre class="language-verilog" data-language="verilog"><code class="language-verilog"><span class="token constant">`timescale</span> <span class="token number">1</span>ns <span class="token operator">/</span> <span class="token number">1</span>ps
<span class="token keyword">module</span> <span class="token function">adder</span><span class="token punctuation">(</span>
        <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> operand1<span class="token punctuation">,</span>
        <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> operand2<span class="token punctuation">,</span>
        <span class="token keyword">input</span>        cin<span class="token punctuation">,</span>
        <span class="token keyword">output</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> result<span class="token punctuation">,</span>
        <span class="token keyword">output</span> cout
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">assign</span> <span class="token operator">&#123;</span>cout<span class="token punctuation">,</span>result<span class="token operator">&#125;</span> <span class="token operator">=</span> operand1<span class="token operator">+</span>operand2<span class="token operator">+</span>cin<span class="token punctuation">;</span>
<span class="token keyword">endmodule</span></code></pre>
<ul>
<li>两个32位操作数输入和一个进位信号输入</li>
<li>一个32位结果输入和一位进位信号输出</li>
</ul>
<h2 id="进行仿真"><a href="#进行仿真" class="headerlink" title="进行仿真"></a>进行仿真</h2><h3 id="添加仿真文件"><a href="#添加仿真文件" class="headerlink" title="添加仿真文件"></a>添加仿真文件</h3><pre class="language-verilog" data-language="verilog"><code class="language-verilog"><span class="token constant">`timescale</span> <span class="token number">1</span>ns <span class="token operator">/</span> <span class="token number">1</span>ps   <span class="token comment">//仿真单位时间为1ns，精度为1ps</span>
<span class="token keyword">module</span> testbench<span class="token punctuation">;</span>

    <span class="token comment">// Inputs</span>
    <span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> operand1<span class="token punctuation">;</span>
    <span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> operand2<span class="token punctuation">;</span>
    <span class="token keyword">reg</span> cin<span class="token punctuation">;</span>

    <span class="token comment">// Outputs</span>
    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> result<span class="token punctuation">;</span>
    <span class="token keyword">wire</span> cout<span class="token punctuation">;</span>
    <span class="token comment">// Instantiate the Unit Under Test (UUT)</span>
    adder uut <span class="token punctuation">(</span>
        <span class="token punctuation">.</span><span class="token function">operand1</span><span class="token punctuation">(</span>operand1<span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token punctuation">.</span><span class="token function">operand2</span><span class="token punctuation">(</span>operand2<span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token punctuation">.</span><span class="token function">cin</span><span class="token punctuation">(</span>cin<span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">,</span> 
        <span class="token punctuation">.</span><span class="token function">cout</span><span class="token punctuation">(</span>cout<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">initial</span> <span class="token keyword">begin</span>
        <span class="token comment">// Initialize Inputs</span>
        operand1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        operand2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        cin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// Wait 100 ns for global reset to finish</span>
        <span class="token number">#100</span><span class="token punctuation">;</span>
        <span class="token comment">// Add stimulus here</span>
    <span class="token keyword">end</span>
    <span class="token important">always</span> <span class="token number">#10</span> operand1 <span class="token operator">=</span> <span class="token kernel-function property">$random</span><span class="token punctuation">;</span>  <span class="token comment">//$random为系统任务，产生一个随机的32位数</span>
    <span class="token important">always</span> <span class="token number">#10</span> operand2 <span class="token operator">=</span> <span class="token kernel-function property">$random</span><span class="token punctuation">;</span>  <span class="token comment">//#10 表示等待10个单位时间(10ns)，即每过10ns，赋值一个随机的32位数</span>
    <span class="token important">always</span> <span class="token number">#10</span> cin <span class="token operator">=</span> <span class="token operator">&#123;</span><span class="token kernel-function property">$random</span><span class="token operator">&#125;</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//加了拼接符，&#123;$random&#125;产生一个非负数，除2取余得到0或1</span>
<span class="token keyword">endmodule</span></code></pre>
<p>目的是进行一个随机模拟输入信号，以验证程序正确</p>
<h3 id="进行仿真-1"><a href="#进行仿真-1" class="headerlink" title="进行仿真"></a>进行仿真</h3><p>点击 Run simulation 可以看到波形图，右键信号源可更改颜色和数制等</p>
<h2 id="添加外围模块"><a href="#添加外围模块" class="headerlink" title="添加外围模块"></a>添加外围模块</h2><blockquote>
<p>到板子上需要用触摸屏显示，所以需要加一个触摸屏模块，并将输入输出信号与之联系起来</p>
</blockquote>
]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>计算机组成原理与体系结构</tag>
        <tag>龙芯实验平台</tag>
      </tags>
  </entry>
  <entry>
    <title>计组总线</title>
    <url>/posts/2b9e0476/</url>
    <content><![CDATA[<p>计组总线部分知识点</p>
<span id="more"></span>

<h2 id="什么是总线"><a href="#什么是总线" class="headerlink" title="什么是总线"></a>什么是总线</h2><blockquote>
<p>用来将计算机系统中各个功能部件连接起来，构成一个完整的系统的计算机重要组成部分<br>是一种能由多个部件分时共享的公共信息传送线路。</p>
</blockquote>
<h2 id="总线的作用"><a href="#总线的作用" class="headerlink" title="总线的作用"></a>总线的作用</h2><blockquote>
<ol>
<li>是各功能部件间传递各类信息的通道；</li>
<li>是系统中各部件间的物理接口，能够减少各部件通信的复杂程度；</li>
<li>提供信息交换时所需的数据、地址、时序和控制信息；</li>
<li>提供一个共同遵循的协议或标准；</li>
<li>不应成为整个计算机性能的瓶颈；</li>
<li>方便计算机系统的集成、扩展和进化。</li>
</ol>
</blockquote>
<h2 id="总线传输的特点"><a href="#总线传输的特点" class="headerlink" title="总线传输的特点"></a>总线传输的特点</h2><blockquote>
<p>某一时刻只允许有一个部件向总线发送信息，但多个部件可以同时从总线上接收相同的信息。</p>
</blockquote>
<h2 id="如何减轻总线负载"><a href="#如何减轻总线负载" class="headerlink" title="如何减轻总线负载"></a>如何减轻总线负载</h2><blockquote>
<p>总线上的部件应通过三态驱动缓冲电路与总线连通。</p>
</blockquote>
<h2 id="总线仲裁的目的"><a href="#总线仲裁的目的" class="headerlink" title="总线仲裁的目的"></a>总线仲裁的目的</h2><blockquote>
<p>可以解决多个部件同时申请总线时的使用权分配问题。</p>
</blockquote>
<h2 id="集中式总线控制方式"><a href="#集中式总线控制方式" class="headerlink" title="集中式总线控制方式"></a>集中式总线控制方式</h2><h3 id="菊花链式总线仲裁"><a href="#菊花链式总线仲裁" class="headerlink" title="菊花链式总线仲裁"></a>菊花链式总线仲裁</h3><blockquote>
<p>连线简单，易于扩充，<code>对电路故障最敏感</code></p>
</blockquote>
<h3 id="计数器查询"><a href="#计数器查询" class="headerlink" title="计数器查询"></a>计数器查询</h3><blockquote>
<p>优先级设置较灵活，对故障不敏感，连线及控制过程较复杂</p>
</blockquote>
<h3 id="独立请求"><a href="#独立请求" class="headerlink" title="独立请求"></a>独立请求</h3><blockquote>
<p><code>判优速度最快</code>，但硬件器件用量大，连线多，成本较高。</p>
</blockquote>
<h2 id="总线宽度"><a href="#总线宽度" class="headerlink" title="总线宽度"></a>总线宽度</h2><blockquote>
<p>总线宽度一般指CPU中运算器与存储器之间进行互连的内部总线二进制位数，影响吞吐量。数据总线的位数（w），单位是b（位）是微型计算机的一个重要指标，通常与处理器的字长相一致；</p>
</blockquote>
<h2 id="总线带宽"><a href="#总线带宽" class="headerlink" title="总线带宽"></a>总线带宽</h2><blockquote>
<p>总线的带宽指的是这条总线在单位时间内可以传输的数据总量，它等于总线位宽与工作频率的乘积，总线带宽指的就是它的数据传输率。</p>
</blockquote>
<h2 id="总线复用"><a href="#总线复用" class="headerlink" title="总线复用"></a>总线复用</h2><blockquote>
<p>总线复用指的是数据和地址在同一个总线上传输的方式。</p>
</blockquote>
<h2 id="总线的主从设备"><a href="#总线的主从设备" class="headerlink" title="总线的主从设备"></a>总线的主从设备</h2><h3 id="主设备"><a href="#主设备" class="headerlink" title="主设备"></a>主设备</h3><blockquote>
<p>能够提出申请并获得总线控制权的设备</p>
</blockquote>
<h3 id="从设备"><a href="#从设备" class="headerlink" title="从设备"></a>从设备</h3><blockquote>
<p>只能被动接受总线控制传送数据的设备。</p>
</blockquote>
<h2 id="总线周期"><a href="#总线周期" class="headerlink" title="总线周期"></a>总线周期</h2><blockquote>
<p>是指通过总线完成一次内存读写或完成一次输入输出设备读写所需要的的必须时间</p>
</blockquote>
<h2 id="总线传输周期"><a href="#总线传输周期" class="headerlink" title="总线传输周期"></a>总线传输周期</h2><blockquote>
<p>指主设备和从设备之间完成完整地可靠的通信所需要的时间包括四个步骤</p>
</blockquote>
<ul>
<li>申请分配阶段：主模块申请占用总线的请求，总线运用判优控制仲裁决定</li>
<li>寻址阶段：主模块向从模块给出地址和命令</li>
<li>传数阶段：主模块和从模块交换数据</li>
<li>结束阶段：主模块撤销有关消息</li>
</ul>
<h2 id="总线的通信控制"><a href="#总线的通信控制" class="headerlink" title="总线的通信控制"></a>总线的通信控制</h2><blockquote>
<p>解决主、从设备如何获知传输开始和传输结束，以及通信双方如何协调进行数据通信。</p>
</blockquote>
<h2 id="同步通信和异步通信（总线）"><a href="#同步通信和异步通信（总线）" class="headerlink" title="同步通信和异步通信（总线）"></a>同步通信和异步通信（总线）</h2><h3 id="同步通信"><a href="#同步通信" class="headerlink" title="同步通信"></a>同步通信</h3><blockquote>
<p>信息传送由公共时钟控制，总线中包含时钟线</p>
</blockquote>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>时序关系简单，实现简单。</p>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>在设备速度不一致时按最坏情况确定，</li>
<li>传输线不能太长（时钟相移）</li>
</ul>
<h3 id="异步通信"><a href="#异步通信" class="headerlink" title="异步通信"></a>异步通信</h3><blockquote>
<p>信息传送的每一个操作都是由主设备或从设备特定信号的跳变所确定，总线上每一个事件的发生取决于前一个事件的发生</p>
</blockquote>
<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul>
<li>数据传输可靠，适用于传输周期不同的设备，</li>
<li>对通讯线的长度没有严格的要求。</li>
</ul>
<h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h4><p>速度较慢</p>
<h3 id="半同步"><a href="#半同步" class="headerlink" title="半同步"></a>半同步</h3><blockquote>
<p>总线上各操作之间的时间间隔可以变化，但仅允许为公共时钟周期的整数倍。信号的出现、采样和结束仍以公共时钟为基准。</p>
</blockquote>
<h2 id="为什么说半同步通信保留了同步和异步两者的特点"><a href="#为什么说半同步通信保留了同步和异步两者的特点" class="headerlink" title="为什么说半同步通信保留了同步和异步两者的特点"></a>为什么说半同步通信保留了同步和异步两者的特点</h2><blockquote>
<p>半同步通信既能像同步通信那样由统一时钟控制，又能像异步通信那样允许传输时间不一致。</p>
</blockquote>
<h2 id="总线标准"><a href="#总线标准" class="headerlink" title="总线标准"></a>总线标准</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote>
<p>计算机系统的各部件之间利用总线进行信息传输时应遵守的协议和规范，包括硬件和软件两个方面。</p>
</blockquote>
<h3 id="意义"><a href="#意义" class="headerlink" title="意义"></a>意义</h3><blockquote>
<p>计算机系统中各类模块品种及其复杂，往往一种模块要配一种总线，很难在总线上更换、组合各类模块和设备，解决设备之间总线复杂，传输速度慢等一系列问题。</p>
</blockquote>
<h3 id="常见总线标准"><a href="#常见总线标准" class="headerlink" title="常见总线标准"></a>常见总线标准</h3><ul>
<li>ISA（Industrial Standard Architecture）</li>
<li>EISA（Extended Industry Standard Architecture）</li>
<li>VESA（Video Electronics Standard Association)</li>
<li>PCI 分时复用，即插即用</li>
<li>AGP（Accelerated Graphics Port）（PCI发展而来）</li>
<li>PCIe（Peripheral Component Interconnect Express）</li>
<li>USB</li>
</ul>
<h3 id="即插即用"><a href="#即插即用" class="headerlink" title="即插即用"></a>即插即用</h3><blockquote>
<p>是指当板卡插入系统时，系统会自动对板卡所需资源进行分配，如基地址、中断号等，并自动寻找相应的驱动程序；而不象旧的ISA板卡，需要进行复杂的手动配置。<br>如 PCI，USB</p>
</blockquote>
]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>计算机组成原理与体系结构</tag>
      </tags>
  </entry>
  <entry>
    <title>超标量总结</title>
    <url>/posts/e3ead1b2/</url>
    <content><![CDATA[<h2 id="五级流水"><a href="#五级流水" class="headerlink" title="五级流水"></a>五级流水</h2><p>五级流水阶段:</p>
<ol>
<li>取值IF </li>
<li>指令译码 ID</li>
<li>执行部分 EX</li>
<li>访存 MEM</li>
<li>寄存器堆写回 WB</li>
</ol>
<p>参考<a href="https://blog.csdn.net/Accelerato/article/details/92847394">Verilog 流水线CPU 设计</a></p>
<h2 id="七级流水"><a href="#七级流水" class="headerlink" title="七级流水"></a>七级流水</h2><ol>
<li>将IF段划分成IFA、和IFB<ol>
<li>IFA 确定下一拍的指令地址PC</li>
<li>IFB 从ICache中取出指令</li>
</ol>
</li>
<li>将MEM瓜分成MA，和MB<ol>
<li>MA处理异常，确定访存地址，写内存，通知协处理器处理异常。MA段标记延迟槽。访问外存时，MA发出访存虚拟地址给MB</li>
<li>MB将虚拟地址转换成物理地址并访存。处理异常，更改CPU状态寄存器</li>
</ol>
</li>
</ol>
<p>使用<code>Monitor</code>来控制流水线的暂停和清除</p>
<p>？异常处理</p>
<h3 id="冲突处理"><a href="#冲突处理" class="headerlink" title="冲突处理"></a>冲突处理</h3><p>参考：<a href="https://www.jianshu.com/p/ffd7ccf672ea">数据冒险的解决</a></p>
<p>单发射仅需考虑先写后读问题，可采用数据前递和流水线暂停方式（产生bubble）来处理冲突。</p>
<p><img src="https://img.qylh.xyz/blog/1657937875769.png" loading="lazy"></p>
<p>数据前递更为高效：</p>
<p>当发生先写后读问题时，虽然前一条指令还没有写进去，但是运算结果早就已经出来了，所以这个时候可以通过旁路将结果直接传递给下一条指令<br><img src="https://img.qylh.xyz/blog/1657938419610.png" loading="lazy"></p>
<p><img src="https://img.qylh.xyz/blog/1657937707451.png" loading="lazy"></p>
<p>但是如果前一条指令是load，而下一条指令需要使用load的数据，那数据前递是无法处理的，这个时候可以通过插入空泡处理。</p>
<h2 id="双发射"><a href="#双发射" class="headerlink" title="双发射"></a>双发射</h2>]]></content>
      <categories>
        <category>硬件</category>
      </categories>
      <tags>
        <tag>龙芯杯</tag>
        <tag>多级流水</tag>
        <tag>双发射</tag>
      </tags>
  </entry>
  <entry>
    <title>HBU计网复习整理</title>
    <url>/posts/59d0a2d6/</url>
    <content><![CDATA[<p>计算机网络知识点个人总结，仅供参考，请勿过分解读</p>
<span id="more"></span>

<p>当时整理在了幕布平台上，这里给出分享链接,如有错误请批评指正</p>
<p><a href="https://www.mubucm.com/doc/aONkBGZtii">概述和物理层</a></p>
<p><a href="https://www.mubucm.com/doc/2qLEtOg6xyi">数据链路层</a></p>
<p><a href="https://www.mubucm.com/doc/2wyF5qRGW2i">传输层</a></p>
<p><a href="https://www.mubucm.com/doc/k5zNhO0Ryi">网络层</a></p>
<p><a href="https://www.mubucm.com/doc/t__GlQMBOi">应用层</a></p>
<p><a href="https://www.mubucm.com/doc/7XQ6mrOSPOi">概括总结</a></p>
<p><a href="https://www.mubucm.com/doc/35DQemuf2i">简答题</a></p>
<p><a href="https://www.mubucm.com/doc/5LrXXZXXN2i">计算题</a></p>
]]></content>
      <categories>
        <category>计算机网络</category>
      </categories>
      <tags>
        <tag>计算机网络</tag>
      </tags>
  </entry>
  <entry>
    <title>内网穿透</title>
    <url>/posts/bd50b816/</url>
    <content><![CDATA[<h2 id="外网-amp-内网"><a href="#外网-amp-内网" class="headerlink" title="外网&amp;内网"></a>外网&amp;内网</h2><h3 id="什么是内网？（私网地址）"><a href="#什么是内网？（私网地址）" class="headerlink" title="什么是内网？（私网地址）"></a>什么是内网？（私网地址）</h3><p>可以理解为学校的局域网，或者宿舍内的WIFI，同一局域网内主机IP互不相同，但不同局域网内的主机IP可以相同（这也就是为什么要做内网穿透，因为不知道该去哪里找目标IP），而且内网IP是动态的，不是固定的。</p>
<p>如何辨别内网IP？</p>
<blockquote>
<p>IPv4 将IP划分成了A，B，C，D,E 五类地址 参考<a href="https://www.jianshu.com/p/71113f0c451c">IP地址划分</a><br>A,B,C类地址中的一部分被拿出来作为了内网地址，具体如下<br>A类地址：10.0.0.0～10.255.255.255</p>
</blockquote>
<p>B类地址：172.16.0.0 ～172.31.255.255</p>
<p>C类地址：192.168.0.0～192.168.255.255</p>
<h3 id="什么是外网？（公网地址）"><a href="#什么是外网？（公网地址）" class="headerlink" title="什么是外网？（公网地址）"></a>什么是外网？（公网地址）</h3><p>外网的设备的IP是唯一的，不可能找到两台外网设备具有同一IP，比如一台公网服务器。</p>
<h3 id="内网是如何上网的？"><a href="#内网是如何上网的？" class="headerlink" title="内网是如何上网的？"></a>内网是如何上网的？</h3><p>私网地址是不能直接上网的，我们的手机流量或者宿舍的路由器，其实是通过运营商提供的公网地址间接上网的（可以理解为一个公网地址让其下面的私网地址具备了上网能力），具体原理可参考<a href="https://www.cnblogs.com/ranyonsue/p/9713992.html">内网和外网之间的通信</a>，一句话概括的话就是公网IP将其下的端口映射给他下面的内网地址。</p>
<h3 id="私网地址这么麻烦为什么要用？"><a href="#私网地址这么麻烦为什么要用？" class="headerlink" title="私网地址这么麻烦为什么要用？"></a>私网地址这么麻烦为什么要用？</h3><p>最重要的原因是IPV4地址不够用了，IPV4标准下，IP地址有四段，每段8位，也就是共有32位。可以算出可以提供2^32个不同的地址(4294967296个)看起来很多，实际上远远不够用，而且被美国等占据了大多数，因此提出了私网地址，以缓解IP地址不够用的困境。</p>
<p>另一方面进行内网划分也可以增强安全性。</p>
<h3 id="IPV6的提出及困境"><a href="#IPV6的提出及困境" class="headerlink" title="IPV6的提出及困境"></a>IPV6的提出及困境</h3><p>为了增大IP地址范围，1994年便提出了IPV6标准，使用128位来表示IP，也就是IP数量达到了2^128，据说能给地球上的所有沙子都分配一个地址。可见IPV6是足够人类使用的，但是缺迟迟得不到推广。原因在于NAT技术的发展暂时解决了IP的数量限制，而且从IPV4转换到V6也比较困难。详见<a href="https://zhuanlan.zhihu.com/p/45532693">IPV6取代IPV4之路 为何道阻且长？</a></p>
<h2 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h2><blockquote>
<p>也叫NAT穿透，是指计算机在内网（局域网）内使用私有IP地址，在连接外网（互联网）时使用全局IP地址的技术。</p>
</blockquote>
<h3 id="内网穿透应用场景"><a href="#内网穿透应用场景" class="headerlink" title="内网穿透应用场景"></a>内网穿透应用场景</h3><p>举个例子，如果我的电脑放在了宿舍（假设处于开机状态，且连接WIFi），而我在其他地方突然需要使用电脑上的资料，但是由于电脑在宿舍的局域网内，不具有公网IP，我是无法连接到电脑的。然而，如果我在上面做了内网穿透，就可以通过一个绑定的域名访问到内网的设备。</p>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><blockquote>
<p>能够实现内网穿透的工具有很多，比如frp，natapp，花生壳，SuiDao等等这里根据两个使用场景选用了两个还不错的进行介绍。（均对HTTP服务进行穿透，TCP，UDP等类似）</p>
</blockquote>
<h3 id="具备公网服务器–frp"><a href="#具备公网服务器–frp" class="headerlink" title="具备公网服务器–frp"></a>具备公网服务器–frp</h3><p>适合场景：</p>
<ul>
<li>具有一台公网服务器（阿里云，腾讯云等等）</li>
<li>有自己的域名</li>
<li>会使用基本的linux命令</li>
<li>能够看懂文档，出现问题能通过文档自行解决。<blockquote>
<p><a href="https://github.com/fatedier/frp">github地址</a><br><a href="https://gofrp.org/docs/">官方文档</a><br><a href="https://github.com/fatedier/frp/releases">下载地址</a></p>
</blockquote>
</li>
</ul>
<h4 id="服务器端"><a href="#服务器端" class="headerlink" title="服务器端"></a>服务器端</h4><ol>
<li>首先下载适合服务器端系统的压缩包，将其解压到合适的路径。</li>
<li>修改frps.ini 文件<pre class="language-[common]" data-language="[common]"><code class="language-[common]">bind_port &#x3D; 2345
vhost_http_port &#x3D; 8001</code></pre>
选择的端口可自定义（但也不要选择已经被占用的端口啊啊啊），但记得对端口进行放行（如果你配置完发现不能用，很有可能是没有放行相关端口）</li>
<li>启动服务 :在安装目录下输入命令 <code>./frps -c ./frps.ini</code></li>
</ol>
<h4 id="内网电脑"><a href="#内网电脑" class="headerlink" title="内网电脑"></a>内网电脑</h4><ol>
<li>下载适合自己电脑的压缩包（一般都是windows叭）</li>
<li>修改frpc.ini文件<pre class="language-[common]" data-language="[common]"><code class="language-[common]">server_addr &#x3D; 服务器IP
server_port &#x3D; 2345（与上面的bind_port相对应）
[web]
type &#x3D; http
local_ip &#x3D; 192.168.3.43（本机的话就是127.0.0.1就好了，我这里是穿透到了同一局域网内的esp8266）
local_port &#x3D; 80 (对应HTTP服务)
custom_domains &#x3D; 自己的域名</code></pre></li>
<li>将域名解析到服务器IP（域名购买商会提供服务，比如我的是在阿里云买的，就可以在阿里云进行解析）</li>
<li>启动服务 <code>./frpc -c ./frpc.ini</code> <strong>注意这里时frpc代表客户端，俄日frps代表服务端</strong></li>
<li>成功启动后命令行会提示连接成功</li>
<li>通过 绑定的域名+端口（vhost_http_port）即可访问内网服务，如xxx.com:8001</li>
</ol>
<h4 id="配置成服务"><a href="#配置成服务" class="headerlink" title="配置成服务"></a>配置成服务</h4><p>由于现在是在命令行启动，一旦关闭命令行服务也会停止，可以注册成服务，比如linux可以使用Spuervisor进行进程守护，windows可以使用NSSM注册成服务。（其实就是写一段启动命令，注意注册服务时要写绝对路径，比如我的服务器上安装目录在home&#x2F;frp&#x2F;下就要写:<code>home/frp/frps -c home/frp/frps.ini</code> windows同理，但可能需要将frpc的扩展名补充上去（.exe））</p>
<h4 id="问题自查："><a href="#问题自查：" class="headerlink" title="问题自查："></a>问题自查：</h4><ol>
<li>端口是否放行</li>
<li>域名是否解析</li>
<li>服务是否启动</li>
<li>端口是否冲突</li>
<li>IP是否填写正确</li>
</ol>
<h3 id="不具备公网服务器–SuiDao"><a href="#不具备公网服务器–SuiDao" class="headerlink" title="不具备公网服务器–SuiDao"></a>不具备公网服务器–<a href="https://suidao.io/#/">SuiDao</a></h3><p>是一个基于开源FastTunnel免费内网穿透服务，会免费提供给你域名及服务器<br>适用场景：</p>
<ol>
<li>不具备外网服务器</li>
<li>需求访问量较小</li>
</ol>
<h4 id="注册及登录"><a href="#注册及登录" class="headerlink" title="注册及登录"></a>注册及登录</h4><p>注册称为<a href="https://suidao.io/%E7%9A%84%E7%94%A8%E6%88%B7">https://suidao.io/的用户</a></p>
<h4 id="创建隧道"><a href="#创建隧道" class="headerlink" title="创建隧道"></a>创建隧道</h4><p><img src="http://chevereto.qylh.xyz/images/2022/03/08/Snipaste_2022-03-08_13-40-20.jpg" alt="img" loading="lazy"></p>
<p>填写服务器所在地，隧道类型，子域名，内网IP，端口（http是80端口）</p>
<h4 id="去个人中心复制AccessKey"><a href="#去个人中心复制AccessKey" class="headerlink" title="去个人中心复制AccessKey"></a>去个人中心复制AccessKey</h4><h4 id="下载客户端"><a href="#下载客户端" class="headerlink" title="下载客户端"></a>下载客户端</h4><p>根据系统条件选择合适的<a href="https://gitee.com/Hgui/FastTunnel.SuiDao/releases">客户端</a></p>
<h4 id="启动客户端"><a href="#启动客户端" class="headerlink" title="启动客户端"></a>启动客户端</h4><p>启动后会提示你输入AccessKey,将刚刚复制的粘贴进去就好了。</p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><p>使用刚刚设定的域名进行访问</p>
<h4 id="配置自己的域名"><a href="#配置自己的域名" class="headerlink" title="配置自己的域名"></a>配置自己的域名</h4><p>如果有自己的域名，可以将域名解析到上面分配的域名上去，具体方法：</p>
<ol>
<li>通过ping 刚刚获得的域名得到改域名指向的IP地址</li>
<li>将自己的域名解析到此IP地址。</li>
</ol>
]]></content>
      <categories>
        <category>计算机网络</category>
      </categories>
      <tags>
        <tag>物联网</tag>
        <tag>内网穿透</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>跨源资源共享CORS</title>
    <url>/posts/299e0af6/</url>
    <content><![CDATA[<p>跨源资源共享 (CORS)（或通俗地译为跨域资源共享）是一种基于 HTTP 头的机制，该机制通过允许服务器标示除了它自己以外的其它 origin（域，协议和端口），使得浏览器允许这些 origin 访问加载自己的资源。</p>
<span id="more"></span>

<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><blockquote>
<p>运行在 <a href="https://domain-a.com/">https://domain-a.com</a> 的 JavaScript 代码使用 XMLHttpRequest 来发起一个到 <a href="https://domain-b.com/data.json">https://domain-b.com/data.json</a> 的请求。出于安全性，浏览器限制脚本内发起的跨源HTTP请求,这就返回了CORS错误。</p>
</blockquote>
<p><img src="http://img.qylh.xyz/blog/1650890683308.png" alt="示意图" loading="lazy"></p>
<p>跨源域资源共享（CORS）机制允许 Web 应用服务器进行跨源访问控制，从而使跨源数据传输得以安全进行。</p>
<p>有些请求（非简单请求）会出发CORS预检，浏览器使用OPTIONS方法发起，获得此服务端是否允许该跨源请求，服务器确认允许后才发送实际的HTTP请求。</p>
<h2 id="如何应对跨域问题"><a href="#如何应对跨域问题" class="headerlink" title="如何应对跨域问题"></a>如何应对跨域问题</h2><h3 id="后端解决"><a href="#后端解决" class="headerlink" title="后端解决"></a>后端解决</h3><p>注：待实践后完善</p>
<p>利用预检获知服务端对跨源请求支持的HTTP方法。再以实际的HTTP请求方法发送那个真正的请求</p>
<p>优点：</p>
<ol>
<li>前端方便</li>
<li>一劳永逸</li>
<li>开发环境和正式环境都可以使用</li>
</ol>
<p>缺点：</p>
<ol>
<li>后端稍麻烦</li>
</ol>
<h3 id="前端解决"><a href="#前端解决" class="headerlink" title="前端解决"></a>前端解决</h3><p>开发环境使用webpack的proxy解决，正式环境使用Nginx反向代理</p>
<p>参考资料</p>
<p><a href="https://panjiachen.github.io/vue-element-admin-site/zh/guide/advanced/cors.html#%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98">vue-element-admin 文档</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS">MDN</a></p>
]]></content>
      <categories>
        <category>计算机网络</category>
      </categories>
      <tags>
        <tag>WEB</tag>
      </tags>
  </entry>
  <entry>
    <title>人月神话读书笔记</title>
    <url>/posts/f5cf8999/</url>
    <content><![CDATA[<h3 id="焦油坑"><a href="#焦油坑" class="headerlink" title="焦油坑"></a>焦油坑</h3><blockquote>
<p>恐龙、猛犸象、剑齿虎在焦油中挣扎，他们挣扎的越猛烈，焦油纠缠的就越紧，没有那种猛兽足够强壮或具有足够的技巧，能够挣脱舒服，他们最终都沉到了坑底。<br>过去几十年的大型系统开发就犹如这样一个焦油坑，很多大型或强壮的动物在其中剧烈地整张</p>
</blockquote>
<p>作为本书的第一章，作者描述了一个各种动物在焦油坑中挣扎的场景，我的理解是如果软件开发方法不对，多么强大的软件工程师也会被其纠缠进去。</p>
<h3 id="人月神话"><a href="#人月神话" class="headerlink" title="人月神话"></a>人月神话</h3><blockquote>
<p>用人月作为衡量一项工作的规模是一个危险和带有欺诈性的神话，它暗示着人员数量和时间是可以相互替代的。<br>向进度落后的项目中增加人手，只会使进度更加落后</p>
</blockquote>
<p>在软件工程课程上我们学习过用人月这一个单位来评估软件开发规模，如果没有团队开发的经验很容易陷入人数和时间是可以互换的误区，就如同算法中时间和空间那样。但是在实际项目开发过程中，如果中期发现进度缓慢，这个时候去盲目地增加人手可能适得其反（除非是完全可以分解的任务）。</p>
<p>这一点比较有体会，曾经在开发某系统时发现时间比较紧迫，有同学向我提供帮助，本是一件好事，但最终却适得其反，因为对方对此系统几乎一无所知，对已完成的工作也不太清楚，我们需要花费相当多的时间来向其解释。</p>
<h3 id="外科手术队伍"><a href="#外科手术队伍" class="headerlink" title="外科手术队伍"></a>外科手术队伍</h3><blockquote>
<p>效率高和效率低的实施者之间个体差异非常大，经常能够达到数量级的水平</p>
</blockquote>
<p>这部分给出了一种开发团队的架构</p>
<ol>
<li>对于小型系统，开发团队应简而精</li>
<li>对于大型系统，采用外科手术团队</li>
</ol>
<p>外科手术团队构成（10人）：</p>
<ol>
<li>外科医生（首席程序员）</li>
<li>副手</li>
<li>管理员</li>
<li>编辑</li>
<li>两个文秘分别给管理员和编辑</li>
<li>程序职员</li>
<li>工具维护人员</li>
<li>测试人员</li>
<li>语言学家</li>
</ol>
<h3 id="贵族专制、民主政治和系统设计"><a href="#贵族专制、民主政治和系统设计" class="headerlink" title="贵族专制、民主政治和系统设计"></a>贵族专制、民主政治和系统设计</h3><p>这部分不是很理解emm</p>
<p>概念完整性: 为了反映一系列连贯的设计思路，宁可忽略一些不规则的特性和改进，也不提倡独立和无法整合的系统，哪怕他们其实包含着许多很好的设计。</p>
<p>为什么要获得概念的完整性：<br>    1. 定义系统的易用性：易用性 &#x3D; 功能 &#x2F; 理解的复杂度<br>    2. 所以当功能一定时，理解的难度越低，系统约易用，而概念越完整系统就会更加简洁直白。</p>
<p>该有谁来指定结构？<br>    “精英”而非具体的实现人员，尽管实现人员也会有很多好的创意，但是为了维护系统概念的完整性必须放弃。</p>
<h3 id="画蛇添足"><a href="#画蛇添足" class="headerlink" title="画蛇添足"></a>画蛇添足</h3><p>需要制约结构师的创造性热情，这会使得系统变得复杂</p>
<blockquote>
<p>结构师在开发第一个系统时会倾向于简洁精炼，而第二个系统将是最危险的系统，他们会向系统添加很多修饰功能和想法，导致系被过分设计。</p>
</blockquote>
<p>结构师与开发成员的交互准则</p>
<ul>
<li>牢记开发人员承担创造性和发明性的实现责任，因此结构师只能建议不能支配</li>
<li>时刻准备着为指定的说明建议另一种实现方法，同时准备接收其他任何能达到目标的方法</li>
<li>对上述的建议保持低调和不公开。</li>
<li>准备放弃坚持所做的改进建议</li>
</ul>
<h3 id="贯彻执行"><a href="#贯彻执行" class="headerlink" title="贯彻执行"></a>贯彻执行</h3><p>如何保证每个开发人员都能听到、理解并实现结构师的决策？这一部分给出了一些解决方案</p>
<ol>
<li>编写文档化的规格说明</li>
<li>形式化定义</li>
<li>直接整合（约定接口）</li>
<li>会议</li>
<li>电话日志（开发人员不确定时直接联系结构师，结构师记录问题并整合然后分发给用户和实现人员）</li>
<li>测试 测试人员去发现一些没有贯彻落实的地方</li>
</ol>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>耦合与内聚</title>
    <url>/posts/5569bfa4/</url>
    <content><![CDATA[<p>高内聚，低耦合！</p>
<span id="more"></span>


<h2 id="耦合"><a href="#耦合" class="headerlink" title="耦合"></a>耦合</h2><p><img src="http://chevereto.qylh.xyz/images/2022/04/23/416.png" alt="图示" loading="lazy"></p>
<blockquote>
<p>是对软件系统结构中，各模块间相互联系紧密程度的一种度量。</p>
</blockquote>
<h3 id="低耦合"><a href="#低耦合" class="headerlink" title="低耦合"></a>低耦合</h3><h4 id="无直接耦合"><a href="#无直接耦合" class="headerlink" title="无直接耦合"></a>无直接耦合</h4><p>两个模块之间没有直接关系</p>
<h4 id="数据耦合"><a href="#数据耦合" class="headerlink" title="数据耦合"></a>数据耦合</h4><p>一模块访问另一模块时，通过<code>数据参数</code>交换输入、输出信息。</p>
<p>举例:</p>
<ul>
<li>函数间通过参数传递参数</li>
<li><pre class="language-c++" data-language="c++"><code class="language-c++">void fun1(int x)
&#123;
    &#x2F;&#x2F;..........
&#125;
void fun2()
&#123;
    int test;
    fun1(test)
&#125;
</code></pre></li>
</ul>
<h4 id="特征耦合-标记耦合"><a href="#特征耦合-标记耦合" class="headerlink" title="特征耦合(标记耦合)"></a>特征耦合(标记耦合)</h4><p>两个模块通过<code>传递数据结构</code>加以联系，或都与一个数据结构有关系，则称这两个模块间存在<code>特征耦合</code>。</p>
<p>危害：<br>当把<strong>整个数据结构</strong>作为参数传递时，被调用的模块虽然<strong>只需要使用其中的一部分数据元素</strong>，但实际可以使用的数据多亍它真正需要的数据，这将导致对数据访问失去控制。<br>举例</p>
<ul>
<li>函数1需要学生成绩绩点，函数2可实现该功能，但函数1调用函数2时将全部学生信息这一数据结构传递了过去，尽管函数2只需要成绩信息。</li>
</ul>
<h3 id="中耦合"><a href="#中耦合" class="headerlink" title="中耦合"></a>中耦合</h3><h4 id="控制耦合"><a href="#控制耦合" class="headerlink" title="控制耦合"></a>控制耦合</h4><p>模块间传递的是<code>控制信息</code>（如开关、标志、名字等），控制被调用模块的内部逻辑。 比如一个模块实现了两个功能通过传入控制参数选择使用的是哪个功能。</p>
<p>控制耦合增加了理解和编程的复杂性，调用模块必项知道被调模块的内部逻辑，增加了相互依赖。</p>
<p>解决方法:</p>
<ol>
<li>将被调用模块内的判定上移到调用模块中迚行</li>
<li>被调用模块分解成若干单一功能模块</li>
</ol>
<pre class="language-java" data-language="java"><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ControlCoupling</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//实现了计算体积和面积两个功能，通过传入method来决定功能</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span>  <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">,</span><span class="token keyword">int</span> z<span class="token punctuation">,</span><span class="token keyword">int</span> method<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> x<span class="token operator">*</span>y<span class="token operator">*</span>z<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>y<span class="token operator">+</span>x<span class="token operator">*</span>z<span class="token operator">+</span>y<span class="token operator">*</span>z<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//..........</span>
        <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//..........</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span></code></pre>

<h3 id="较强耦合"><a href="#较强耦合" class="headerlink" title="较强耦合"></a>较强耦合</h3><h4 id="公共环境耦合"><a href="#公共环境耦合" class="headerlink" title="公共环境耦合"></a>公共环境耦合</h4><p>一组模块引用同一个公用数据区（全局数据结构，共享通讯区，内存公共覆盖区等）</p>
<p>两种情况：</p>
<ol>
<li>一模块送数据，另一模块取，比较松散。</li>
<li>两模块既往公共环境送又从里面取，较为紧。</li>
</ol>
<p>举例：</p>
<ul>
<li>全局变量</li>
</ul>
<p>缺点：</p>
<ol>
<li>软件可理解性降低</li>
<li>诊断错诨困难</li>
<li>软件可维护性差</li>
<li>软件可靠性差</li>
</ol>
<h3 id="强耦合"><a href="#强耦合" class="headerlink" title="强耦合"></a>强耦合</h3><h4 id="内容耦合"><a href="#内容耦合" class="headerlink" title="内容耦合"></a>内容耦合</h4><ol>
<li>一个模块访问另一个模块的内部数据</li>
<li>不通过正常入口进入程序内部（goto语句）</li>
<li>部分代码重叠（只出现在汇编中）</li>
<li>一个模块有多个入口（意味着一个模块有多种功能）</li>
</ol>
<p>举例：goto语句</p>
<h2 id="内聚性"><a href="#内聚性" class="headerlink" title="内聚性"></a>内聚性</h2><blockquote>
<p>又称块内联系，指一个模块内部各个元素彼此结合的紧密程度的度量，若一个模块内各元素联系越紧密则他的内聚行就越高。</p>
</blockquote>
<h3 id="低内聚"><a href="#低内聚" class="headerlink" title="低内聚"></a>低内聚</h3><h4 id="时间内聚"><a href="#时间内聚" class="headerlink" title="时间内聚"></a>时间内聚</h4><p>模块完成的功能必项在同一时间内执行，这些功能因时间因素关联在一起。</p>
<p>举例：<br>初始化函数</p>
<h4 id="逻辑内聚"><a href="#逻辑内聚" class="headerlink" title="逻辑内聚"></a>逻辑内聚</h4><p>把几种相关功能（逻辑上相似的功能）组合在一模块内，每次调用由传给模块的参数确定执行哪种功能。（类似控制耦合）。</p>
<ul>
<li>比如一个函数可以通过控制参数决定计算体积或者面积</li>
</ul>
<h4 id="偶然内聚"><a href="#偶然内聚" class="headerlink" title="偶然内聚"></a>偶然内聚</h4><p>一个模块内的组成成分在功能上是互不相关的。</p>
<ul>
<li>在写代码时，写了两个模块后，发现其中的代码有重叠，把他们单独拿出来。</li>
</ul>
<h3 id="中内聚"><a href="#中内聚" class="headerlink" title="中内聚"></a>中内聚</h3><h4 id="通信内聚"><a href="#通信内聚" class="headerlink" title="通信内聚"></a>通信内聚</h4><p>模块内各部分使用相同的输入数据，或产生相同的输出结果</p>
<ul>
<li>比如计算员工工资，仅在员工信息数据结构中操作即可</li>
</ul>
<h4 id="过程内聚"><a href="#过程内聚" class="headerlink" title="过程内聚"></a>过程内聚</h4><p>模块内各处理元素相关，且必项以特定次序执行。</p>
<ul>
<li>比如先填写账号，再获取验证码，最后识别验证码</li>
</ul>
<h3 id="高内聚"><a href="#高内聚" class="headerlink" title="高内聚"></a>高内聚</h3><h4 id="功能内聚"><a href="#功能内聚" class="headerlink" title="功能内聚"></a>功能内聚</h4><p>模块仅包括为完成某个功能所必项的所有成分。模块所有成分共同完成一个功能，缺一不可内聚性最强。</p>
<p>比如登录时在一个模块内完成对用户信息的校验</p>
<h4 id="顺序内聚"><a href="#顺序内聚" class="headerlink" title="顺序内聚"></a>顺序内聚</h4><p>如果一个模块内的处理元素和同一个功能密切相关，而且这些处理必项顸序执行（通常<code>一个处理元素的输出数据作为下一个处理元素的输入数据</code>），则称为顺序内聚。</p>
<ul>
<li>先通过用户id获取用户学号，在通过学号查找学生信息</li>
</ul>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程总结_1 概述</title>
    <url>/posts/b6a7a87b/</url>
    <content><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><h4 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h4><blockquote>
<p>程序+数据+文档</p>
</blockquote>
<h3 id="软件危机"><a href="#软件危机" class="headerlink" title="软件危机"></a>软件危机</h3><blockquote>
<p>软件危机是指落后的软件生产方式无法满足迅速增长的计算机软件需求，从而导致软件开发和维护过程中出现一系列严重问题的现象</p>
</blockquote>
<h4 id="软件危机的表现"><a href="#软件危机的表现" class="headerlink" title="软件危机的表现"></a>软件危机的表现</h4><ol>
<li>对软件的开发成本和进度的估计不准确</li>
<li>用户对已完成的系统不满意</li>
<li>软件质量不可靠</li>
<li>软件可维护性差</li>
<li>缺乏文档资料</li>
<li>软件成本上升</li>
<li>生产速率跟不上计算机应用普及的趋势</li>
</ol>
<h4 id="软件危机的原因"><a href="#软件危机的原因" class="headerlink" title="软件危机的原因"></a>软件危机的原因</h4><h5 id="软件自身原因"><a href="#软件自身原因" class="headerlink" title="软件自身原因"></a>软件自身原因</h5><p>软件自身特点使得开发和维护困难，主要表现在两个方面：</p>
<ol>
<li>复杂性</li>
<li>不可见性</li>
</ol>
<h5 id="软件开发和维护方法不正确"><a href="#软件开发和维护方法不正确" class="headerlink" title="软件开发和维护方法不正确"></a>软件开发和维护方法不正确</h5><ol>
<li>没有科学的工程化思想来组织和指导开发</li>
<li>没有完善的质量保证体系</li>
<li>软件文档没有得到重视</li>
<li>从业人员缺乏经验</li>
</ol>
<h3 id="软件工程"><a href="#软件工程" class="headerlink" title="软件工程"></a>软件工程</h3><h4 id="软件工程的定义"><a href="#软件工程的定义" class="headerlink" title="软件工程的定义"></a>软件工程的定义</h4><blockquote>
<p>软件工程是指导计算机软件开发和维护的一门学科，<br>采用工程的概念原理技术和方法来开发与维护软件，<br>把经过时间考验而证明正确的管理技术和当前能够的到的最好的技术方法结合起来，<br>以经济地开发出高质量的软件并有效地维护它。</p>
</blockquote>
<h4 id="软件工程的本质特征"><a href="#软件工程的本质特征" class="headerlink" title="软件工程的本质特征"></a>软件工程的本质特征</h4><ol>
<li>关注于大型程序的构造</li>
<li>中心课题是控制复杂性</li>
<li>软件经常变化</li>
<li>开发效率非常重要</li>
<li>和谐开发是关键</li>
<li>必须有效地支持用户</li>
<li>开发者与用户的文化背景不同</li>
</ol>
<h4 id="软件工程的基本原理"><a href="#软件工程的基本原理" class="headerlink" title="软件工程的基本原理"></a>软件工程的基本原理</h4><ol>
<li>用分阶段的生命周期计划严格管理</li>
<li>坚持阶段评审</li>
<li>实行严格的产品控制</li>
<li>采用现代程序设计技术</li>
<li>结果应能清楚地进行审查</li>
<li>开发小组应少而精</li>
<li>承认不断改进软件工程实践的必要性</li>
</ol>
<h4 id="软件开发方法学"><a href="#软件开发方法学" class="headerlink" title="软件开发方法学"></a>软件开发方法学</h4><blockquote>
<p>软件生命周期中使用的一整套技术方法的集合称为方法学，也称为泛型</p>
</blockquote>
<h5 id="方法学要素"><a href="#方法学要素" class="headerlink" title="方法学要素"></a>方法学要素</h5><ol>
<li>方法：软件开发如何做？</li>
<li>工具：为软件工程方法提供的软件支撑工具</li>
<li>过程：用于开发、管理、维护软件的一系列活动，是将软件工程的标准、方法、工具综合起来以达到合理及时进行软件开发管理维护活动的序列</li>
</ol>
<h5 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h5><ul>
<li>传统方法学</li>
<li>面向对象方法学</li>
</ul>
<h3 id="软件生命周期"><a href="#软件生命周期" class="headerlink" title="软件生命周期"></a>软件生命周期</h3><h4 id="软件开发三个阶段"><a href="#软件开发三个阶段" class="headerlink" title="软件开发三个阶段"></a>软件开发三个阶段</h4><ol>
<li>定义阶段</li>
<li>开发阶段</li>
<li>维护阶段</li>
</ol>
<h4 id="软件生命周期每个阶段的基本任务"><a href="#软件生命周期每个阶段的基本任务" class="headerlink" title="软件生命周期每个阶段的基本任务"></a>软件生命周期每个阶段的基本任务</h4><ol>
<li>可行性研究</li>
<li>需求分析</li>
<li>软件设计</li>
<li>编码</li>
<li>软件测试</li>
<li>软件维护</li>
</ol>
<h3 id="软件开发模型（软件过程）"><a href="#软件开发模型（软件过程）" class="headerlink" title="软件开发模型（软件过程）"></a>软件开发模型（软件过程）</h3><blockquote>
<p>软件过程是为了获得高质量软件所需要完成的一系列任务的框架。规定了完成各项任务的工作步骤</p>
</blockquote>
<p>用UML 建模语言来描述软件工程模型</p>
<h4 id="瀑布模型-☆"><a href="#瀑布模型-☆" class="headerlink" title="瀑布模型 ☆"></a>瀑布模型 ☆</h4><blockquote>
<p>各阶段间的组织方式就如同瀑布流水一样，逐级下落，完成前一阶段任务后才可开始下一阶段工作<br><img src="https://img.qylh.xyz/blog/1653148393253.png" loading="lazy"></p>
</blockquote>
<h5 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h5><ol>
<li>阶段间具有顺序性和依赖性<ul>
<li>必须等前一阶段完成后，才能开始下一阶段工作</li>
<li>前一阶段的输出文档就是后一个阶段的输入文档</li>
</ul>
</li>
<li>推迟实现的观点：规模大的软件，编码开始越早，最终完成所需时间越长，瀑布模型尽可能推迟程序的物理实现</li>
<li>质量保证的观点<ul>
<li>基于里程碑的阶段过程，开发人员为每个阶段设立里程碑，并做好评审</li>
</ul>
</li>
</ol>
<h5 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h5><ul>
<li>过程模型简单</li>
<li>强迫开发人员采用规范的方法，严格要求文档并需要经过评审，能够保证软件质量</li>
</ul>
<p>缺点：</p>
<ul>
<li>无法适应变更</li>
</ul>
<h4 id="快速原型模型"><a href="#快速原型模型" class="headerlink" title="快速原型模型"></a>快速原型模型</h4><blockquote>
<p>快速建立起能反映用户需求的程序，让用户试用，以了解目标系统概貌，并按照客户要求快速修改原型系统，不断重复。</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653148416139.png" loading="lazy"></p>
<p>优点：</p>
<ul>
<li>简单快速</li>
</ul>
<p>缺点：</p>
<ul>
<li>需要花费额外成本构造原型</li>
<li>不利于创新</li>
</ul>
<h4 id="增量模型-☆"><a href="#增量模型-☆" class="headerlink" title="增量模型  ☆"></a>增量模型  ☆</h4><blockquote>
<p>增量模型是把待开发的软件系统模块化，将每个模块作为一个增量组件，从而分批次地分析、设计、编码和测试这些增量组件。是一个递增的过程，分批次交付软件</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653148568070.png" loading="lazy"></p>
<p>优点：</p>
<ul>
<li>模块化可分批次交付，便于客户了解进展</li>
<li>模块化降低开发风险，一个周期内的错误不会影响整个系统</li>
<li>开发顺序灵活</li>
</ul>
<h4 id="螺旋模型"><a href="#螺旋模型" class="headerlink" title="螺旋模型"></a>螺旋模型</h4><blockquote>
<p>用于风险较大的大型软件项目开发过程，可以看成是增加了风险分析过程的快速原型模型</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653148728999.png" loading="lazy"></p>
<h4 id="喷泉模型"><a href="#喷泉模型" class="headerlink" title="喷泉模型"></a>喷泉模型</h4><blockquote>
<p>一种过程模型，支持面向对象，由于面向对象经常需要迭代，喷泉模型可随时回到底层</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653148893746.png" loading="lazy"></p>
<h4 id="敏捷模型"><a href="#敏捷模型" class="headerlink" title="敏捷模型"></a>敏捷模型</h4><blockquote>
<p>敏捷方法是一种轻量级的软件工程方法，相对于传统的软件工程方法，它更强调软件开发过程中各种变化的必然性，通过团队成员间充分的交流和沟通以及合理的机制来有效地响应变化。</p>
</blockquote>
<p>敏捷软件开发宣言：</p>
<ol>
<li>个体和交互胜过过程和工具</li>
<li>可以工作的软件胜过面面俱到的文档</li>
<li>客户合作胜过合同谈判</li>
<li>响应变化胜过遵循计划</li>
</ol>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><p><img src="https://img.qylh.xyz/blog/uTools_1653149879021.png" loading="lazy"></p>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>设计模式的目的</title>
    <url>/posts/56fec824/</url>
    <content><![CDATA[<h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>为了让软件具有更好的<code>重用性</code>、<code>可读性</code>、<code>可扩展性</code>、<code>可靠性</code>（更改功能后，对原有功能几乎没印象）、<code>低耦合，高内聚</code>（模块间关联性低，内部关联性强）</p>
<h2 id="需要遵守的七大原则"><a href="#需要遵守的七大原则" class="headerlink" title="需要遵守的七大原则"></a>需要遵守的七大原则</h2><h3 id="单一职责原则"><a href="#单一职责原则" class="headerlink" title="单一职责原则"></a>单一职责原则</h3><p>一个类只负责一项职责，或者在方法上遵守上述原则</p>
<h3 id="接口隔离原则"><a href="#接口隔离原则" class="headerlink" title="接口隔离原则"></a>接口隔离原则</h3><p>客户端不应该以来它不需要的接口，即一个类对另一个类的以来应该建立在最小的接口上</p>
<h3 id="依赖倒转原则"><a href="#依赖倒转原则" class="headerlink" title="依赖倒转原则"></a>依赖倒转原则</h3><ol>
<li>高层模块不应该依赖底层模块，二者都应该依赖其抽象</li>
<li>抽象不应该以来细节，细节应该以来抽象</li>
<li>中心思想是面向接口编程</li>
<li>相对于细节的多变性，抽象的东西要稳定得多</li>
<li>java中抽象值得是接口或者抽象类，细节就是值具体的实现类</li>
<li>是有接口或者抽象类的目的是<code>制定好规范</code>,在于设计</li>
</ol>
<h3 id="里氏替换原则"><a href="#里氏替换原则" class="headerlink" title="里氏替换原则"></a>里氏替换原则</h3><ol>
<li>集成包含的一个含义：父类中凡是已经实现好的方法，实际上是在设定规范和契约（虽然子类不一定遵守）</li>
<li>一个类被其他类所继承，如果该类的方法需要改变，必须考虑到其他所有子类是否会受到影响。</li>
</ol>
<p>要求：<br>尽量不要重写父类的方法</p>
<h3 id="开闭原则"><a href="#开闭原则" class="headerlink" title="开闭原则"></a>开闭原则</h3><ol>
<li>模块和函数应该对扩展开放（对提供方而言），对修改关闭（对使用放而言）。</li>
<li>软件需要变化时，尽量通过扩展软件实体来实现，而不是通过修改已有的代码来实现的。</li>
<li>其他原则的目的就是遵循开闭原则</li>
</ol>
<h3 id="迪米特法则"><a href="#迪米特法则" class="headerlink" title="迪米特法则"></a>迪米特法则</h3><ol>
<li>一个对象应该对其他对象保持最少的了解</li>
<li>类之间的关系越密切，耦合度越大</li>
<li>对于被依赖的类不管多么复杂，都应该尽量将逻辑封装在类的内部。对外除了提供public方法外不泄露任何信息。</li>
<li>陌生的类最好不要以局部变量的形式出现在方法中</li>
</ol>
<h3 id="合成复用原则"><a href="#合成复用原则" class="headerlink" title="合成复用原则"></a>合成复用原则</h3><p>尽量使用依赖&#x2F;合成&#x2F;聚合的方式，而不是使用继承</p>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>设计模式</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程总结_2 可行性研究</title>
    <url>/posts/d3012a97/</url>
    <content><![CDATA[<h2 id="可行性研究"><a href="#可行性研究" class="headerlink" title="可行性研究"></a>可行性研究</h2><details>
  <summary>可行性研究的目的</summary>
用最小的代价在尽可能短的时间内确定问题是否能够并且值得解决
</details>

<details>
  <summary>可行性研究的根本任务</summary>
对以后的行动方针提出建议
</details>

<h3 id="可行性研究的三个组成："><a href="#可行性研究的三个组成：" class="headerlink" title="可行性研究的三个组成："></a>可行性研究的三个组成：</h3><ol>
<li>技术可行性 现有技术能否实现</li>
<li>经济可行性 经济效益能否超过开发成本</li>
<li>操作可行性 系统的操作方式在用户组织内行的通吗<br>此外还应在法律、社会、管理等其他方面分析</li>
</ol>
<h3 id="可行性研究的过程"><a href="#可行性研究的过程" class="headerlink" title="可行性研究的过程"></a>可行性研究的过程</h3><ol>
<li>复查系统规模和目标</li>
<li>研究目前正在使用的系统</li>
<li>导出新系统的高层逻辑模型</li>
<li>进一步定义问题</li>
<li>导出并评价共选择的方案</li>
<li>推荐行动方针</li>
<li>草拟开发计划</li>
<li>书写文档提交审查</li>
</ol>
<h3 id="系统流程图"><a href="#系统流程图" class="headerlink" title="系统流程图"></a>系统流程图</h3><blockquote>
<p>是概括描述<em>物理系统</em>的传统工具,表达数据在系统各部件之间流动的情况</p>
</blockquote>
<blockquote>
<p>用于分析现有系统！！！</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653186497818.png" loading="lazy"></p>
<p>复杂系统时应该分层画</p>
<h3 id="数据流图"><a href="#数据流图" class="headerlink" title="数据流图"></a>数据流图</h3><blockquote>
<p>数据流图描绘系统的逻辑模型，无具体的物理元素，值描绘信息在系统中流动处理的情况</p>
</blockquote>
<p><img src="https://img.qylh.xyz/blog/1653186643064.png" loading="lazy"></p>
<p><img src="https://img.qylh.xyz/blog/1653186702057.png" loading="lazy"></p>
<h3 id="成本效益分析"><a href="#成本效益分析" class="headerlink" title="成本效益分析"></a>成本效益分析</h3><h4 id="成本估计"><a href="#成本估计" class="headerlink" title="成本估计"></a>成本估计</h4><h5 id="代码行技术"><a href="#代码行技术" class="headerlink" title="代码行技术"></a>代码行技术</h5><blockquote>
<p>2Xf2E6aEU7n685eHEbXGYHrmWn2y7a62UWBrtZzodVdD</p>
</blockquote>
<h5 id="任务分解技术"><a href="#任务分解技术" class="headerlink" title="任务分解技术"></a>任务分解技术</h5><blockquote>
<p>将软件开发工程分解成若干个相对独立的任务，分别估算，累加得到总成本</p>
</blockquote>
<h5 id="开发成本估计技术"><a href="#开发成本估计技术" class="headerlink" title="开发成本估计技术"></a>开发成本估计技术</h5><blockquote>
<p>需要软件和数据的支撑</p>
</blockquote>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><p><img src="https://img.qylh.xyz/blog/1653187770938.png" loading="lazy"></p>
]]></content>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程总结_4 总体设计</title>
    <url>/posts/f0cb5b2b/</url>
    <content><![CDATA[<h2 id="总体设计"><a href="#总体设计" class="headerlink" title="总体设计"></a>总体设计</h2><h3 id="软件设计的任务"><a href="#软件设计的任务" class="headerlink" title="软件设计的任务"></a>软件设计的任务</h3><blockquote>
<p>以软件需求规格说明书为依据，着手实现软件的需求，并将设计的结果反应在“设计规格说明书”的文档中</p>
</blockquote>
<h4 id="总体设计（概要设计）"><a href="#总体设计（概要设计）" class="headerlink" title="总体设计（概要设计）"></a>总体设计（概要设计）</h4><blockquote>
<p>根据软件需求，设计软件系统结构和数据结构确定程序的组成模块之间的关系，从抽象的层次上分析对比多种可能的系统实现方案和软件结构，从中选取最佳方案和最合理的软件结构，从而用较低成本开发出高质量的软件系统</p>
</blockquote>
<h4 id="详细设计（过程设计）"><a href="#详细设计（过程设计）" class="headerlink" title="详细设计（过程设计）"></a>详细设计（过程设计）</h4><blockquote>
<p>确定模块内部的算法和数据结构，选定某种过程的表达形式来描述算法，生成详细文档</p>
</blockquote>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><ol>
<li>提供选择方案<ol>
<li>从需求阶段的数据流图出发</li>
</ol>
</li>
<li>选取合理方案<ol>
<li>系统流程图</li>
<li>组成系统的物理元素清单</li>
<li>成本效益分析</li>
<li>实现系统的进度计划</li>
</ol>
</li>
<li>推荐最佳方案</li>
<li>功能分解</li>
<li>设计软件结构</li>
<li>设计数据库</li>
<li>制定测试计划</li>
<li>书写文档<ol>
<li>系统说明</li>
<li>用户手册</li>
<li>测试计划</li>
<li>详细的实现计划</li>
<li>数据库设计结果</li>
</ol>
</li>
<li>审查和复审</li>
</ol>
<h3 id="设计原理"><a href="#设计原理" class="headerlink" title="设计原理"></a>设计原理</h3><h4 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h4><h5 id="什么是模块？"><a href="#什么是模块？" class="headerlink" title="什么是模块？"></a>什么是模块？</h5><blockquote>
<p>模块是数据说明和可执行语句等程序对象的集合，每个模块单独命名并且可以通过名字对模块进行访问</p>
</blockquote>
<h5 id="模块化思想"><a href="#模块化思想" class="headerlink" title="模块化思想"></a>模块化思想</h5><blockquote>
<p>采用自顶向下的方式，逐层把软件系统划分成若干个可单独命名和可编址的模块，每个模块完成一个特定的子功能，所有模块按照某种方法组成一个整体，完成整个系统所要求的的功能。</p>
</blockquote>
<h5 id="模块化的优点"><a href="#模块化的优点" class="headerlink" title="模块化的优点"></a>模块化的优点</h5><ol>
<li>降低软件复杂性</li>
<li>减少开发工作量</li>
<li>降低成本</li>
<li>提高软件生产率</li>
</ol>
<h5 id="模块化与软件成本的关系"><a href="#模块化与软件成本的关系" class="headerlink" title="模块化与软件成本的关系"></a>模块化与软件成本的关系</h5><p><img src="https://img.qylh.xyz/blog/1653620191748.png" loading="lazy"></p>
<p>并非模块越多越好！</p>
<h4 id="抽象"><a href="#抽象" class="headerlink" title="抽象"></a>抽象</h4><h5 id="什么是抽象？"><a href="#什么是抽象？" class="headerlink" title="什么是抽象？"></a>什么是抽象？</h5><p>认识复杂事物和现象时，抽出事物本质的共同特性而暂不考虑他们的细节</p>
<h4 id="逐步求精"><a href="#逐步求精" class="headerlink" title="逐步求精"></a>逐步求精</h4><blockquote>
<p>为了能集中精力解决主要问题而尽量推迟对问题细节的考虑。可以看做把一个时期内必须解决的问题按照优先级排序的技术，是一种自顶向下的设计策略</p>
</blockquote>
<h5 id="miller原则"><a href="#miller原则" class="headerlink" title="miller原则"></a>miller原则</h5><blockquote>
<p>一个人在任何时候都只能把注意力集中在5-9个知识块上</p>
</blockquote>
<h4 id="信息隐藏和局部化"><a href="#信息隐藏和局部化" class="headerlink" title="信息隐藏和局部化"></a>信息隐藏和局部化</h4><blockquote>
<p>在设计和确定模块时，使得一个模块内包含的信息（过程或数据），不允许其它不需要这些信息的模块访问，独立的模块间仅仅交换为完成系统功能而必项交换的信息。</p>
</blockquote>
<blockquote>
<p>局部化：将一些关系密切的软件元素物理地彼此靠近：如局部变量</p>
</blockquote>
<h4 id="模块独立（低耦合，高内聚）"><a href="#模块独立（低耦合，高内聚）" class="headerlink" title="模块独立（低耦合，高内聚）"></a>模块独立（低耦合，高内聚）</h4><blockquote>
<p>模块只完成系统要求的相对独立的功能，符合信息隐蔽原则，模块间关联和依赖程度尽量小</p>
</blockquote>
<h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><p>容易开发测试和维护</p>
<h5 id="两个原则"><a href="#两个原则" class="headerlink" title="两个原则"></a>两个原则</h5><p>低耦合、高内聚</p>
<p>详见另一篇博客：<a href="https://qylh.xyz/2022/01/26/%E8%80%A6%E5%90%88%E4%B8%8E%E5%86%85%E8%81%9A/">耦合与内聚</a></p>
<h3 id="启发规则"><a href="#启发规则" class="headerlink" title="启发规则"></a>启发规则</h3><ol>
<li>改进软件结构提高模块独立性</li>
<li>模块规模应该适中</li>
<li>深度、宽度、扇出、扇入应适当</li>
<li>模块的作用域应在控制域之内</li>
<li>力争降低模块接口的复杂程度</li>
<li>设计单入口单出口的模块</li>
<li>模块功能应该可以预测</li>
</ol>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程总结_3 需求分析</title>
    <url>/posts/281be91d/</url>
    <content><![CDATA[<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><blockquote>
<p>软件需求指用户对所开发的软件在功能、性能、环境、可靠性等各方面的要求。</p>
</blockquote>
<h3 id="需求分析的任务"><a href="#需求分析的任务" class="headerlink" title="需求分析的任务"></a>需求分析的任务</h3><ol>
<li>确定对系统的综合要求</li>
<li>分析系统的数据要求</li>
<li>导出系统的逻辑模型</li>
<li>修正系统开发计划</li>
</ol>
<h3 id="确定对系统的综合要求"><a href="#确定对系统的综合要求" class="headerlink" title="确定对系统的综合要求"></a>确定对系统的综合要求</h3><ol>
<li>功能需求</li>
<li>性能需求</li>
<li>可靠性和可用性需求，定量</li>
<li>出错处理需求</li>
<li>接口需求</li>
<li>约束 如精度、工具、语言、设计、标准、硬件平台</li>
<li>逆向需求：系统不应该怎么样</li>
<li>未来可能的要求</li>
</ol>
<h3 id="分析系统的数据要求"><a href="#分析系统的数据要求" class="headerlink" title="分析系统的数据要求"></a>分析系统的数据要求</h3><h4 id="ER图"><a href="#ER图" class="headerlink" title="ER图"></a>ER图</h4><h5 id="三大范式"><a href="#三大范式" class="headerlink" title="三大范式"></a>三大范式</h5><ol>
<li>第一范式是指每个属性值都是原子性的，不可再分</li>
<li>非码属性必须完全依赖于全部的主码属性 消除部分函数依赖</li>
<li>一个非关键字属性不能仅仅是对另一个非关键字属性的进一步描述，即非主码属性不依赖于其他非主属性，消除传递以来</li>
</ol>
<p>范式低，冗余大，范式高，分解得细，冗余小，但处理过程复杂。</p>
<p>参考文章：<a href="https://www.html.cn/qa/other/18877.html">数据库设计的三大范式怎么通俗理解？</a></p>
<h3 id="导出系统的逻辑模型"><a href="#导出系统的逻辑模型" class="headerlink" title="导出系统的逻辑模型"></a>导出系统的逻辑模型</h3><p>工具：</p>
<ol>
<li>数据流图</li>
<li>实体联系图</li>
<li>状态转换图</li>
<li>数据字典</li>
<li>主要的处理算法</li>
</ol>
<h4 id="状态转换图（STD）"><a href="#状态转换图（STD）" class="headerlink" title="状态转换图（STD）"></a>状态转换图（STD）</h4><blockquote>
<p>状态转换图是一种常用的动态分析方法。是描述系统的状态如何响应外部信号，而进行转换的一种图形表示。</p>
</blockquote>
<h5 id="状态"><a href="#状态" class="headerlink" title="状态"></a>状态</h5><blockquote>
<p>指任何可以被观察到的系统行为模式，一个状态代表系统的一种行为模式。</p>
</blockquote>
<ol>
<li>初态，只有一个  实心圆表示</li>
<li>中间态  圆角矩阵</li>
<li>终态 可多个  同心圆（内圆为实心）</li>
</ol>
<h5 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h5><blockquote>
<p>某个特定时刻发生的事情，它是对引起系统做动作或（和）从一个状态转换到另一个状态的外界事情的抽象。</p>
</blockquote>
<h5 id="例图"><a href="#例图" class="headerlink" title="例图"></a>例图</h5><p><img src="https://img.qylh.xyz/blog/1653297645775.png" alt="图书状态图" loading="lazy"></p>
<p><img src="https://img.qylh.xyz/blog/1653297671070.png" alt="客房状态图" loading="lazy"></p>
<h5 id="IPO图"><a href="#IPO图" class="headerlink" title="IPO图"></a>IPO图</h5><p><img src="https://img.qylh.xyz/blog/1653297748274.png" loading="lazy"></p>
<h3 id="验证软件需求"><a href="#验证软件需求" class="headerlink" title="验证软件需求"></a>验证软件需求</h3><ol>
<li>一致性，需求间不能存在冲突<ol>
<li>自然语言书写的只能人工验证</li>
<li>形式化语言定义的可以借助工具完成</li>
</ol>
</li>
<li>完整性：需求是完整的，需要用户参与合作，可以借助快速原型方法完成</li>
<li>现实性：参考类似系统，分析现有条件实现的可能性，必要时可借助仿真模拟等技术</li>
<li>有效性：需要合作</li>
</ol>
<h3 id="与用户沟通方式"><a href="#与用户沟通方式" class="headerlink" title="与用户沟通方式"></a>与用户沟通方式</h3><ol>
<li>访谈</li>
<li>面向数据流自顶向下求精<ul>
<li>详细的数据流图</li>
<li>数据字典</li>
<li>ER图</li>
<li>IPO图</li>
</ul>
</li>
<li>简易的应用规格说明技术 （实现用户看得见的功能，省略目标系统“隐含”功能）</li>
<li>快速建立软件原型</li>
</ol>
<h3 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h3><p><img src="https://img.qylh.xyz/blog/1653298224061.png" loading="lazy"></p>
]]></content>
      <categories>
        <category>软件工程</category>
      </categories>
      <tags>
        <tag>软件工程</tag>
      </tags>
  </entry>
  <entry>
    <title>软件工程调研报告</title>
    <url>/posts/54f61860/</url>
    <content><![CDATA[<p>软件工程课小组作业——软件与编程语言调研报告计划实施方案</p>
<span id="more"></span>
<h2 id="软件与编程语言"><a href="#软件与编程语言" class="headerlink" title="软件与编程语言"></a>软件与编程语言</h2><blockquote>
<p>目前已经有超过700种的编程语言，50种比较流行的。TIOBE编程语言排行榜</p>
<p><a href="https://www.tiobe.com/tiobe-index/">https://www.tiobe.com/tiobe-index/</a>  编程社区指数</p>
</blockquote>
<h3 id="查找文献"><a href="#查找文献" class="headerlink" title="查找文献"></a>查找文献</h3><p>[1]丁建邦,张美娜,李政蓬.计算机应用软件开发中编程语言的选择[J].计算机产品与流通,2020(10):64.</p>
<p>[1]戈健.计算机应用软件开发过程中不同编程语言的影响[J].现代工业经济和信息化,2019,9(02):94-95.DOI:10.16525&#x2F;j.cnki.14-1362&#x2F;n.2019.02.39.</p>
<p>DEFINING AND MEASURING THE PRODUCTIVITY OF PROGRAMMING<br>LANGUAGES (定义和衡量编程语言的生产力)</p>
<p>On the Impact of Programming Languages on Code Quality:<br>A Reproduction Study （编程语言对代码质量的影响）</p>
<p>An Empirical Comparison of Seven Programming Languages(针对同一个需求分别用七种语言进行编码，比较了代码量，代码质量，内存占用，执行速度等)</p>
<p>Popularity, Interoperability, and Impact of Programming Languages<br>in 100,000 Open Source Projects（通过对github开源项目的分析解决以下三个问题 1. 使用的编程语言与项目成功之间是否存在相关性？2. 使用的编程语言与问题报告的数量之间有什么关联？3. 编程语言如何与开发团队的规模相关联）</p>
<br/>

<h3 id="做什么"><a href="#做什么" class="headerlink" title="做什么"></a>做什么</h3><ol>
<li>从几个指标分析编程语言如编写效率 ，代码质量，代码安全性，性能等特性。</li>
<li>不同软件类型和团队规模下如何选择编程语言。</li>
<li>目前就业环境下开发语言岗位需求情况</li>
<li>根据编程语言排行榜的历史变化，分析造成变动的原因</li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>二叉搜索树—BST</title>
    <url>/posts/290cda51/</url>
    <content><![CDATA[<p>二叉搜索树又称二叉排序树(Binary Search Tree)，简称BST。主要用于查找搜索。</p>
<span id="more"></span>

<p>如果理解起来有些抽象，可以尝试这个网站，可视化演示操作过程：<a href="https://visualgo.net/zh/bst">visualgo</a></p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>二叉搜索树或者为空树或者满足如下条件：</p>
<ol>
<li>若左子树非空，左子树全部节点小于根节点</li>
<li>若右子树非空，右子树全部节点大于根节点</li>
<li>左右子树均满足以上两点（递归定义的）</li>
</ol>
<p>二叉搜索树是没有重复元素的。</p>
<p>优势在于查找和插入，时间复杂度可以达到O(logn)。</p>
<p><img src="https://img.qylh.xyz/blog/1661671342883.png" loading="lazy"></p>
<p>如上图即为一颗BST树。</p>
<h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h2><p>如图为查找50的过程</p>
<p><img src="https://img.qylh.xyz/blog/1661672587888.png" loading="lazy"></p>
<blockquote>
<p>从根节点开始，若节点为NULL，否则比较根节点与搜索值的大小关系，如果相等则查找成功，如果小于根节点值则转到左子树上继续查找，同理若大于节点值则转到右节点上继续查找。</p>
</blockquote>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp">BSTNode <span class="token operator">*</span><span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">findNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> value<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> left<span class="token operator">-></span><span class="token function">findNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">></span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> right<span class="token operator">-></span><span class="token function">findNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><p>如图为插入8的过程：</p>
<p><img src="https://img.qylh.xyz/blog/1661672518947.png" loading="lazy"></p>
<blockquote>
<p>插入的关键是找到插入的位置, 可以在查找的基础上改装成插入，即若查找成功代表插入值已存在于BST中无需再次插入，查找失败（找到了NULL），则该位置即为需要插入的位置。</p>
</blockquote>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BSTNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            left<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
            left<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">></span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BSTNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            right<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
            right<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>首先定义两个概念：</p>
<blockquote>
<p>前驱结点：节点val值小于该节点val值并且值最大的节点<br>后继节点：节点val值大于该节点val值并且值最小的节点</p>
</blockquote>
<blockquote>
<p>相比较而言删除操作较为复杂，需要考虑多种情况：</p>
</blockquote>
<p>假设待删除节点为d</p>
<ol>
<li>若d为叶节点，则直接删除即可。</li>
<li>若节点只有左子树，则将左子树改为d父节点的子树。（右节点同理）</li>
<li>若d有两棵子树,则让d的后继（或者前驱）节点x取代d的位置，并将原位置的x删除掉（此时会转换成1或2的情况）</li>
</ol>
<p>由于前两者情况较为简单，这里演示第三种情况：</p>
<p>删除如图BST中值为7的节点：</p>
<p><img src="https://img.qylh.xyz/blog/1661673121716.png" loading="lazy"></p>
<p>首先查找到6：<br><img src="https://img.qylh.xyz/blog/1661673157065.png" loading="lazy"></p>
<p>然后发现6的左右子树均非空，这里选择右子树，查找到后继节点8<br><img src="https://img.qylh.xyz/blog/1661673183449.png" loading="lazy"><br>用8替代7的位置<br><img src="https://img.qylh.xyz/blog/1661673223963.png" loading="lazy"><br>由于8节点为叶节点，因此直接删除。</p>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp">
<span class="token keyword">void</span> <span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        BSTNode <span class="token operator">*</span>temp <span class="token operator">=</span> left<span class="token operator">-></span><span class="token function">findMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        value <span class="token operator">=</span> temp<span class="token operator">-></span>value<span class="token punctuation">;</span>
        temp<span class="token operator">-></span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> parent<span class="token operator">-></span>left<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>left <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>right <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                right<span class="token operator">-></span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> parent<span class="token operator">-></span>left<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>left <span class="token operator">=</span> left<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>right <span class="token operator">=</span> left<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            left<span class="token operator">-></span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">BSTNode</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> value<span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span>left<span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span>right<span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span>parent<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">BSTNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span><span class="token function">findNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span><span class="token function">findMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span><span class="token function">findMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

BSTNode <span class="token operator">*</span><span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">findMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    BSTNode <span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>left <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>left<span class="token punctuation">;</span>
    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

BSTNode <span class="token operator">*</span><span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">findMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    BSTNode <span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token operator">-></span>right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        tmp <span class="token operator">=</span> tmp<span class="token operator">-></span>right<span class="token punctuation">;</span>
    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        BSTNode <span class="token operator">*</span>temp <span class="token operator">=</span> left<span class="token operator">-></span><span class="token function">findMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        value <span class="token operator">=</span> temp<span class="token operator">-></span>value<span class="token punctuation">;</span>
        temp<span class="token operator">-></span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> parent<span class="token operator">-></span>left<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>left <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>right <span class="token operator">=</span> right<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                right<span class="token operator">-></span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> parent<span class="token operator">-></span>left<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>left <span class="token operator">=</span> left<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                parent<span class="token operator">-></span>right <span class="token operator">=</span> left<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            left<span class="token operator">-></span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">BSTNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    value <span class="token operator">=</span> val<span class="token punctuation">;</span>
    left <span class="token operator">=</span> right <span class="token operator">=</span> parent <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
BSTNode <span class="token operator">*</span><span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">findNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> value<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> left<span class="token operator">-></span><span class="token function">findNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">></span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> right<span class="token operator">-></span><span class="token function">findNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token class-name">BSTNode</span><span class="token double-colon punctuation">::</span><span class="token function">insertNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&lt;</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            left <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BSTNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            left<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
            left<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">></span> value<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            right <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BSTNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            right<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
            right<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/**
 * @brief
 *
 */</span>
<span class="token keyword">class</span> <span class="token class-name">BST</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">BST</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">BST</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    BSTNode <span class="token operator">*</span>root<span class="token punctuation">;</span>
    <span class="token keyword">bool</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token class-name">BST</span><span class="token double-colon punctuation">::</span><span class="token function">BST</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    root <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token class-name">BST</span><span class="token double-colon punctuation">::</span><span class="token function">BST</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> v<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    root <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        root<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
BSTNode <span class="token operator">*</span><span class="token class-name">BST</span><span class="token double-colon punctuation">::</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">return</span> root<span class="token operator">-></span><span class="token function">findNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token class-name">BST</span><span class="token double-colon punctuation">::</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BSTNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        root<span class="token operator">-></span><span class="token function">insertNode</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">bool</span> <span class="token class-name">BST</span><span class="token double-colon punctuation">::</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    BSTNode <span class="token operator">*</span>findNode <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>findNode <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>findNode <span class="token operator">==</span> root<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token operator">-></span>left <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">&amp;&amp;</span> root<span class="token operator">-></span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            root <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
            <span class="token keyword">delete</span> findNode<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token operator">-></span>left <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            root <span class="token operator">=</span> root<span class="token operator">-></span>right<span class="token punctuation">;</span>
            root<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
            <span class="token keyword">delete</span> findNode<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token operator">-></span>right <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            root <span class="token operator">=</span> root<span class="token operator">-></span>left<span class="token punctuation">;</span>
            root<span class="token operator">-></span>parent <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
            <span class="token keyword">delete</span> findNode<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            root<span class="token operator">-></span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        root<span class="token operator">-></span><span class="token function">delNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>创建就是按顺序的插入过程</p>
<p>参考文档<a href="https://www.imooc.com/article/13463">二叉搜索树BST在C++类中的实现（增删改查）【Van0512】</a></p>
]]></content>
      <tags>
        <tag>数据结构</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机网络常见协议和服务</title>
    <url>/posts/56baf75e/</url>
    <content><![CDATA[<p>根据《计算机网络自顶向下方法》一书总结计算机网络中的常见协议和服务</p>
<span id="more"></span>
<h2 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h2><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p><img src="https://img.qylh.xyz/blog/1663045332251.png" loading="lazy"></p>
<blockquote>
<p>HTTP协议又称为超文本传输协议，是WEB应用的核心。</p>
</blockquote>
<h4 id="连接过程"><a href="#连接过程" class="headerlink" title="连接过程"></a>连接过程</h4><p>HTTP协议基于TCP实现，是一个 client-server协议，客户端一般指浏览器，服务端一般为远程WEB服务器，一个典型的 HTTP 会话如下：</p>
<ol>
<li>客户端建立一条 TCP 连接</li>
<li>客户端发送请求</li>
<li>服务器处理请求并送回应答，回应包括一个状态码和对应的数据。</li>
</ol>
<p>注意：<code>从 HTTP/1.1 开始，连接在完成第三阶段后不再关闭，客户端可以再次发起新的请求。这意味着第二步和第三步可以连续进行数次。</code></p>
<blockquote>
<p>HTTP&#x2F;1.0 默认为每一对 HTTP 请求&#x2F;响应都打开一个单独的 TCP 连接。当需要连续发起多个请求时，这种模式比多个请求共享同一个 TCP 链接更低效。为了减轻这些缺陷，HTTP&#x2F;1.1 引入了流水线（被证明难以实现）和持久连接的概念：底层的 TCP 连接可以通过Connection头部来被部分控制。</p>
</blockquote>
<h4 id="HTTP-是无状态，有会话的"><a href="#HTTP-是无状态，有会话的" class="headerlink" title="HTTP 是无状态，有会话的"></a>HTTP 是无状态，有会话的</h4><p>在同一个HTTP连接中，两个执行成功的请求之间是没有关系的。HTTP并不保存客户信息，所以不能记录状态。但是我们平时登录状态等是怎么实现的呢？</p>
<p>这是使用了HTTP的头部扩展——HTTP Cookies 解决的这个问题。把 Cookies 添加到头部中，创建一个会话让每次请求都能共享相同的上下文信息，达成相同的状态</p>
<p>总结来说就是<code>HTTP 本质是无状态的，使用 Cookies 可以创建有状态的会话</code>。</p>
<h4 id="HTTP请求类型"><a href="#HTTP请求类型" class="headerlink" title="HTTP请求类型"></a>HTTP请求类型</h4><p>HTTP共八种请求类型：</p>
<ol>
<li><p>OPTIONS：返回服务器针对特定资源所支持的HTTP请求方法。也可利用向Web服务器发送’*’的请求来测试服务器的功能性。 </p>
</li>
<li><p>HEAD：向服务器索要与GET请求相一致的响应，只不过响应体将不会被返回。这一方法可以在不必传输整个响应内容的情况下，就可以获取包含在响应消息头中的元信息。 </p>
</li>
<li><p>GET：向特定的资源发出请求。 </p>
</li>
<li><p>POST：向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的创建和&#x2F;或已有资源的修改。 </p>
</li>
<li><p>PUT：向指定资源位置上传其最新内容。 </p>
</li>
<li><p>DELETE：请求服务器删除Request-URI所标识的资源。 </p>
</li>
<li><p>TRACE：回显服务器收到的请求，主要用于测试或诊断。 </p>
</li>
<li><p>CONNECT：HTTP&#x2F;1.1协议中预留给能够将连接改为管道方式的代理服务器。</p>
</li>
</ol>
<p>其中最常用的是<code>GET</code>和<code>POST</code>请求:</p>
<p>GET方法请求一个指定资源的表示形式，使用GET的请求应该只被用于获取数据.</p>
<p>POST方法用于将实体提交到指定的资源，通常导致在服务器上的状态变化或副作用。</p>
<p>两者对比如下：</p>
<table>
<thead>
<tr>
<th>\</th>
<th>GET</th>
<th>POST</th>
</tr>
</thead>
<tbody><tr>
<td>后退按钮&#x2F;刷新</td>
<td>无害</td>
<td>数据会被重新提交</td>
</tr>
<tr>
<td>缓存</td>
<td>能被缓存</td>
<td>不能缓存</td>
</tr>
<tr>
<td>编码类型</td>
<td>application&#x2F;x-www-form-urlencoded</td>
<td>application&#x2F;x-www-form-urlencoded 或 multipart&#x2F;form-data。为二进制数据使用多重编码。</td>
</tr>
<tr>
<td>历史</td>
<td>参数保留在浏览器历史中。</td>
<td>参数不会保存在浏览器历史中。</td>
</tr>
<tr>
<td>对数据长度的限制</td>
<td>当发送数据时，GET 方法向 URL 添加数据；URL 的长度是受限制的（URL 的最大长度是 2048 个字符）。</td>
<td>无限制</td>
</tr>
<tr>
<td>数据类型</td>
<td>只允许 ASCII 字符</td>
<td>没有限制</td>
</tr>
<tr>
<td>安全性</td>
<td>GET 的安全性较差，因为所发送的数据是 URL 的一部分</td>
<td>POST 比 GET 更安全，因为参数不会被保存在浏览器历史或 web 服务器日志中。</td>
</tr>
<tr>
<td>可见性</td>
<td>数据在 URL 中对所有人都是可见的。</td>
<td>数据不会显示在 URL 中</td>
</tr>
</tbody></table>
<p>关于HTTP更多的信息可以参考，<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP">HTTP|MDN</a></p>
<h3 id="SMTP协议"><a href="#SMTP协议" class="headerlink" title="SMTP协议"></a>SMTP协议</h3><blockquote>
<p>SMTP（simple Mail Transfer Protocol）简单邮件协议，也是使用TCP进行可靠的数据传输。与HTTP不同的是，SMTP为一个<code>push protocol</code> 发送邮件服务器把文件推向接受服务器，而HTTP为一个<code>pull protocol</code></p>
</blockquote>
<h3 id="DNS服务"><a href="#DNS服务" class="headerlink" title="DNS服务"></a>DNS服务</h3><p>DNS（Domain Name System）提供域名到IP地址的转换。是一个由分层的 DNS 服务器(DNS server)实现的分布式数据库，也是一个使得主机能够查询分布式数据库的应用层协议。</p>
<p>DNS运行于53端口上，基于<code>UDP</code>协议实现。</p>
<p>这里其实不够严谨，应该说主要使用UDP、其实也是可以使用TCP的。查了一些资料，总结一下使用UDP的原因：</p>
<ol>
<li>DNS传输的数据包较小，UDP一次就能解决。当然DNS也有规定当数据包超出大小限制而被截断时会尝试使用TCP进行重试。</li>
<li>TCP的时间开销大，在设计之初在性能和稳定性上选择了性能。</li>
<li>设计时未考虑安全问题（认为没人去伪造DNS报文），所以现在已经有了使用TCP的DNS和DoH（DNS over HTTPS）来进行域名解析了。</li>
</ol>
<p>参考资料：<a href="https://draveness.me/whys-the-design-dns-udp-tcp/">为什么 DNS 使用 UDP 协议</a></p>
<p>DNS 不是一个直接和用户打交道的应用。DNS 是为因特网上的用户应用程序以及其他软件提供一种核心功能。主要为其他应用层协议提供服务。</p>
<p>比如浏览器请求一个域名资源的过程：</p>
<ol>
<li>同一台用户主机上运行着 DNS 应用的客户端</li>
<li>浏览器从上述 URL 中抽取出主机名 <a href="http://www.someschool.edu/">www.someschool.edu</a> ，并将这台主机名传给 DNS 应用的客户端</li>
<li>DNS 客户向 DNS 服务器发送一个包含主机名的请求。</li>
<li>DNS 客户最终会收到一份回答报文，其中包含该目标主机的 IP 地址</li>
<li>一旦浏览器收到目标主机的 IP 地址后，它就能够向位于该 IP 地址 80 端口的 HTTP 服务器进程发起一个 TCP 连接。</li>
</ol>
<p>由于单一服务器容易出现故障且存储数据过大、远距离访问困难等问题。现代DNS被设计成了<code>分布式、层次化</code>的结构。</p>
<p>大致来说有三种 DNS 服务器：根DNS服务器、顶级域(Top-Level Domain, TLD) DNS服务器 和权威DNS服务器 。这些服务器的层次模型如下图所示：<br><img src="https://img.qylh.xyz/blog/1663048201206.png" loading="lazy"></p>
<p>这种结构下的查询过程如下:</p>
<ol>
<li>用户在浏览器中输入网址 <a href="http://www.example.com/">www.example.com</a> 并点击回车后，查询会进入网络，并且由 DNS 解析器进行接收。</li>
<li>DNS 解析器会向根域名发起查询请求，要求返回顶级域名的地址。</li>
<li>根 DNS 服务器会注意到请求地址的前缀并向 DNS 解析器返回com的顶级域名服务器(TLD) 的 IP 地址列表。</li>
<li>DNS 解析器会向 TLD 服务器发送查询报文</li>
<li>TLD 服务器接收请求后，会根据域名的地址把权威 DNS 服务器的 IP 地址返回给 DNS 解析器。</li>
<li>DNS 解析器将查询直接发送到权威 DNS 服务器</li>
<li>权威 DNS 服务器将 IP 地址返回给 DNS 解析器</li>
<li>DNS 解析器将会使用 IP 地址响应 Web 浏览器</li>
</ol>
<p><img src="https://img.qylh.xyz/blog/1663048352156.png" loading="lazy"></p>
<h4 id="DNS的两种查询方式"><a href="#DNS的两种查询方式" class="headerlink" title="DNS的两种查询方式"></a>DNS的两种查询方式</h4><ol>
<li>递归查询</li>
<li>迭代查询</li>
</ol>
<p><img src="https://img.qylh.xyz/blog/1663049469917.png" loading="lazy"></p>
<p>递归查询：如果主机所询问的本地域名服务器不知道被查询的域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其它根域名服务器继续发出查询请求报文(即替主机继续查询)，而不是让主机自己进行下一步查询。</p>
<p>迭代查询: 如果主机所询问的本地域名服务器不知道被查询的域名的IP地址，他会告诉你另一个可能知道改域名的服务器的地址。</p>
<h4 id="DNS缓存"><a href="#DNS缓存" class="headerlink" title="DNS缓存"></a>DNS缓存</h4><p>为了提高效率，DNS服务器再接收到一个查询结果时会将其存储在本地并设置一个过期时间，期限内再次被询问这个domain时可以直接返回结果。</p>
<h2 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h2><blockquote>
<p>运输层主要是提供TCP和UDP两个协议，为应用层的应用和服务提供传输支撑。</p>
</blockquote>
<h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h3><ul>
<li>TCP 提供一种面向连接的、可靠的字节流服务</li>
<li>在一个 TCP 连接中，仅有两方进行彼此通信。广播和多播不能用于 TCP</li>
<li>TCP 使用校验和，确认和重传机制来保证可靠传输</li>
<li>TCP 给数据分节进行排序，并使用累积确认保证数据的顺序不变和非重复</li>
<li>TCP 使用滑动窗口机制来实现流量控制，通过动态改变窗口的大小进行拥塞控制</li>
</ul>
<h4 id="TCP三次握手"><a href="#TCP三次握手" class="headerlink" title="TCP三次握手"></a>TCP三次握手</h4><p><img src="https://img.qylh.xyz/blog/114bd9b53c554319ae0db15b57b472b8.gif" loading="lazy"></p>
<blockquote>
<p>图片来源:<a href="https://blog.csdn.net/qzcsu/article/details/72861891">https://blog.csdn.net/qzcsu/article/details/72861891</a></p>
</blockquote>
<ol>
<li>客户端发送连接请求，SYN标志位设置为1，seq设置为一个随机（规避攻击）的client_isn</li>
<li>客户端请求到达服务器，服务器提取出seq，然后创建确认报文段并将SYN比特置为1，seq设置为随机的server_isn,ack设置为收到的client_isn+1</li>
<li>客户端收到确认报文段后，syn&#x3D;0，ack&#x3D;server_isn+1，seq&#x3D;cilent_isn+1。此时可以携带应用层数据。</li>
</ol>
<table>
<thead>
<tr>
<th>阶段</th>
<th>syn</th>
<th>seq</th>
<th>ack</th>
<th>应用层数据</th>
</tr>
</thead>
<tbody><tr>
<td>阶段一</td>
<td>1</td>
<td>x</td>
<td>null</td>
<td>不带数据</td>
</tr>
<tr>
<td>阶段一</td>
<td>1</td>
<td>y</td>
<td>x+1</td>
<td>不带数据</td>
</tr>
<tr>
<td>阶段一</td>
<td>0</td>
<td>x+1</td>
<td>y+1</td>
<td>带数据</td>
</tr>
</tbody></table>
<h4 id="TCP四次挥手"><a href="#TCP四次挥手" class="headerlink" title="TCP四次挥手"></a>TCP四次挥手</h4><p><img src="https://img.qylh.xyz/blog/0c17d72769aa4bd2b95bbaee1749b39d.gif" loading="lazy"></p>
<ol>
<li>客户端进程发出连接释放报文，并且停止发送数据。FIN设置为1，其序列号为seq&#x3D;u。</li>
<li>服务器收到连接释放报文，发出确认报文，ACK&#x3D;1，ack&#x3D;u+1，并且带上自己的序列号seq&#x3D;v，此时客户端已不再发数据，但服务端仍可向客户端发数据。<code>客户端收到服务器的确认请求后，等待服务器发送连接释放报文，此时还将继续接收服务端传来的数据。</code></li>
<li>服务器数据发送完毕后，就向客户端发送连接释放报文，FIN&#x3D;1，ack&#x3D;u+1。</li>
<li>客户端收到服务器的连接释放报文后，发出确认，ACK&#x3D;1，ack&#x3D;w+1(w为服务器发送的最后一个数据的编号)，而自己的序列号是seq&#x3D;u+1。等待2*MSL（最长报文段寿命）的时间后客户端正式关闭连接（因为这个确认信号可能会丢失，所以等一等看看是不受丢失了）。</li>
<li>服务器只要收到了客户端发出的确认立即关闭，所以服务端比客户端先关闭连接。</li>
</ol>
<h4 id="流量控制和拥塞控制"><a href="#流量控制和拥塞控制" class="headerlink" title="流量控制和拥塞控制"></a>流量控制和拥塞控制</h4><p>参考：<a href="https://zhuanlan.zhihu.com/p/37379780">TCP流量控制、拥塞控制</a><br>区别：</p>
<blockquote>
<p>流量控制：流量控制是作用于接收者的，它是控制发送者的发送速度从而使接收者来得及接收，防止分组丢失的。</p>
<p>拥塞控制：拥塞控制是作用于网络的，它是防止过多的数据注入到网络中，避免出现网络负载过大的情况；</p>
</blockquote>
<h5 id="滑动窗口协议"><a href="#滑动窗口协议" class="headerlink" title="滑动窗口协议"></a>滑动窗口协议</h5><blockquote>
<p>如果发送方把数据发送得过快，接收方可能会来不及接收，这就会造成数据的丢失。所谓流量控制就是让发送方的发送速率不要太快，对发送方发送速率的控制，要让接收方来得及接收。</p>
</blockquote>
<ul>
<li>接收方收到数据包之后，可以在确定报文的同时告知自己的缓冲区空闲空间（接收窗口大小），发送方收到确认报文之后，会根据接收窗口的大小调整自己的发送窗口大小。</li>
<li>当接收窗口为0时，会停止发送数据，但是什么时候恢复呢？ 解决方法是每隔一段时间就去发送一个测试报文，询问接收方的缓冲区是否空出来了。</li>
</ul>
<h5 id="拥塞控制算法"><a href="#拥塞控制算法" class="headerlink" title="拥塞控制算法"></a>拥塞控制算法</h5><blockquote>
<p>发送方维持一个叫做拥塞窗口cwnd（congestion window）的状态变量。拥塞窗口的大小取决于网络的拥塞程度，并且动态地在变化。发送方让自己的发送窗口等于拥塞窗口，另外考虑到接受方的接收能力，发送窗口可能小于拥塞窗口。</p>
<p>还需要维持一个阈值ssthresh，用以选择不同的策略。</p>
</blockquote>
<h6 id="慢启动"><a href="#慢启动" class="headerlink" title="慢启动"></a>慢启动</h6><blockquote>
<p> cwnd &lt; ssthresh时进行慢启动</p>
</blockquote>
<ol>
<li>初始状态时cwnd设置为1个MSS，然后每收到一个确认就增加一个MSS（1-&gt;2-&gt;4-&gt;8),呈指数速度增长。</li>
<li>如果出现一个超时事件，则将ssthresh设置为当前cwnd的一半，cwnd重新设置为1，重新开始慢启动。</li>
<li>但超过ssthresh时，再成倍数增加风险太大，停止慢启动。</li>
</ol>
<h6 id="拥塞避免"><a href="#拥塞避免" class="headerlink" title="拥塞避免"></a>拥塞避免</h6><ol>
<li>每次只增加一个MSS，即每个ACK增加MSS&#x2F;N</li>
<li>出现超时，ssthresh设置为当前cwnd的一半，cwnd重新设置为1，重新开始慢启动。</li>
</ol>
<h6 id="快重传"><a href="#快重传" class="headerlink" title="快重传"></a>快重传</h6><ul>
<li>快重传算法规定，发送方只要一连收到三个重复确认就应当立即重传对方尚未收到的报文段，而不必继续等待设置的重传计时器时间到期。然后进入快恢复阶段。</li>
</ul>
<h6 id="快恢复"><a href="#快恢复" class="headerlink" title="快恢复"></a>快恢复</h6><p>当发送方连续收到三个重复确认时，就把ssthresh减半（为了预防网络发生拥塞）。但是接下去并不执行慢开始算法（既然收到了三个重复的确认，那么可能情况还并不严重），所以发送方现在认为网络可能没有出现拥塞。所以此时不执行慢开始算法，而是将cwnd设置为ssthresh减半后的值，然后执行拥塞避免算法，使cwnd缓慢增大。</p>
<p><img src="https://img.qylh.xyz/blog/1663305865390.png" loading="lazy"></p>
<h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h3><ol>
<li>UDP 是无连接的，即发送数据之前不需要建立连接(发送数据结束时也没有连接可释放)，减少了开销和发送数据之前的时延</li>
<li>UDP 使用尽最大努力交付，即不保证可靠交付，主机不需要维持复杂的连接状态表</li>
<li>UDP 是面向报文的，发送方的 UDP 对应用程序交下来的报文，在添加首部后就向下交付 IP 层。UDP 对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界</li>
<li>UDP 没有拥塞控制，网络出现的拥塞不会使源主机的发送速率降低。这对某些实时应用是很重要的</li>
<li>UDP 支持一对一、一对多、多对一和多对多的交互通信</li>
<li>UDP 的首部开销小，只有8个字节，比 TCP 的20个字节的首部要短</li>
</ol>
<blockquote>
<p>使用UDP协议的应用有：域名系统（DNS)、简单网络管理协议（SNMP)、路由信息协议（RIP)等等。因为UDP不属于连接型协议，因而具有资源消耗小，处理速度快的优点，所以音频、视频和普通数据在传送时使用UDP比较多，因为它们即使偶尔丢失一两个数据包，也不会对接收结果产生太大影响。比如我们聊天用到的QQ就是使用UDP协议。</p>
</blockquote>
<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><table>
<thead>
<tr>
<th></th>
<th>UDP</th>
<th>TCP</th>
</tr>
</thead>
<tbody><tr>
<td>有无连接</td>
<td>无连接</td>
<td>有连接</td>
</tr>
<tr>
<td>是否可靠</td>
<td>尽最大努力交付</td>
<td>可靠传输</td>
</tr>
<tr>
<td>传输方式</td>
<td>面向报文</td>
<td>面向字节流</td>
</tr>
<tr>
<td>端点</td>
<td>一对一、一对多</td>
<td>点对点</td>
</tr>
<tr>
<td>首部大小</td>
<td>首部小，仅8字节</td>
<td>首部开销大</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>计算机网络</category>
      </categories>
      <tags>
        <tag>计算机网络</tag>
      </tags>
  </entry>
  <entry>
    <title>计组复习</title>
    <url>/posts/e868b80e/</url>
    <content><![CDATA[<h2 id="计算机系统概论"><a href="#计算机系统概论" class="headerlink" title="计算机系统概论"></a>计算机系统概论</h2><h3 id="冯诺依曼机"><a href="#冯诺依曼机" class="headerlink" title="冯诺依曼机"></a>冯诺依曼机</h3><ol>
<li>计算机由运算器、存储器、控制器、输入设备、输出设备五部分组成</li>
<li>存储程序思想：指令和数据都存储在存储器中，可以按照地址访问</li>
<li>指令和数据均以二进制表示。</li>
<li>以运算器为核心（<strong>注意现代计算机的核心为存储</strong>）</li>
</ol>
<h3 id="计算机系统层次结构"><a href="#计算机系统层次结构" class="headerlink" title="计算机系统层次结构"></a>计算机系统层次结构</h3><ol>
<li>第1级：微程序机器级。微指令由硬件直接执行。</li>
<li>第2级：传统机器级(机器语言)。用微程序解释指令系统。</li>
<li>第3级：操作系统级。用机器语言解释作业控制语句；</li>
<li>第4级：汇编语言机器级。用汇编程序翻译成汇编语言程序；</li>
<li>第5级：高级语言机器级。用编译程序翻译成汇编程序或直接翻译成机器语言。</li>
</ol>
<h2 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h2><h3 id="存储结构"><a href="#存储结构" class="headerlink" title="存储结构"></a>存储结构</h3><p><img src="https://img.qylh.xyz/blog/36a26ed04a544d549a409fae8afee3be.png" loading="lazy"></p>
<ul>
<li>缓存-主存 主要缓解速度差异</li>
<li>主存-辅存 主要解决存储容量问题</li>
</ul>
]]></content>
      <categories>
        <category>计算机组成原理</category>
      </categories>
      <tags>
        <tag>计算机组成原理</tag>
      </tags>
  </entry>
  <entry>
    <title>Go学习</title>
    <url>/posts/d080713b/</url>
    <content><![CDATA[<h2 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h2><ol>
<li>对外暴露的名字必须以大写字母开头，不需要对外暴露的则应该以小写字母开头。</li>
<li>包命名尽量与目录保持一致，且应全部为小写</li>
<li>文件命名应为小写，并用下划线分割</li>
</ol>
<h2 id="包引入"><a href="#包引入" class="headerlink" title="包引入"></a>包引入</h2><blockquote>
<p>待完善</p>
</blockquote>
<pre class="language-Go" data-language="Go"><code class="language-Go">import (
	&quot;fmt&quot;
	&quot;math&#x2F;rand&quot;
)</code></pre>
<p>使用import引入包，处于gomodule下时包可以放在非GOPATH路径下，而处于gopath模式下时项目包必须放到GOPATH路径下。<br>详细可参考<a href="https://www.cnblogs.com/ssgeek/p/14843476.html">浅谈GoPath和Go Modules包管理</a></p>
<h2 id="GO类型说明"><a href="#GO类型说明" class="headerlink" title="GO类型说明"></a>GO类型说明</h2><p>与其他类C语言不同，Go语言的类型声明符号放到名字的后面了：</p>
<p>如以下C语法：</p>
<pre class="language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

<span class="token punctuation">&#125;</span></code></pre>

<p>在Go语言中是这样的：</p>
<pre class="language-Go" data-language="Go"><code class="language-Go">var a int
func f1() int&#123;

&#125;</code></pre>

<p>官方解释称放到后面是为了在复杂情况时更易读：<a href="https://blog.go-zh.org/gos-declaration-syntax">Go’s Declaration Syntax</a></p>
<h2 id="多值返回"><a href="#多值返回" class="headerlink" title="多值返回"></a>多值返回</h2><p>go语言支持类似Python的函数多值返回如下：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> b<span class="token punctuation">,</span>a
<span class="token punctuation">&#125;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">swap</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>
<h2 id="返回值命名"><a href="#返回值命名" class="headerlink" title="返回值命名"></a>返回值命名</h2><p>go语言可给返回值命名，这样就可以隐式的返回变量：</p>
<pre class="language-go" data-language="go"><code class="language-go">
<span class="token keyword">func</span> <span class="token function">returnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">,</span>a <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	s<span class="token operator">=</span><span class="token string">"aaa"</span>
	a<span class="token operator">=</span><span class="token number">1</span>
	<span class="token keyword">return</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">returnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>

<h2 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h2><p>go 使用<code>var</code>关键字来声明关键词，如<code>var c=2 int</code></p>
<p>相同类型变量可以简写如<code>var a,b,c=1,2,&quot;hello&quot;</code></p>
<p>上面的代码会自动识别abc的类型。</p>
<p>在<code>函数体内部</code> 可用<code>k := 3</code>替换类型明确的var声明</p>
<h2 id="GO类型"><a href="#GO类型" class="headerlink" title="GO类型"></a>GO类型</h2><p>Go 内置了以下基本类型：</p>
<ul>
<li>布尔<ul>
<li>bool</li>
</ul>
</li>
<li>字符串<ul>
<li>string</li>
</ul>
</li>
<li>整数<ul>
<li>int </li>
<li>int8 </li>
<li>int16 </li>
<li>int32 </li>
<li>int64</li>
<li>uint </li>
<li>uint8 </li>
<li>uint16 </li>
<li>uint32 </li>
<li>uint64</li>
</ul>
</li>
<li>字节<ul>
<li>byte ，uint8 的别名</li>
</ul>
</li>
<li>Unicode <ul>
<li>rune ，int32 的别名</li>
</ul>
</li>
<li>浮点<ul>
<li>float32</li>
<li>float64</li>
</ul>
</li>
<li>复数<ul>
<li>complex64 </li>
<li>complex128</li>
</ul>
</li>
</ul>
<h2 id="零值"><a href="#零值" class="headerlink" title="零值"></a>零值</h2><ul>
<li>数值类型为 0</li>
<li>布尔类型为 false</li>
<li>字符串为 “”（空字符串）</li>
</ul>
<h2 id="类型转化"><a href="#类型转化" class="headerlink" title="类型转化"></a>类型转化</h2><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> f <span class="token builtin">float64</span> <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span><span class="token function">float64</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x <span class="token operator">+</span> y<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> z <span class="token builtin">uint</span> <span class="token operator">=</span> <span class="token function">uint</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span></code></pre>
<p>与C不同的是，go不能自动转换，如删除上面的uint，会导致报错</p>
<h2 id="类型推导"><a href="#类型推导" class="headerlink" title="类型推导"></a>类型推导</h2><p>当右值声明了类型时，新变量的类型与其相同：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">var</span> i <span class="token builtin">int</span>
j <span class="token operator">:=</span> i <span class="token comment">// j 也是一个 int</span></code></pre>

<p>不过当右边包含未指明类型的数值常量时，新变量的类型就可能是 int, float64 或 complex128 了，这取决于常量的精度：</p>
<pre class="language-go" data-language="go"><code class="language-go">i <span class="token operator">:=</span> <span class="token number">42</span>           <span class="token comment">// int</span>
f <span class="token operator">:=</span> <span class="token number">3.142</span>        <span class="token comment">// float64</span>
g <span class="token operator">:=</span> <span class="token number">0.867</span> <span class="token operator">+</span> <span class="token number">0.5i</span> <span class="token comment">// complex128</span></code></pre>

<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p>使用const关键字声明如<code>const Pi=3.14</code></p>
<p>也可以同时声明多个：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">const</span> <span class="token punctuation">(</span>
    Pi<span class="token operator">=</span><span class="token number">3.14</span>
    N<span class="token operator">=</span><span class="token number">10</span>
<span class="token punctuation">)</span></code></pre>

<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><p>go仅有for一种循环，与C语言类似，没有小括号，初始语句与后置语句是可省略的（这样就当做while循环来使用了甚至<code>可以省略掉前后的分号</code>）</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		sum <span class="token operator">+=</span> i
	<span class="token punctuation">&#125;</span></code></pre>

<h2 id="选择结构"><a href="#选择结构" class="headerlink" title="选择结构"></a>选择结构</h2><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p>if语句同样不需要加括号，但相比c语言，go支持在条件表达式执行前执行一个简单的语句如下：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">if</span> v <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> lim <span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> v
<span class="token punctuation">&#125;</span>
i<span class="token operator">:=</span><span class="token number">2</span>
<span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">&#123;</span>
    i<span class="token operator">=</span><span class="token number">2</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span> i<span class="token operator">></span><span class="token number">2</span><span class="token punctuation">&#123;</span>
    i<span class="token operator">=</span><span class="token number">3</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    i<span class="token operator">=</span><span class="token number">4</span>
<span class="token punctuation">&#125;</span></code></pre>
<p>注意<code>else if</code>和<code>else</code>必须放到<code>&#125;</code>的同一行</p>
<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h3><pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">switch</span> os <span class="token operator">:=</span> runtime<span class="token punctuation">.</span>GOOS<span class="token punctuation">;</span> os <span class="token punctuation">&#123;</span>
<span class="token keyword">case</span> <span class="token string">"darwin"</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"OS X."</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token string">"linux"</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Linux."</span><span class="token punctuation">)</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
    <span class="token comment">// freebsd, openbsd,</span>
    <span class="token comment">// plan9, windows...</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s.\n"</span><span class="token punctuation">,</span> os<span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>还可以使用没有条件的case语句可以使得多条件更简洁清晰：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">switch</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">case</span> t<span class="token punctuation">.</span><span class="token function">Hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Good morning!"</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> t<span class="token punctuation">.</span><span class="token function">Hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">17</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Good afternoon."</span><span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Good evening."</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span></code></pre>

<h2 id="defer-语句"><a href="#defer-语句" class="headerlink" title="defer 语句"></a>defer 语句</h2><p>defer语句可以让函数调用推迟到整个函数返回后再执行</p>
<p>如：</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>

<p>所以推迟的函数调用会被放入一个栈中，当函数返回时，按照后进先出顺序依次调用。</p>
<pre class="language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"counting"</span><span class="token punctuation">)</span>

	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"done"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span></code></pre>]]></content>
      <tags>
        <tag>Go</tag>
      </tags>
  </entry>
</search>
